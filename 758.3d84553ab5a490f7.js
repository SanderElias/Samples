"use strict";(self.webpackChunksamples=self.webpackChunksamples||[]).push([[758],{6495:(S,g,n)=>{n.d(g,{U2:()=>D,t8:()=>y});function h(i){return new Promise((r,l)=>{i.oncomplete=i.onsuccess=()=>r(i.result),i.onabort=i.onerror=()=>l(i.error)})}let f;function d(){return f||(f=function _(i,r){const l=function m(){if(navigator.userAgentData||!/Safari\//.test(navigator.userAgent)||/Chrom(e|ium)\//.test(navigator.userAgent)||!indexedDB.databases)return Promise.resolve();let r;return new Promise(l=>{const u=()=>indexedDB.databases().finally(l);r=setInterval(u,100),u()}).finally(()=>clearInterval(r))}().then(()=>{const u=indexedDB.open(i);return u.onupgradeneeded=()=>u.result.createObjectStore(r),h(u)});return(u,C)=>l.then(U=>C(U.transaction(r,u).objectStore(r)))}("keyval-store","keyval")),f}function D(i,r=d()){return r("readonly",l=>h(l.get(i)))}function y(i,r,l=d()){return l("readwrite",u=>(u.put(r,i),h(u.transaction)))}},1233:(S,g,n)=>{n.d(g,{j:()=>h});var m=n(2085),P=n(2728);function h(_,f=1/0,d){return f=(f||0)<1?1/0:f,(0,m.e)((D,y)=>(0,P.p)(D,y,_,f,void 0,!0,d))}},6252:(S,g,n)=>{n.d(g,{u:()=>h});var m=n(2049),P=n(2085);function h(_,f){return(0,P.e)((0,m.U)(_,f,arguments.length>=2,!1,!0))}},2474:(S,g,n)=>{n.d(g,{q:()=>_});var m=n(6252),P=n(2085);const h=(f,d)=>(f.push(d),f);function _(){return(0,P.e)((f,d)=>{(0,m.u)(h,[])(f).subscribe(d)})}},2844:(S,g,n)=>{n.d(g,{P:()=>O,z:()=>v});var m=n(4813);class P extends m.w0{constructor(t,s){super()}schedule(t,s=0){return this}}const h={setInterval(M,t,...s){const{delegate:o}=h;return(null==o?void 0:o.setInterval)?o.setInterval(M,t,...s):setInterval(M,t,...s)},clearInterval(M){const{delegate:t}=h;return((null==t?void 0:t.clearInterval)||clearInterval)(M)},delegate:void 0};var _=n(8308),d=n(2069);class D{constructor(t,s=D.now){this.schedulerActionCtor=t,this.now=s}schedule(t,s=0,o){return new this.schedulerActionCtor(this,t).schedule(o,s)}}D.now=d.l.now;const v=new class y extends D{constructor(t,s=D.now){super(t,s),this.actions=[],this._active=!1,this._scheduled=void 0}flush(t){const{actions:s}=this;if(this._active)return void s.push(t);let o;this._active=!0;do{if(o=t.execute(t.state,t.delay))break}while(t=s.shift());if(this._active=!1,o){for(;t=s.shift();)t.unsubscribe();throw o}}}(class f extends P{constructor(t,s){super(t,s),this.scheduler=t,this.work=s,this.pending=!1}schedule(t,s=0){if(this.closed)return this;this.state=t;const o=this.id,I=this.scheduler;return null!=o&&(this.id=this.recycleAsyncId(I,o,s)),this.pending=!0,this.delay=s,this.id=this.id||this.requestAsyncId(I,this.id,s),this}requestAsyncId(t,s,o=0){return h.setInterval(t.flush.bind(t,this),o)}recycleAsyncId(t,s,o=0){if(null!=o&&this.delay===o&&!1===this.pending)return s;h.clearInterval(s)}execute(t,s){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const o=this._execute(t,s);if(o)return o;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(t,s){let I,o=!1;try{this.work(t)}catch(A){o=!0,I=A||new Error("Scheduled action threw falsy error")}if(o)return this.unsubscribe(),I}unsubscribe(){if(!this.closed){const{id:t,scheduler:s}=this,{actions:o}=s;this.work=this.state=this.scheduler=null,this.pending=!1,(0,_.P)(o,this),null!=t&&(this.id=this.recycleAsyncId(s,t,null)),this.delay=null,super.unsubscribe()}}}),O=v},9226:(S,g,n)=>{n.d(g,{QS:()=>U,TK:()=>b,qj:()=>L,se:()=>x,ss:()=>B});var m=n(4762),P=n(6495),h=n(9724),_=n(985),f=n(8168),d=n(6466),D=n(1233),y=n(9018),v=n(7969),O=n(6252),M=n(4970),t=n(5598),s=n(4551),o=n(5619),I=n(6811),A=n(2474),j=n(8831),i=n(4945),r=n(3568),l=n(1528);let u;const C="sample-cache";function U(){return(0,m.mG)(this,void 0,void 0,function*(){if(u)return u;const p=yield(0,P.U2)(C);return u=p?new Map([...p]):new Map,u})}function x(p,w){u.set(p,w),(0,P.t8)(C,u)}function B(p){return u.has(p)}function b(p){return u.get(p)}let L=(()=>{class p{constructor(){this.baseUrl="https://swapi.dev/api/",this.load=e=>(0,m.mG)(this,void 0,void 0,function*(){if(e=T(e),yield U(),!B(e)){const a=yield fetch(e).then(c=>c.json()).catch(c=>{});yield x(e,a)}return b(e)}),this.swapiRoot$=(0,_.D)(this.load(this.baseUrl)).pipe((0,f.b)(e=>this.swapiRoot=e),(0,d.d)(1)),this.swPeople$=(0,_.D)(this.load(`${this.baseUrl}people/`)).pipe((0,D.j)(e=>e.next?this.load(e.next):y.E),(0,v.U)(e=>e.results),(0,O.u)((e,a)=>e.concat(a),[]),(0,v.U)(e=>e.map(a=>Object.assign(Object.assign({},a),{date:K(),id:a.url}))),(0,d.d)(1)),this.findById=e=>this.swPeople$.pipe((0,v.U)(a=>a[e]),(0,M.h)(Boolean),(0,t.q)(1)),this.swFilms$=(0,_.D)(this.load(`${this.baseUrl}films/`)).pipe((0,d.d)(1)),this.findFilmByUrl=e=>this.get(e),this.getRandomPerson=(e=1)=>(0,_.D)(Array.from({length:e})).pipe((0,s.b)(()=>this.swPeople$.pipe((0,v.U)(a=>a[Math.floor(Math.random()*a.length)]),(0,o.z)(a=>(0,I.z)(...a.films.map(c=>this.findFilmByUrl(c))).pipe((0,A.q)(),(0,v.U)(c=>Object.assign(Object.assign({},a),{films:c}))))))),this.findIn=(e,a)=>this.getAllRows(e).pipe((0,v.U)(c=>c.find(E=>(E.name||E.title||"").toLowerCase().includes(a.toLowerCase().trim())))),this.findWithName=e=>this.findIn("people",e),this.loadData().subscribe()}getAllPagedData(e){return(0,_.D)(this.load(`${e}`)).pipe((0,D.j)(a=>a.next?this.load(a.next):y.E))}get(e){const a=Object.values(this.swapiRoot).find(c=>e.toLowerCase().includes(c.toLowerCase()));return a?this.getAllPagedData(a).pipe((0,O.u)((c,E)=>c.concat(E.results),[]),(0,v.U)(c=>c.find(E=>E.url===e))):(0,_.D)(this.load(e))}loadData(){return this.swapiRoot$.pipe((0,f.b)(e=>this.swapiRoot=e),(0,s.b)(e=>Object.values(e).map(a=>this.getAllPagedData(a))),(0,j.u)(),(0,A.q)(),(0,d.d)(1))}enrich(e){const a=c=>{const E=e[c];return Array.isArray(E)&&E.length>0?(0,_.D)(e[c]).pipe((0,s.b)(R=>this.get(R)),(0,A.q)(),(0,v.U)(R=>({[c]:R}))):"string"==typeof E?(this.detectSet(E)?this.get(E):(0,i.of)(E)).pipe((0,v.U)(W=>({[c]:W}))):(0,i.of)(E).pipe((0,v.U)(R=>({[c]:R})))};return this.swapiRoot$.pipe((0,s.b)(c=>Object.keys(e).map(a)),(0,j.u)(),(0,O.u)((c,E)=>Object.assign(Object.assign({},c),E),{}),(0,r.K)(c=>(console.warn(c),(0,i.of)({}))))}getAllRows(e){return this.swapiRoot$.pipe((0,l.w)(()=>this.getAllPagedData(T(this.swapiRoot[e]))),(0,v.U)(a=>a.results),(0,O.u)((a,c)=>a.concat(c),[]),(0,d.d)(1))}detectSet(e){if("string"==typeof e){const a=Object.entries(this.swapiRoot).find(([c,E])=>e.includes(E));return a&&a[0]}}}return p.\u0275fac=function(e){return new(e||p)},p.\u0275prov=h.Yz7({token:p,factory:p.\u0275fac,providedIn:"root"}),p})();function K(){const p=Math.ceil(1e3*Math.random())+1e3,w=Math.floor(12*Math.random()),e=Math.ceil(27*Math.random());return new Date(p,w,e,12,0)}function T(p){return p.split("http:").join("https:")}},4553:(S,g,n)=>{function m(h,_,f,d,D,y,v){try{var O=h[y](v),M=O.value}catch(t){return void f(t)}O.done?_(M):Promise.resolve(M).then(d,D)}function P(h){return function(){var _=this,f=arguments;return new Promise(function(d,D){var y=h.apply(_,f);function v(M){m(y,d,D,v,O,"next",M)}function O(M){m(y,d,D,v,O,"throw",M)}v(void 0)})}}n.d(g,{Z:()=>P})}}]);