import{b as q,c as w,d as C}from"./chunk-QF2LJGO6.js";import{e as D}from"./chunk-FQNCIWCU.js";import"./chunk-4OAYFTJO.js";import"./chunk-E22GBFP7.js";import"./chunk-OZD4UVZE.js";import"./chunk-FPPZ4BUR.js";import{Hc as S,Ic as s,Nc as v,Ob as i,Oc as x,Pb as n,Pc as _,Qb as d,Ub as b,Zb as g,fa as f,fc as h,gc as y,hb as p,ka as c,la as E,lc as m}from"./chunk-5REAII6L.js";import{a as u}from"./chunk-DAQOROHW.js";var O=["form"],L=(()=>{class a{constructor(){this.id=x.required(),this.done=v(),this.form=_("form"),this.rs=f(C),this.relation=this.rs.read(this.id),this.flatData=s({source:()=>this.relation()?.value(),computation:r=>q(r??{})}),this.fields=s({source:this.flatData,computation:r=>Object.keys(r)}),this._=S(()=>{let r=this.flatData(),e=this.form()?.nativeElement;if(!(!r||!e))for(let[o,t]of Object.entries(r))e[o]&&(e[o].value=t)})}async submit(r){r.preventDefault();let e=r.target;if(!e)return;let o=u({},this.flatData());for(let t of this.fields())if(e[t]){let l=typeof o[t];l==="string"&&(o[t]=e[t].value),l==="number"&&(o[t]=Number(e[t].value)),l==="boolean"&&(o[t]=e[t].checked)}if(D(this.flatData(),o))this.done.emit();else{let t=w(o);console.log("newData",t),await this.rs.update(t)?this.done.emit():console.error("Error updating the user")}}static{this.\u0275fac=function(e){return new(e||a)}}static{this.\u0275cmp=p({type:a,selectors:[["relation-form"]],viewQuery:function(e,o){e&1&&h(o.form,O,5),e&2&&y()},inputs:{id:[1,"id"]},outputs:{done:"done"},decls:37,vars:0,consts:[["form",""],[3,"submit"],["for","name"],["id","name","name","name","required",""],["for","username"],["id","username","name","username","required",""],["for","email"],["id","email","name","email","required","","type","email"],["for","street"],["id","street","name","address.street","required",""],["for","suite"],["id","suite","name","address.suite"],["for","city"],["id","city","name","address.city","required",""],["for","zipcode"],["id","zipcode","name","address.zipcode","required",""],["for","lat"],["id","lat","name","address.geo.lat","required","","min","-90","max","90","type","number","step","0.0001"],["for","lng"],["id","lng","name","address.geo.lng","required","","min","-180","max","180","type","number","step","0.0001"]],template:function(e,o){if(e&1){let t=b();i(0,"form",1,0),g("submit",function(M){return c(t),E(o.submit(M))}),i(2,"label",2),m(3,"Name"),n(),d(4,"input",3),i(5,"label",4),m(6,"Username"),n(),d(7,"input",5),i(8,"label",6),m(9,"Email"),n(),d(10,"input",7),i(11,"fieldset")(12,"legend"),m(13,"Address"),n(),i(14,"label",8),m(15,"Street"),n(),d(16,"input",9),i(17,"label",10),m(18,"Suite"),n(),d(19,"input",11),i(20,"label",12),m(21,"City"),n(),d(22,"input",13),i(23,"label",14),m(24,"Zipcode"),n(),d(25,"input",15),i(26,"fieldset")(27,"legend"),m(28,"Geo"),n(),i(29,"label",16),m(30,"Latitude"),n(),d(31,"input",17),i(32,"label",18),m(33,"Longitude"),n(),d(34,"input",19),n()(),i(35,"button"),m(36,"Submit"),n()()}},styles:['form[_ngcontent-%COMP%], fieldset[_ngcontent-%COMP%]{display:flex;flex-direction:column}input[_ngcontent-%COMP%]{margin-bottom:1rem}label[_ngcontent-%COMP%]:has(+input[required]):after{display:inline;content:"*";color:orange}input[_ngcontent-%COMP%]:last-child{margin-bottom:0}']})}}return a})();export{L as RelationForm};
