import{c as d,d as E,e as re,f as P,g as v,h as I,i as u,j as ae,k as L,l as V,m as h,n as oe,o as se,p as le,q as w,r as g,s as _}from"./chunk-ANID3SPZ.js";import"./chunk-KCVRCSXG.js";import"./chunk-IHPZU2R7.js";import"./chunk-J55TQ276.js";import"./chunk-FPPZ4BUR.js";import{$ as Z,Ba as j,Bb as J,Db as W,Fb as G,Gb as F,Hb as H,Hc as z,Ib as M,Jb as T,Jc as te,Kb as c,Lb as s,Mb as r,Nb as m,Pc as O,Qc as ne,Ub as k,Wa as o,Yb as y,Yc as ie,_b as b,ea as Q,fc as K,gc as U,ja as S,jb as C,ka as D,lc as l,mc as X,nc as ee,va as Y}from"./chunk-LWK3ZSJS.js";import"./chunk-DAQOROHW.js";var f=(function(t){return t.Email="E-Mail",t.Fax="Fax",t.Mobile="Mobile",t.Phone="Phone",t})(f||{});var be=["contacts",""];function xe(t,a){if(t&1&&(s(0,"option",5),l(1),r()),t&2){let e=a.$implicit;c("value",e),o(),X(e)}}function Ce(t,a){if(t&1){let e=k();s(0,"div",1)(1,"button",2),y("click",function(){let i=S(e).$implicit,p=b();return D(p.delContact(i().value()))}),l(2,"\u{1F5D1}\uFE0F"),r(),s(3,"div")(4,"select",3)(5,"option",4),l(6,"-- Select type --"),r(),M(7,xe,2,2,"option",5,H),r()(),s(9,"div"),m(10,"input",6),r(),m(11,"input",7),r()}if(t&2){let e=a.$implicit,n=b();o(),c("disabled",n.isLastOne()),o(3),c("control",e.type),o(3),T(n.types),o(3),c("control",e.value),o(),c("control",e.priority)}}var ce=(()=>{class t{constructor(){this.contacts=O.required(),this.isLastOne=z(()=>this.contacts()().value().length===1),this.types=Object.values(f)}addContact(){this.contacts()().value.update(e=>[...e,{type:f.Email,value:"",priority:0}])}delContact(e){let n=this.contacts()().value;n().length>1&&n.update(i=>i.filter(p=>p!==e))}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275cmp=C({type:t,selectors:[["fieldset","contacts",""]],inputs:{contacts:[1,"contacts"]},attrs:be,decls:6,vars:0,consts:[["type","button",1,"action",3,"click"],[1,"row"],["type","button",1,"action",3,"click","disabled"],["showError","",3,"control"],["value",""],[3,"value"],["type","text","placeholder","value","showError","",3,"control"],["type","number","placeholder","priority",3,"control"]],template:function(n,i){n&1&&(s(0,"legend"),l(1,"Contacts "),s(2,"button",0),y("click",function(){return i.addContact()}),l(3,"+"),r()(),M(4,Ce,12,4,"div",1,F)),n&2&&(o(4),T(i.contacts()))},dependencies:[E,_],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;gap:var(--size-2)}div.row[_ngcontent-%COMP%]{display:grid;grid-template-columns:3.5rem 6rem 16.5rem 2rem;flex-direction:row;gap:var(--size-2);align-items:baseline}input[type=number][_ngcontent-%COMP%]{width:3rem}div[_ngcontent-%COMP%] > button.action[_ngcontent-%COMP%]{position:inherit;margin-inline-start:0}"]})}}return t})();var Ee=["tagsInput"],we=["tags",""];function _e(t,a){if(t&1&&(s(0,"span",1),l(1),r()),t&2){let e=b();o(),ee(" (max ",e.maxLength()," tags)")}}function Se(t,a){if(t&1){let e=k();s(0,"div",4)(1,"button",5),y("click",function(){let i=S(e).$index,p=b();return D(p.delTag(i))}),l(2,"\u{1F5D1}\uFE0F"),r(),m(3,"input",6),r()}if(t&2){let e=a.$implicit,n=a.$index,i=b();o(),c("disabled",i.isLastOne()),o(2),c("control",e),J("name","tag-"+n)}}var me=(()=>{class t{constructor(){this.tags=O.required(),this.tagsInput=ne("tagsInput",{read:j}),this.isLastOne=z(()=>this.tags()().value().length===1),this.maxLength=z(()=>{let e=(this.tags()().errors()||[]).find(n=>n instanceof se);return e===void 0?null:e.maxLength}),this._=ie(()=>{let e=this.tags()().errors()||[],n=this.tagsInput().nativeElement;e.length>0?n.setCustomValidity("error in tags"):n.setCustomValidity("")})}addTag(){this.tags()().value.update(e=>[...e,""])}delTag(e){let n=this.tags()().value;n().length>1&&n.update(i=>i.filter((p,x)=>x!==e))}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275cmp=C({type:t,selectors:[["fieldset","tags",""]],viewQuery:function(n,i){n&1&&K(i.tagsInput,Ee,5,j),n&2&&U()},inputs:{tags:[1,"tags"]},attrs:we,decls:9,vars:1,consts:[["tagsInput",""],[1,"error"],["type","button",1,"action",3,"click"],["type","text","name","tags",2,"display","none"],[1,"tags"],["type","button",1,"action",3,"click","disabled"],["type","text","showError","",3,"control"]],template:function(n,i){if(n&1){let p=k();s(0,"legend"),l(1," Tags "),W(2,_e,2,1,"span",1),s(3,"button",2),y("click",function(){return S(p),D(i.addTag())}),l(4,"+"),r()(),m(5,"input",3,0),M(7,Se,4,3,"div",4,F)}n&2&&(o(2),G(i.maxLength()!==null?2:-1),o(5),T(i.tags()))},dependencies:[E,_],styles:["[_nghost-%COMP%]{display:block;margin-block-start:var(--size-2 )}div.tags[_ngcontent-%COMP%]{display:grid;grid-template-columns:48px auto;gap:var(--size-3);grid-row-gap:var(--size-1);align-items:baseline}.error[_ngcontent-%COMP%]{color:var(--red-5);font-variant:small-caps;font-size:.9rem;margin-inline-start:var(--size-2)}div.tags[_ngcontent-%COMP%] > button.action[_ngcontent-%COMP%]{position:inherit;margin-inline-start:0}"]})}}return t})();var de=(()=>{class t{constructor(){this.getById=e=>te({source:e,computation:n=>{let i=$.get(n);return i?structuredClone(i):De(n)}}),this.getAll=()=>structuredClone(Array.from($.values())),this.save=async e=>{await new Promise(n=>setTimeout(n,500)),$.set(e.id,e)}}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275prov=Z({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})(),$=new Map;$.set("1",{id:"1",name:"Sander",dob:new Date(1980,1,1),password:"007 Is not secure",confirm:"007 Is not secure",contacts:[{type:f.Email,value:"a@b.c",priority:0},{type:f.Mobile,value:"+31 6123 456 789",priority:0}],tags:["developer","angular","aa","aaa","aaaa"],address:{street:"123 Main St",city:"Anytown",state:"CA",zip:"12345"}});var De=t=>({id:t,name:"",dob:new Date("2000"),password:"",confirm:"",tags:[],address:{street:"",city:"",state:"",zip:""},contacts:[]});var pe=u(t=>{g(t,{message:"can not be empty"}),w(t,6,{message:"must be at least 6 characters"}),d(t,({value:a})=>{let e=a(),n=[];return/[A-Z]/.test(e)||n.push(oe({message:"must contain an uppercase letter"})),/[a-z]/.test(e)||n.push(R("must contain a lowercase letter")),/[0-9]/.test(e)||n.push(R("must contain a number")),/[^A-Za-z0-9]/.test(e)||n.push(R("must contain a special character")),n.length>0?n:null})}),R=t=>({kind:"complexity",field:void 0,message:t});var ue=u(t=>{d(t,({value:a})=>{let e=a();return/^[^@\s]+@[^@\s]+\.[^@\s]+$/.test(e)?null:h(/^[^@\s]+@[^@\s]+\.[^@\s]+$/,{message:"Invalid email address"})})});var N=u(t=>{d(t,({value:a})=>{let e=[],n=a(),i=n.split("").filter(p=>"0123456789".includes(p)).length;return/^\+?[0-9\s\-()]{7,}$/.test(n)||e.push(h(/^\+?[0-9\s\-()]{7,}$/,{message:"only numbers and ()+- are allowed"})),i<7&&e.push(V(7,{message:"At least 7 digits are required"})),i>15&&e.push(L(15,{message:"Maximum 15 digits allowed"})),e.length>0?e:null})});var ge=u(t=>{w(t,1,{message:"At least one contact is required"}),P(t,Me)}),Me=u(t=>{let a=Object.values(f);g(t.value,{message:"a value is required"}),d(t.type,({value:e})=>{let n=e();return a.includes(n)===!1?h(/.*/,{message:"Invalid contact type"}):null}),I(t,e=>e.type===f.Email,e=>v(e.value,ue)),I(t,e=>e.type===f.Fax,e=>v(e.value,N)),I(t,e=>e.type===f.Mobile,e=>v(e.value,N)),I(t,e=>e.type===f.Phone,e=>v(e.value,N))});var fe=u(t=>{le(t,7,{message:"Maximum 7 tags allowed"});let a=u(e=>{g(e,{message:"Tag can not be empty"}),w(e,2,{message:"Tag must be at least 2 characters"}),d(e,({value:n,state:i,valueOf:p})=>{let x=n(),ve=parseInt(""+i.keyInParent(),10),ye=p(t).map((q,A)=>[q,A]);for(let[q,A]of ye)if(A!==ve&&q===x)return h(/.*/,{message:"Duplicate tags are not allowed"})}),d(e,({value:n})=>{if(n().toLowerCase().includes("react"))return h(/.*/,{message:"no, just, no!"})})});P(t,a)});var he=u(t=>{g(t.name,{message:"a name is required"}),d(t.name,({value:a})=>{let e=a();return e&&e.length<3?V(3,{message:"Name must be at least 3 characters"}):e&&!/^[A-Za-z\s]+$/.test(e)?h(/^[A-Za-z\s]+$/,{message:"Name must contain only letters and spaces"}):null}),g(t.dob),d(t.dob,({value:a})=>{let e=a();return e&&new Date(e).getTime()>Date.now()?L(Date.now(),{message:"Date of birth cannot be in the future"}):null}),d(t.dob,({value:a})=>{let e=a();return e&&new Date(e).getFullYear()<1900?ae(1900,{message:"Year must be 1900 or later"}):null}),v(t.password,pe),g(t.confirm),d(t.confirm,({value:a,valueOf:e})=>{let n=a(),i=e(t.password);return n!==i?h(/.*/,{message:"Passwords do not match"}):null}),g(t.address.street),g(t.address.city),g(t.address.state),v(t.tags,fe),v(t.contacts,ge)});var vt=(()=>{class t{constructor(){this.dataService=Q(de),this.id=Y("1"),this.relation=this.dataService.getById(this.id),this.fd=re(this.relation,he)}onSubmit(e){this.fd().valid()&&console.log("submit",JSON.stringify(this.relation(),void 0,2)),e.preventDefault()}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275cmp=C({type:t,selectors:[["ng-component"]],decls:38,vars:10,consts:[[3,"submit"],["for","name"],["type","text","name","name","placeholder","Your name","showError","",3,"control"],["for","dob"],["type","date","name","dob","showError","",3,"control"],["for","password"],["type","password","name","password","placeholder","Password","showError","",3,"control"],["for","confirm"],["type","password","name","confirm","placeholder","Confirm Password","showError","",3,"control"],[3,"contacts"],["for","street"],["type","text","name","street","placeholder","Street","showError","",3,"control"],["for","city"],["type","text","name","city","placeholder","City","showError","",3,"control"],["for","state"],["type","text","name","state","placeholder","State","showError","",3,"control"],[3,"tags"],["type","submit",3,"disabled"]],template:function(n,i){n&1&&(s(0,"h1"),l(1,"Signal Forms Experiment"),r(),s(2,"form",0),y("submit",function(x){return i.onSubmit(x)}),s(3,"label",1)(4,"span"),l(5,"Name"),r(),m(6,"input",2),r(),s(7,"label",3)(8,"span"),l(9,"Date of Birth"),r(),m(10,"input",4),r(),s(11,"label",5)(12,"span"),l(13,"Password"),r(),m(14,"input",6),r(),s(15,"label",7)(16,"span"),l(17,"Confirm Password"),r(),m(18,"input",8),r(),m(19,"fieldset",9),s(20,"fieldset")(21,"legend"),l(22,"Address"),r(),s(23,"label",10)(24,"span"),l(25,"Street"),r(),m(26,"input",11),r(),s(27,"label",12)(28,"span"),l(29,"City"),r(),m(30,"input",13),r(),s(31,"label",14)(32,"span"),l(33,"State"),r(),m(34,"input",15),r()(),m(35,"fieldset",16),s(36,"button",17),l(37,"Submit"),r()()),n&2&&(o(6),c("control",i.fd.name),o(4),c("control",i.fd.dob),o(4),c("control",i.fd.password),o(4),c("control",i.fd.confirm),o(),c("contacts",i.fd.contacts),o(7),c("control",i.fd.address.street),o(4),c("control",i.fd.address.city),o(4),c("control",i.fd.address.state),o(),c("tags",i.fd.tags),o(),c("disabled",!i.fd().valid()))},dependencies:[E,me,ce,_],styles:[`:host{display:block;margin-top:var(--size-3)}form{width:var(--size-content-3);display:flex;flex-direction:column;gap:var(--size-3);margin:auto;background-color:var(--surface-2);padding:var(--size-3);border-radius:var(--radius-3)}label{display:flex;flex-direction:column;gap:var(--size-2)}label>*:nth-child(2){margin-left:var(--size-3)}label:has(input[required])>span:first-child:after{content:"*";color:var(--red-3)}:invalid{border:2px solid var(--red-5)}fieldset>legend{display:flex;align-items:center}fieldset{margin-block-end:0}div.error-messages{color:var(--red-5);grid-column:2;font-style:italic;min-height:1.5em;font-variant:small-caps;margin-inline-start:var(--size-2);margin-block-start:calc(-1 * var(--size-2))}div.error-messages ul{font-size:.95rem}div.error-messages ul:not(:has(:nth-child(2))){list-style:none;padding-inline-start:var(--size-4)}button.action{position:absolute;margin-inline-start:calc(var(--size-content-3) - 2.5rem);border-radius:50%;width:var(--size-8);height:var(--size-8);padding:0;font-size:var(--size-3);line-height:1;display:inline-flex;align-items:center;justify-content:center}.ng-invalid.ng-dirty:focus{outline-color:var(--red-5);background-color:inherit}.ng-invalid.ng-dirty:not(form){background-color:var(--red-2);color:#000}
`],encapsulation:2})}}return t})();export{vt as SignalFormsExperimentComponent};
