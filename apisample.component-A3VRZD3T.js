import{e as Q}from"./chunk-NDZQHLVL.js";import"./chunk-IVQRMR3V.js";import{b as w}from"./chunk-2PCCGAD2.js";import{C as K,c as U,f as W,k as M,q as Y,t as z,u as G,v as J}from"./chunk-XCVIQJ3P.js";import"./chunk-P4K3TQV7.js";import"./chunk-D4NNR5R6.js";import{D as x,F as V,I as P,J as D,M as N,Ob as A,Qb as I,Qc as H,Sb as _,Tb as h,Ub as u,V as T,Vb as m,Wb as o,X as B,Xb as r,Xc as L,Yb as f,Za as l,dc as F,ea as j,hc as C,ja as k,jc as c,ka as E,l as O,p as R,q as $,r as b,ra as q,rb as v,wc as a,xc as S,yc as y}from"./chunk-KIBRB3UE.js";import"./chunk-C6Q5SG76.js";function te(t,s){if(t&1){let e=F();o(0,"details")(1,"summary"),a(2),o(3,"button",0),C("click",function(){let n=k(e),d=c(2).$implicit,p=c();return E(p.selected.emit([p.key(d),n.name||n.title]))}),a(4,"Select"),r()(),f(5,"app-show-rec",1),r()}if(t&2){let e=s;l(2),y(" ",e.name||e.title," "),l(3),m("record",e)}}function ie(t,s){if(t&1&&a(0),t&2){let e=c(2).$implicit,i=c();y(" ",i.val(e)," ")}}function ne(t,s){if(t&1&&A(0,te,6,2,"details")(1,ie,1,1),t&2){let e,i=c().$implicit,n=c();I((e=n.isRecord(n.val(i)))?0:1,e)}}function oe(t,s){if(t&1){let e=F();o(0,"details")(1,"summary"),a(2),o(3,"button",0),C("click",function(){let n=k(e).$implicit,d=c(2).$implicit,p=c();return E(p.selected.emit([p.key(d),n.name||n.title]))}),a(4,"Select"),r()(),f(5,"app-show-rec",1),r()}if(t&2){let e=s.$implicit;l(2),y(" ",e.name||e.title," "),l(3),m("record",e)}}function re(t,s){if(t&1&&h(0,oe,6,2,"details",null,_),t&2){let e=c().$implicit,i=c();u(i.val(e))}}function ae(t,s){if(t&1&&(o(0,"dl")(1,"dt"),a(2),r(),o(3,"dd"),A(4,ne,2,1)(5,re,2,0),r()()),t&2){let e=s.$implicit,i=c();l(2),S(i.key(e)),l(2),I(i.isRecArray(e)?5:4)}}var le=t=>t[0],X=t=>t[1],Z=(()=>{class t{constructor(){this.record=L.required(),this.entries=H(()=>this.record()&&Object.entries(this.record())),this.selected=new q,this.key=le,this.val=X}isRecArray(e){let i=X(e);if(Array.isArray(i)&&i.length>0){let n=i[0];return!Array.isArray(n)&&typeof n=="object"}return!1}isRecord(e){return e&&!Array.isArray(e)&&typeof e=="object"&&e}ngOnInit(){}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=v({type:t,selectors:[["app-show-rec"]],inputs:{record:[1,"record"]},outputs:{selected:"selected"},decls:2,vars:0,consts:[[3,"click"],[3,"record"]],template:function(i,n){i&1&&h(0,ae,6,2,"dl",null,_),i&2&&u(n.entries())},dependencies:[t],styles:["dl[_ngcontent-%COMP%]{display:grid;grid-template-columns:5em 1fr}dt[_ngcontent-%COMP%]{font-weight:initial;max-width:5em;overflow:hidden}dd[_ngcontent-%COMP%]{font-weight:bolder;margin-left:.5em}summary[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:inline-block;margin-left:5px;padding:2px}"]})}}return t})();function se(t,s){if(t&1&&(o(0,"option"),a(1),r()),t&2){let e=s.$implicit;l(),S(e)}}function ce(t,s){if(t&1&&(o(0,"option"),a(1),r()),t&2){let e=s.$implicit;l(),S(e)}}var ge=(()=>{class t{constructor(){this.#e=j(Q),this.chosenSet=new M("",{nonNullable:!0}),this.name=new M(""),this.rawData={},this.availableSets$=this.#e.swapiRoot$.pipe($(e=>Object.keys(e??{}))),this.availableSets=w(this.availableSets$),this.availableOptions=w(b([this.availableSets$,this.chosenSet.valueChanges]).pipe(x(([e,i])=>e.includes(i)),T(([e,i])=>this.#e.getSetNames(i))),{initialValue:[]}),this.result=w(b([this.chosenSet.valueChanges,this.name.valueChanges.pipe(D(250),N(),x(Boolean))]).pipe(T(([e,i])=>this.#e.findIn(e,i)),x(Boolean),B(e=>this.rawData=e),P(e=>this.#e.enrich(e)),V(e=>(console.error(e),O({"Not Found":"Your search string didn't return any results"})))))}#e;ngAfterViewInit(){this.changeTo(["people","luke"])}async changeTo(e){let i=await R(this.availableSets$),[n,d]=e,p=n;if(!i.includes(n)){let g=this.rawData[n];p=this.#e.detectSet(Array.isArray(g)?g[0]:g)}this.chosenSet.setValue(p,{emitEvent:!0}),this.name.setValue(d,{emitEvent:!0})}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=v({type:t,selectors:[["app-apisample"]],decls:23,vars:3,consts:[["target","blank","href","https://github.com/SanderElias/Samples/blob/master/projects/se-ng/swapi/src/lib/swapi.service.ts"],["target","blank","href","https://swapi.dev"],[3,"formControl"],["type","text","list","listOptions","autofocus","",3,"formControl"],[3,"selected","record"],["id","listOptions"]],template:function(i,n){i&1&&(o(0,"H3"),a(1,"Complex api sample"),r(),o(2,"h4"),a(3,"(first load might take a while!)"),r(),o(4,"p"),a(5," The complexity is in the API, have an look at "),o(6,"a",0),a(7,"the swapi service"),r(),a(8,"."),f(9,"br"),a(10," This sample loads all of "),o(11,"a",1),a(12,"SWAPI"),r(),a(13,` and caches it to indexedDB. This is also the reason the first load takes longer.
`),r(),o(14,"select",2),h(15,se,2,1,"option",null,_),r(),f(17,"br")(18,"input",3),o(19,"app-show-rec",4),C("selected",function(p){return n.changeTo(p)}),r(),o(20,"datalist",5),h(21,ce,2,1,"option",null,_),r()),i&2&&(l(14),m("formControl",n.chosenSet),l(),u(n.availableSets()),l(3),m("formControl",n.name),l(),m("record",n.result()),l(2),u(n.availableOptions()))},dependencies:[K,G,J,U,z,W,Y,Z],styles:["[_nghost-%COMP%]{display:block;max-height:95vh;max-width:98vw;overflow-x:hidden;overflow-y:auto}"]})}}return t})();export{ge as APISampleComponent};
