import{Rc as g,ea as r,na as l,va as m,ya as p}from"./chunk-KIBRB3UE.js";var f,u,h,a;if(typeof indexedDB<"u"){let{createStore:e,get:d,set:i,update:c,del:t}=await import("./dist-SSPCTZNG.js"),s=e("mqtt","se-store");f=n=>d(n,s),u=(n,o)=>i(n,o,s),h=(n,o)=>c(n,o,s),a=n=>t(n,s)}else{let e=new Map;u=async(d,i)=>e.set(d,i),a=async d=>e.delete(d),h=async(d,i)=>e.set(d,i),f=async d=>{}}function b(e,d,i=r(l)){let c=m(d,{debugName:`Persisted ${e}`});return f(e).then(t=>{t!==void 0&&c.set(t)}).catch(()=>{}),p(async()=>{let t=c(),s=await f(e).catch(()=>{});t!==s&&(t!==void 0?u(e,t).catch(()=>{}):a(e).catch(()=>{}))},{injector:i,debugName:"PersistEffect"}),c}function D(e,d,i){let c=g({source:d,computation:(t,s)=>{let n=i(t,s);return n!==s?.value&&n!==void 0?u(e,n).catch(()=>{}):n===void 0&&a(e).catch(()=>{}),n}});return f(e).then(t=>{t!==void 0&&c.set(t)}),c}export{b as a,D as b};
