import{e as de}from"./chunk-4UPB66ZV.js";import"./chunk-XZCHICF6.js";import{b as re,d as ie,h as U,n as oe,q as se,r as ae,s as le,w as ce}from"./chunk-M4DNW4SU.js";import{i as V,j as ne}from"./chunk-7UTYY7SV.js";import{B as C,C as z,F as X,G as J,Gb as E,L as K,Lb as te,Tb as $,V as A,W as Q,Wa as d,Xa as ee,_a as O,cb as m,db as P,ea as w,eb as u,fb as a,ga as x,gb as l,hb as g,ib as D,j as L,jb as F,ka as Z,la as M,lb as N,n as B,o as Y,ob as _,p as k,pa as I,pb as p,qa as T,ub as c,vb as b,wb as v}from"./chunk-VWKE6EEO.js";import{e as f,f as q,g as H,h as G}from"./chunk-G5KKTNWD.js";var j=class extends Error{constructor(e,r){super(me(e,r)),this.code=e}};function me(t,e){return`${`NG0${Math.abs(t)}`}${e?": "+e:""}`}var he=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)();var W=class{constructor(e){this.ref=e}deref(){return this.ref}},Ae=he.WeakRef??W;function S(t,e){let r=!e?.manualCleanup;r&&!e?.injector&&ee(S);let o=r?e?.injector?.get(O)??w(O):null,n;e?.requireSync?n=M({kind:0}):n=M({kind:1,value:e?.initialValue});let i=t.subscribe({next:s=>n.set({kind:1,value:s}),error:s=>n.set({kind:2,error:s})});return o?.onDestroy(i.unsubscribe.bind(i)),Z(()=>{let s=n();switch(s.kind){case 1:return s.value;case 2:throw s.error;case 0:throw new j(601,"`toSignal()` called with `requireSync` but `Observable` did not emit synchronously.")}})}function ge(t,e){if(t&1){let r=N();D(0),a(1,"details")(2,"summary"),c(3),a(4,"button",4),_("click",function(){let i=I(r).ngIf,s=p(2).$implicit,h=p();return T(h.selected.emit([h.key(s),i.name||i.title]))}),c(5," Select "),l()(),g(6,"app-show-rec",5),l(),F()}if(t&2){let r=e.ngIf;d(3),v("",r.name||r.title," "),d(3),u("record",r)}}function ve(t,e){if(t&1&&c(0),t&2){let r=p(2).$implicit,o=p();v(" ",o.val(r)," ")}}function ye(t,e){if(t&1&&(D(0),m(1,ge,7,2,"ng-container",1),m(2,ve,1,1,"ng-template",null,3,$),F()),t&2){let r=P(3),o=p().$implicit,n=p();d(1),u("ngIf",n.isRecord(n.val(o)))("ngIfElse",r)}}function _e(t,e){if(t&1){let r=N();a(0,"details")(1,"summary"),c(2),a(3,"button",4),_("click",function(){let i=I(r).$implicit,s=p(2).$implicit,h=p();return T(h.selected.emit([h.key(s),i.name||i.title]))}),c(4," Select "),l()(),g(5,"app-show-rec",5),l()}if(t&2){let r=e.$implicit;d(2),v("",r.name||r.title," "),d(3),u("record",r)}}function Se(t,e){if(t&1&&m(0,_e,6,2,"details",0),t&2){let r=p().$implicit,o=p();u("ngForOf",o.val(r))}}function Ce(t,e){if(t&1&&(a(0,"dl")(1,"dt"),c(2),l(),a(3,"dd"),m(4,ye,4,2,"ng-container",1),m(5,Se,1,1,"ng-template",null,2,$),l()()),t&2){let r=e.$implicit,o=P(6),n=p();d(2),b(n.key(r)),d(2),u("ngIf",!n.isRecArray(r))("ngIfElse",o)}}var we=t=>t[0],ue=t=>t[1],pe=(()=>{let e=class{set record(o){o&&(this.entries=Object.entries(o))}constructor(){this.selected=new te,this.key=we,this.val=ue}isRecArray(o){let n=ue(o);if(Array.isArray(n)&&n.length>0){let i=n[0];return!Array.isArray(i)&&typeof i=="object"}return!1}isRecord(o){return o&&!Array.isArray(o)&&typeof o=="object"&&o}ngOnInit(){}},t=e;return(()=>{e.\u0275fac=function(n){return new(n||e)}})(),(()=>{e.\u0275cmp=x({type:e,selectors:[["app-show-rec"]],inputs:{record:"record"},outputs:{selected:"selected"},standalone:!0,features:[E],decls:1,vars:1,consts:[[4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["handleArray",""],["handleRec",""],[3,"click"],[3,"record"]],template:function(n,i){n&1&&m(0,Ce,7,3,"dl",0),n&2&&u("ngForOf",i.entries)},dependencies:[e,V,ne],styles:[`dl[_ngcontent-%COMP%] {
    display: grid;
    grid-template-columns: 5em 1fr;
  }
  dt[_ngcontent-%COMP%] {
    font-weight: initial;
    max-width: 5em;
    overflow: hidden;
  }
  dd[_ngcontent-%COMP%] {
    font-weight: bolder;
    margin-left: .5em;
  }
  summary[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] {
    display: inline-block;
    margin-left: 5px;
    padding: 2px;
  }`]})})(),t})();function xe(t,e){if(t&1&&(a(0,"option"),c(1),l()),t&2){let r=e.$implicit;d(1),b(r)}}function be(t,e){if(t&1&&(a(0,"option"),c(1),l()),t&2){let r=e.$implicit;d(1),v("",r," ")}}var He=(()=>{var e;let r=class{constructor(){q(this,e,void 0);H(this,e,w(de)),this.chosenSet=new U(""),this.name=new U(""),this.availableSets$=f(this,e).swapiRoot$.pipe(Y(n=>Object.keys(n))),this.availableSets=S(this.availableSets$),this.availableOptions=S(k([this.availableSets$,this.chosenSet.valueChanges]).pipe(C(([n,i])=>n.includes(i)),A(([n,i])=>f(this,e).getSetNames(i))),{initialValue:[]}),this.result=S(k([this.chosenSet.valueChanges,this.name.valueChanges.pipe(J(250),K(),C(Boolean))]).pipe(A(([n,i])=>f(this,e).findIn(n,i)),C(Boolean),Q(n=>this.rawData=n),X(n=>f(this,e).enrich(n)),z(n=>(console.error(n),L({"Not Found":"Your search string didn't return any results"})))))}ngAfterViewInit(){this.changeTo(["people","luke"])}changeTo(n){return G(this,null,function*(){let i=yield B(this.availableSets$),[s,h]=n,y=s;if(!i.includes(s)){let R=this.rawData[s];y=f(this,e).detectSet(Array.isArray(R)?R[0]:R)}console.log(y,h),this.chosenSet.setValue(y,{emitEvent:!0}),this.name.setValue(h,{emitEvent:!0})})}},t=r;return e=new WeakMap,(()=>{r.\u0275fac=function(i){return new(i||r)}})(),(()=>{r.\u0275cmp=x({type:r,selectors:[["app-apisample"]],standalone:!0,features:[E],decls:21,vars:5,consts:[["target","blank","href","https://github.com/SanderElias/Samples/blob/master/projects/se-ng/swapi/src/lib/swapi.service.ts"],["target","blank","href","https://swapi.dev"],[3,"formControl"],[4,"ngFor","ngForOf"],["type","text","list","listOptions","autofocus","",3,"formControl"],[3,"record","selected"],["id","listOptions"]],template:function(i,s){i&1&&(a(0,"H3"),c(1,"Complex api sample"),l(),a(2,"h4"),c(3,"(first load might take a while!)"),l(),a(4,"p"),c(5," The complexity is in the API, have an look at "),a(6,"a",0),c(7,"the swapi service"),l(),c(8,"."),g(9,"br"),c(10," This sample loads all of "),a(11,"a",1),c(12,"SWAPI"),l(),c(13,` and caches it to indexedDB. This is also the reason the first load takes longer.
`),l(),a(14,"select",2),m(15,xe,2,1,"option",3),l(),g(16,"br")(17,"input",4),a(18,"app-show-rec",5),_("selected",function(y){return s.changeTo(y)}),l(),a(19,"datalist",6),m(20,be,2,1,"option",3),l()),i&2&&(d(14),u("formControl",s.chosenSet),d(1),u("ngForOf",s.availableSets()),d(2),u("formControl",s.name),d(1),u("record",s.result()),d(2),u("ngForOf",s.availableOptions()))},dependencies:[ce,ae,le,re,se,ie,oe,pe,V],styles:[`[_nghost-%COMP%] {
    display: block;
    max-height: 95vh;
    max-width: 98vw;
    overflow-x: hidden;
    overflow-y: auto;
  }`]})})(),t})();export{He as APISampleComponent};
