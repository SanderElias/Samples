import{a as P}from"./chunk-ZDGDS7Z3.js";import{b as H,c as $}from"./chunk-TJ5FK3VG.js";import{$b as me,Aa as le,Ac as f,C as oe,Cb as q,Cc as K,D as B,Eb as I,Hb as O,Hc as ve,I as se,Ib as T,Ic as x,Jb as u,Jc as be,Kb as s,Lb as l,M as ae,Mb as h,Qb as A,Qc as Ce,Tb as p,U as Q,Ub as S,Va as m,Z as U,aa as G,ac as de,bc as N,c as te,cc as ue,f as ne,fa as g,fc as c,gc as w,h as ie,hb as C,hc as E,i as J,ic as pe,jc as fe,ka as v,la as b,q as F,rb as ce,rc as he,ta as k,z as re,zc as ge}from"./chunk-CETW4QL6.js";import{c as ee}from"./chunk-DAQOROHW.js";var L=(()=>{class i{constructor(){this.mqtt=import("./mqtt.esm-6I4VX64K.js"),this.client=this.mqtt.then(e=>e.default.connectAsync("ws://10.0.0.100:1884")),this.bt="zigbee2mqtt",this.messages$=new te(e=>{let t=(n,r)=>{try{e.next({topic:n,message:JSON.parse(r.toString())})}catch{e.next({topic:n,message:r.toString()})}};return this.client.then(n=>{console.log("start listening for MQTT messages"),n.on("message",t)}),()=>{this.client.then(n=>{n.off("message",t),n.end(),console.log("MQTT client disconnected")})}}).pipe(Q({connector:()=>new ne,resetOnComplete:!0})),this.activeTopics=new Map}listenFor(e){let t=this.client;if(typeof e!="string")return console.warn("listenFor expects a string topic, got",e),J;e=e.startsWith(this.bt)?e:`${this.bt}/${e}`;let n=this.activeTopics;if(n.has(e))return console.log("already listening for",e),n.get(e);t.then(o=>{o.subscribe([e])});let r=this.messages$.pipe(B(({topic:o})=>Array.isArray(o)?o.includes(e):o===e),F(({message:o})=>o),se(100),ae(P),U({error(){t.then(o=>o.unsubscribe(e)),n.delete(e),console.log("stopped listening due of error for",e)},complete(){t.then(o=>o.unsubscribe(e)),n.delete(e),console.log("stopped listening for",e)}}),Q({connector:()=>new ie(1),resetOnComplete:!0,resetOnRefCountZero:()=>re(500)}));return this.activeTopics.set(e,r),r}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275prov=G({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var _e=(()=>{class i{constructor(){this.toggleOnText=x("Aan"),this.toggleOffText=x("Uit"),this.value=x.required(),this.valueChange=ve()}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275cmp=C({type:i,selectors:[["se-toggle"]],inputs:{toggleOnText:[1,"toggleOnText"],toggleOffText:[1,"toggleOffText"],value:[1,"value"]},outputs:{valueChange:"valueChange"},decls:5,vars:2,consts:[["type","checkbox",3,"change","checked"],[1,"slider-btn"]],template:function(t,n){t&1&&(s(0,"label")(1,"input",0),p("change",function(){return n.valueChange.emit(!n.value())}),l(),h(2,"span",1),s(3,"span"),c(4),l()()),t&2&&(m(),u("checked",n.value()),m(3),w(n.value()?n.toggleOnText():n.toggleOffText()))},styles:['[_nghost-%COMP%]{display:block}label[_ngcontent-%COMP%]{display:flex;align-items:center;cursor:pointer;gap:.25rem}input[_ngcontent-%COMP%]{display:none}.slider-btn[_ngcontent-%COMP%]{position:relative}.slider-btn[_ngcontent-%COMP%]:before, .slider-btn[_ngcontent-%COMP%]:after{bottom:0;content:"";display:inline-block;margin:auto}.slider-btn[_ngcontent-%COMP%]:before{background-color:#90ee90;border-radius:.75rem;top:0;height:1.5rem;width:2.75em}.slider-btn[_ngcontent-%COMP%]:after{background-color:green;border-radius:50%;position:absolute;top:-.125rem;left:.125rem;transition:.4s;inline-size:1.25rem;block-size:1.25rem}label[_ngcontent-%COMP%]:has(input:not(:checked))   .slider-btn[_ngcontent-%COMP%]:before{background-color:#ffa07a}label[_ngcontent-%COMP%]:has(input:not(:checked))   .slider-btn[_ngcontent-%COMP%]:after{background-color:maroon;transform:translate(1.25rem)}']})}}return i})();var M=(()=>{class i{constructor(){this.mqtt=g(L),this.devices=H(this.mqtt.listenFor("bridge/devices"),{initialValue:[]}),this.getDeviceInfo=e=>f(()=>this.#e(e()),{equal:P}),this.getDeviceStatus=e=>$({params:()=>this.#e(e()),stream:({params:t})=>t&&t.friendly_name?this.mqtt.listenFor(`zigbee2mqtt/${t.friendly_name}`):oe}),this.getStatus=e=>$({params:()=>typeof e=="string"?e:e(),stream:({params:t})=>this.mqtt.listenFor(t)}),this.joinAllowed=H(this.mqtt.listenFor("bridge/logging").pipe(B(e=>e&&e.level==="info"&&typeof e.message=="string"&&["zh:ember: [stack status] network","z2m: zigbee: disabling joining new devices"].some(t=>e.message.toLowerCase().includes(t))),U(e=>console.log("Join allowed:",e.message)),F(e=>!!e.message.includes("open"))),{initialValue:!1}),this.publish=(e,t)=>new Promise((n,r)=>{typeof t!="string"&&(t=JSON.stringify(t)),this.mqtt.client.then(o=>{o.publish(e,t,void 0,(a,_)=>{a?(console.error("Error publishing to MQTT:",a),r(a)):n(_)})})}),this.#e=e=>ge(this.devices).find(t=>t.ieee_address===e||t.friendly_name===e)}#e;static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275prov=G({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var Ee=["dlg"],Pe=(i,d)=>d.ieee_address;function Me(i,d){if(i&1&&(s(0,"h5"),c(1,"Er kan nog"),l(),s(2,"h4"),c(3),l(),s(4,"h5"),c(5,"seconden verbonden worden"),l()),i&2){let e=S();m(3),w(e.countdown())}}function Oe(i,d){i&1&&(s(0,"h5"),c(1,"klik hier om te pairen"),l())}function Te(i,d){if(i&1&&(s(0,"option",2),c(1),l()),i&2){let e=d.$implicit;u("value",e.friendly_name),m(),w(e.friendly_name)}}var ye=(()=>{class i{constructor(){this.z2m=g(M),this.signOnTimeout=k(60),this.selectedRouter=k(void 0),this.countdown=k(""),this.routerList=f(()=>this.z2m.devices().filter(e=>e.type==="Router").map(e=>({friendly_name:e.friendly_name,ieee_address:e.ieee_address}))),this.dlg=be.required("dlg"),this.showDialog=()=>{if(!this.allowJoin()){this.dlg().nativeElement.showModal();return}this.switchJoin(!1)},this.allowJoin=this.z2m.joinAllowed,this.startPairing=()=>{let e=this.selectedRouter();if(!e){console.error("No router selected for pairing");return}console.log("Starting pairing with router:",e),this.switchJoin(!0),this.dlg().nativeElement.close()},this.switchJoin=async(e,t=15)=>{try{let n=await this.z2m.publish("zigbee2mqtt/bridge/request/permit_join",{value:e,time:e?t:0,device:this.selectedRouter()});console.log("switchJoin result",n),e&&this.startCountDown()}catch(n){console.error("Error switching join:",n)}},this.startCountDown=async()=>{let e=this.signOnTimeout(),t=Date.now()+e*1e3,n=Date.now()+3e3;for(console.log("endTime",new Date(t).toLocaleTimeString(),"timeout",e,"seconds");Date.now()<t;){let r=Math.ceil((t-Date.now())/1e3),o=Math.floor(r/60),a=r%60;if(this.countdown.set(`${String(o).padStart(2,"0")}:${String(a).padStart(2,"0")}`),await new Promise(_=>setTimeout(_,15)),Date.now()>n&&!this.allowJoin()){console.log("Join cancelled by user"),this.countdown.set("");return}}console.log("Join timeout ended")}}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275cmp=C({type:i,selectors:[["se-pair-button"]],viewQuery:function(t,n){t&1&&me(n.dlg,Ee,5),t&2&&de()},hostVars:2,hostBindings:function(t,n){t&1&&p("click",function(){return n.showDialog()}),t&2&&ue("background-color",n.allowJoin()?"var(--color-success)":"var(--color-error)")},decls:14,vars:1,consts:[["dlg",""],[3,"change"],[3,"value"],[3,"click"]],template:function(t,n){if(t&1){let r=A();q(0,Me,6,1)(1,Oe,2,0,"h5"),s(2,"dialog",null,0)(4,"div")(5,"h3"),c(6,"Kies device om mee te pairen"),l(),s(7,"select",1),p("change",function(a){return v(r),b(n.selectedRouter.set(a.target.value))}),O(8,Te,2,2,"option",2,Pe),l(),s(10,"button",3),p("click",function(){return v(r),b(n.startPairing())}),c(11,"Start pairen"),l(),s(12,"button",3),p("click",function(){v(r);let a=N(3);return b(a.close())}),c(13,"Afbreken"),l()()()}t&2&&(I(n.allowJoin()?0:1),m(8),T(n.routerList()))},styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;cursor:pointer;align-items:center;justify-content:center}dialog[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;gap:1rem}"]})}}return i})();function Ae(i,d){if(i&1&&(c(0),h(1,"br"),c(2),h(3,"br"),c(4),h(5,"br"),c(6),h(7,"br")),i&2){let e,t,n,r,o=S();E(" power: ",(e=o.deviceStatus())==null?null:e.power," W"),m(2),E(" voltage: ",(t=o.deviceStatus())==null?null:t.voltage," V"),m(2),E(" current: ",(n=o.deviceStatus())==null?null:n.current," A"),m(2),E(" energy: ",(r=o.deviceStatus())==null?null:r.energy," kWh")}}function Ne(i,d){if(i&1){let e=A();s(0,"span"),c(1,"Loading..."),l(),h(2,"br"),s(3,"button",1),p("click",function(){v(e);let n=S();return b(n.refresh())}),c(4,"Refresh"),l()}}function De(i,d){if(i&1){let e=A();s(0,"se-toggle",13),p("valueChange",function(){v(e);let n=S();return b(n.toggle())}),l()}if(i&2){let e=S();u("value",e.isPoweredOn())}}var we=(()=>{class i{constructor(){this.z2m=g(M),this.ieeeAddress=x.required(),this.#e=this.z2m.getDeviceStatus(this.ieeeAddress),this.deviceLoading=this.#e.isLoading,this.deviceStatus=this.#e.value,this.deviceInfo=this.z2m.getDeviceInfo(this.ieeeAddress),this.#t=f(()=>this.deviceInfo()?.friendly_name||this.ieeeAddress()||""),this.name=f(()=>this.#t().split("/").pop()||""),this.prefix=K(()=>{let t=this.#t().match(/^(e&m|s&m|zaak|kamp)/);return t?t[0]:""}),this.isPoweredOn=f(()=>this.deviceStatus()?.state==="ON"),this.refresh=()=>{this.z2m.publish(`zigbee2mqtt/${this.ieeeAddress()}/get`,{state:""})},this.toggle=()=>{let e=this.isPoweredOn()?"OFF":"ON";console.log(`Toggling power for ${this.ieeeAddress()} to ${e}`),this.z2m.publish(`zigbee2mqtt/${this.ieeeAddress()}/set`,{state:e})},this.updateName=e=>{e.preventDefault();let t=e.target,n=t.name?.value.trim()||"",r=t.prefix?.value||"",o=`${r.trim()}/${n.trim()}`.trim();r&&n&&o!==this.#t()&&(console.log(`Updating name to ${r}/${n}`),this.z2m.publish("zigbee2mqtt/bridge/request/device/rename",{from:this.#t(),to:o,homeassistant_rename:!0}))},this._=ce(()=>{this.refresh()})}#e;#t;static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275cmp=C({type:i,selectors:[["power-meter"]],inputs:{ieeeAddress:[1,"ieeeAddress"]},decls:34,vars:14,consts:[["dlg",""],[3,"click"],[3,"value"],[3,"submit"],["name","prefix","id","prefix",3,"value"],["value","e&m",3,"selected"],["value","s&m",3,"selected"],["value","zaak",3,"selected"],["value","kamp",3,"selected"],["value","",3,"selected"],["type","text","name","name","id","name",3,"value"],["type","submit",3,"click"],["type","button",3,"click"],[3,"valueChange","value"]],template:function(t,n){if(t&1){let r=A();s(0,"h4"),c(1),s(2,"button",1),p("click",function(){v(r);let a=N(8);return b(a.showModal())}),c(3,"\u{1F589}"),l()(),q(4,Ae,8,4)(5,Ne,5,0),q(6,De,1,1,"se-toggle",2),s(7,"dialog",null,0)(9,"h4"),c(10),l(),s(11,"form",3),p("submit",function(a){return v(r),b(n.updateName(a))}),s(12,"label")(13,"span"),c(14,"indelen bij:"),l(),s(15,"select",4)(16,"option",5),c(17,"E&M"),l(),s(18,"option",6),c(19,"S&M"),l(),s(20,"option",7),c(21,"Zaak"),l(),s(22,"option",8),c(23,"Kamp"),l(),s(24,"option",9),c(25,"Geen"),l()()(),s(26,"label")(27,"span"),c(28,"Naam:"),l(),h(29,"input",10),l(),s(30,"button",11),p("click",function(){v(r);let a=N(8);return b(a.close())}),c(31,"Opslaan"),l(),s(32,"button",12),p("click",function(){v(r);let a=N(8);return b(a.close())}),c(33,"Annuleren"),l()()()}t&2&&(m(),fe("",n.prefix(),"",n.prefix()?"/":"","",n.name()," "),m(3),I(n.deviceLoading()?5:4),m(2),I(n.name().includes("Computer")?-1:6),m(4),pe("",n.prefix()," ",n.name()),m(5),u("value",n.prefix()),m(),u("selected",n.prefix()==="e&m"),m(2),u("selected",n.prefix()==="s&m"),m(2),u("selected",n.prefix()==="zaak"),m(2),u("selected",n.prefix()==="kamp"),m(2),u("selected",!n.prefix()),m(5),u("value",n.name()))},dependencies:[_e],styles:["[_nghost-%COMP%]{display:block}button[_ngcontent-%COMP%]{background-color:var(--surface-4);margin:.5rem}h4[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:0;border-radius:50%;aspect-ratio:1 / 1;padding:.5rem;transform:scale(.75)}label[_ngcontent-%COMP%]{margin-block-start:.5rem;display:grid;grid-template-columns:5rem 1fr;align-items:center;gap:.5rem}"]})}}return i})();var X,W=class extends Error{constructor(d){super(d),this.name="PrettyJSONError"}},Y=(()=>{class i extends HTMLElement{#e;#t;static get observedAttributes(){return["expand","key","truncate-string"]}static{this.DEFAULT_VARIABLES={light:{keyColor:"#cc0000",arrowColor:"#737373",braceColor:"#0030f0",bracketColor:"#0030f0",stringColor:"#009900",numberColor:"#0000ff",nullColor:"#666666",booleanColor:"#d23c91",commaColor:"#666666",ellipsisColor:"#666666",indent:"2rem",fontSize:"1rem",fontFamily:"monospace"},dark:{keyColor:"#f73d3d",arrowColor:"#6c6c6c",braceColor:"#0690bc",bracketColor:"#0690bc",stringColor:"#21c521",numberColor:"#0078b3",nullColor:"#8c8888",booleanColor:"#c737b3",commaColor:"#848181",ellipsisColor:"#c2c2c2",indent:"2rem",fontSize:"1rem",fontFamily:"monospace"}}}#r(){let t=window.matchMedia("(prefers-color-scheme: dark)").matches?X.DEFAULT_VARIABLES.dark:X.DEFAULT_VARIABLES.light;if(!this.shadowRoot)return t;let n=getComputedStyle(this.shadowRoot.host);return{keyColor:n.getPropertyValue("--key-color")||t.keyColor,arrowColor:n.getPropertyValue("--arrow-color")||t.arrowColor,braceColor:n.getPropertyValue("--brace-color")||t.braceColor,bracketColor:n.getPropertyValue("--bracket-color")||t.bracketColor,stringColor:n.getPropertyValue("--string-color")||t.stringColor,numberColor:n.getPropertyValue("--number-color")||t.numberColor,nullColor:n.getPropertyValue("--null-color")||t.nullColor,booleanColor:n.getPropertyValue("--boolean-color")||t.booleanColor,commaColor:n.getPropertyValue("--comma-color")||t.commaColor,ellipsisColor:n.getPropertyValue("--ellipsis-color")||t.ellipsisColor,indent:n.getPropertyValue("--indent")||t.indent,fontSize:n.getPropertyValue("--font-size")||t.fontSize,fontFamily:n.getPropertyValue("--font-family")||t.fontFamily}}get#d(){let e=this.#r();return`/* css */
    :host {
      --key-color: ${e.keyColor};
      --arrow-color: ${e.arrowColor};
      --brace-color: ${e.braceColor};
      --bracket-color: ${e.bracketColor};
      --string-color: ${e.stringColor};
      --number-color: ${e.numberColor};
      --null-color: ${e.nullColor};
      --boolean-color: ${e.booleanColor};
      --comma-color: ${e.commaColor};
      --ellipsis-color: ${e.ellipsisColor};
      --indent: ${e.indent};
      --font-size: ${e.fontSize};
      --font-family: ${e.fontFamily};
    }
    button {
      border: none;
      background: transparent;
      cursor: pointer;
      font-family: inherit;
      font-size: var(--font-size);
      vertical-align: text-bottom;
    }
    .container {
      font-family: var(--font-family);
      font-size: var(--font-size);
    }
    .key {
      color: var(--key-color);
      margin-right: 0.5rem;
      padding: 0;
    }
    .key .arrow {
      width: 1rem;
      height: 0.75rem;
      margin-left: -1.25rem;
      padding-right: 0.25rem;
      vertical-align: baseline;
    }
    .arrow .triangle {
      fill: var(--arrow-color);
    }
    .comma {
      color: var(--comma-color);
    }
    .brace {
      color: var(--brace-color);
    }
    .string,
    .url {
      color: var(--string-color);
    }
    .number,
    .bigint {
      color: var(--number-color);
    }
    .null {
      color: var(--null-color);
    }
    .boolean {
      color: var(--boolean-color);
    }

    .ellipsis {
      width: 1rem;
      padding: 0;
      color: var(--ellipsis-color);
    }
    .ellipsis::after {
      content: "\u2026";
    }
    .string .ellipsis::after {
      color: var(--string-color);
    }
    .triangle {
      fill: black;
      stroke: black;
      stroke-width: 0;
    }
    .row {
      padding-left: var(--indent);
    }
    .row .row {
      display: block;
    }
    .row > div,
    .row > span {
      display: inline-block;
    }
  `}constructor(){super(),this.#t=!0,this.attachShadow({mode:"open"})}get#o(){let e=this.getAttribute("expand");if(e===null)return 1;let t=Number.parseInt(e);return isNaN(t)||t<0?0:t}get#n(){let t=this.getAttribute("truncate-string");if(t===null)return 500;let n=Number.parseInt(t);return isNaN(n)||n<0?0:n}#s(){this.#t=!this.#t,this.setAttribute("expand",this.#t?String(this.#o+1):"0"),this.#i()}#u(e,t,n){if(this.#a(e)){let r=this.#c();return r.appendChild(this.#l(e)),r}return this.#h(e)}#a(e){return typeof e!="object"||e===null}#p(){try{return new URL(this.#e),!0}catch{return!1}}#l(e){let t=document.createElement("div"),n=typeof e=="object"?"null":typeof e;if(t.className=`primitive value ${n}`,typeof e=="string")if(this.#p()){let r=document.createElement("a");r.className="url",r.href=this.#e,r.target="_blank",r.textContent=e,t.append('"',r,'"')}else e.length>this.#n?t.appendChild(this.#f(e)):t.textContent=JSON.stringify(e);else t.textContent=JSON.stringify(e);return t}#f(e){let t=document.createElement("div");t.dataset.expandedTimes="1",t.className="truncated string";let n=document.createElement("button");return n.className="ellipsis",n.addEventListener("click",()=>{let r=Number.parseInt(t.dataset.expandedTimes??"1");t.dataset.expandedTimes=String(r+1);let o=e.slice(0,(r+1)*this.#n),a=t.childNodes[1];t.replaceChild(document.createTextNode(o),a)}),t.append('"',e.slice(0,this.#n),n,'"'),t}#c(){let e=document.createElement("div");return e.className="container",e}#h(e){let t=Array.isArray(e),n=this.getAttribute("key"),r=this.#o,o=this.#n,a=this.#c();if(a.classList.add(t?"array":"object"),n){a.classList.add("row");let y=this.#m(n,{withArrow:!0,expanded:this.#t});y.addEventListener("click",this.#s.bind(this)),a.appendChild(y)}let _=document.createElement("span");_.className="open brace",_.textContent=t?"[":"{",a.appendChild(_);let R=document.createElement("span");if(R.className="close brace",R.textContent=t?"]":"}",!this.#t){let y=document.createElement("button");return y.className="ellipsis",a.appendChild(y),y.addEventListener("click",this.#s.bind(this)),a.appendChild(R),a}return Object.entries(e).forEach(([y,Z],Se)=>{if(this.#a(Z)){let j=document.createElement("div");if(j.className="row",!t){let z=this.#m(y);j.appendChild(z)}if(j.appendChild(this.#l(Z)),a.appendChild(j),!(Se===Object.keys(e).length-1)){let z=document.createElement("span");z.className="comma",z.textContent=",",j.appendChild(z)}return}let V=document.createElement("pretty-json");V.textContent=JSON.stringify(Z),V.setAttribute("expand",String(r-1)),V.setAttribute("truncate-string",String(o)),V.setAttribute("key",y),a.appendChild(V)}),a.appendChild(R),a}#g({expanded:e=!1}={}){let t=document.createElementNS("http://www.w3.org/2000/svg","svg");t.setAttribute("width","100"),t.setAttribute("height","100"),t.setAttribute("viewBox","0 0 100 100"),t.setAttribute("class","arrow");let n=document.createElementNS("http://www.w3.org/2000/svg","polygon");return n.setAttribute("class","triangle"),n.setAttribute("points","0,0 100,50 0,100"),e&&n.setAttribute("transform","rotate(90 50 50)"),t.appendChild(n),t}#m(e,{withArrow:t=!1,expanded:n=!1}={}){let r=document.createElement(t?"button":"span");if(r.className="key",t){let _=this.#g({expanded:n});r.appendChild(_)}let o=document.createElement("span");o.className="key-name",o.textContent=JSON.stringify(e),r.appendChild(o);let a=document.createElement("span");return a.className="colon",a.textContent=":",r.appendChild(a),r}#i(){if(!this.shadowRoot)throw new W("Shadow root not available");if(this.shadowRoot.innerHTML="",this.shadowRoot.appendChild(this.#u(this.#e,this.#o,void 0)),this.shadowRoot.querySelector("[data-pretty-json]"))return;let e=document.createElement("style");e.setAttribute("data-pretty-json",""),e.textContent=this.#d,this.shadowRoot.appendChild(e)}attributeChangedCallback(e,t,n){if(e==="expand"){if(n===null)this.#t=!1;else{let r=Number.parseInt(n);this.#t=!isNaN(r)&&r>0}this.#i()}}connectedCallback(){try{this.#e=JSON.parse(this.textContent??"")}catch(e){let t=`Error parsing JSON: ${e instanceof Error?e.message:"Unknown error"}`;throw new W(t)}this.#i()}update(e){this.#e=e,this.#i()}}return i})();X=Y;var xe=(()=>{class i{#e;#t;#r;constructor(){this.#e=g(le).nativeElement,this.json=x(),this.#t=f(()=>{let e=this.json();try{JSON.stringify(e)}catch{e={error:"Invalid JSON"}}return e}),this.#r=Ce({write:()=>{this.#e.update(this.#t())}}),typeof customElements<"u"&&(this.#e.innerText="{}",customElements.get("pretty-json")||customElements.define("pretty-json",Y))}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275cmp=C({type:i,selectors:[["pretty-json"]],inputs:{json:[1,"json"]},decls:0,vars:0,template:function(t,n){},styles:["[_nghost-%COMP%]{display:block}"]})}}return i})();var Ve=(i,d)=>d.ieee_address,je=(i,d)=>d.name,ze=(i,d)=>d[0];function qe(i,d){if(i&1&&h(0,"power-meter",1),i&2){let e=d.$implicit;u("ieeeAddress",e.ieee_address)}}function Ie(i,d){if(i&1&&(s(0,"option",3),c(1),l()),i&2){let e=d.$implicit;u("value",e.name),m(),w(e.name)}}function $e(i,d){if(i&1&&(s(0,"option",3),c(1),l()),i&2){let e=d.$implicit;u("value",e[0]),m(),w(e[1])}}var Et=["e&m","s&m","zaak","kamp"],Pt=(()=>{class i{constructor(){this.mqtt=g(L),this.z2m=g(M),this.state=k({}),this.cleanState=f(()=>ke(this.state())),this.selected=K((...e)=>{let t=this.devices(),n=this.filter();if(!(!t||t.length===0)&&n){let r=t.find(o=>o.definition?.model===n);if(r)return r.friendly_name||r.ieee_address}}),this.filter=k(void 0),this.deviceList=f(()=>{let e=this.devices(),t=this.filter();return e?.filter(n=>t?n.definition?.model===t:!0).map(n=>({name:n.friendly_name||n.ieee_address})).sort()},{equal:P}),this.deviceTypes=f(()=>this.devices()?.reduce((n,r)=>{let o=r.definition?.model||"";return o&&!n.find(a=>a[0]===o)&&n.push([o,r.definition?.description||""]),n},[]).sort(),{equal:P}),this.powerMeters=f(()=>this.devices()?.filter(t=>t.definition?.exposes?.some(n=>n.property==="power"&&n.type==="numeric")).sort((t,n)=>t.friendly_name.localeCompare(n.friendly_name))),this.selectedDetails=f(()=>{let e=this.devices(),t=this.selected();if(!t)return;let n=e?.find(r=>r.friendly_name===t||r.ieee_address===t);if(n)return n}),this.devices=this.z2m.devices,this.selectedDevice=$({params:this.selected,stream:e=>{let t=e.params;return t?(console.log("selectedDevice",t),this.mqtt.listenFor(t)):J}})}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275cmp=C({type:i,selectors:[["se-mqtt"]],features:[he([L,M])],decls:17,vars:3,consts:[[1,"devGrid"],[3,"ieeeAddress"],[3,"change"],[3,"value"],[1,"grid"],[3,"json"]],template:function(t,n){t&1&&(s(0,"div",0),h(1,"se-pair-button"),O(2,qe,1,1,"power-meter",1,Ve),l(),s(4,"details")(5,"summary"),c(6,"Select Device"),l(),s(7,"select",2),p("change",function(o){return n.selected.set(o.target.value)}),O(8,Ie,2,2,"option",3,je),l(),s(10,"select",2),p("change",function(o){return n.filter.set(o.target.value)}),O(11,$e,2,2,"option",3,ze),l(),c(13),s(14,"div",4),h(15,"pretty-json",5)(16,"pretty-json",5),l()()),t&2&&(m(2),T(n.powerMeters()),m(6),T(n.deviceList()),m(3),T(n.deviceTypes()),m(2),E(" ",n.selected()," "),m(2),u("json",n.selectedDevice.value()),m(),u("json",n.selectedDetails()))},dependencies:[xe,we,ye],styles:["[_nghost-%COMP%]{display:block;padding:1rem;--color-success: #1b3003;--color-error: #351411}div.grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:30rem 1fr;gap:10px}div.grid[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{background:var(--surface-3);border-radius:1rem;min-inline-size:30rem;min-block-size:30lh;padding:1rem;overflow:auto}label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:0.5rem}div.devGrid[_ngcontent-%COMP%]{margin-block-end:1rem;display:grid;grid-template-columns:repeat(auto-fit,minmax(15rem,1fr));gap:1rem}div.devGrid[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{background:var(--surface-3);border-radius:1rem;padding:1rem;overflow:auto}"]})}}return i})(),ke=(i,d="")=>{let n=i,{value:e}=n,t=ee(n,["value"]);return Object.keys(t).length===0?e:Object.fromEntries(Object.entries(i).map(([r,o])=>[r,typeof o=="object"?ke(o):o]))};export{Pt as MqttComponent,Et as zigbeePrefixes};
