import{d as A}from"./chunk-JY2GUBAW.js";import"./chunk-RPS3TBGS.js";import"./chunk-GR2PXCGU.js";import{Eb as Z,Fa as V,Ra as C,Sa as x,V as j,Vb as k,Wa as E,Xa as m,Ya as h,ac as z,cb as I,cc as L,db as l,eb as p,fb as O,g as S,ha as y,mb as v,na as M,o as D,sb as d,tb as _,z as T}from"./chunk-X5MK5QQ4.js";import"./chunk-G5KKTNWD.js";var f={schedule(t,e){let n=setTimeout(t,e);return()=>clearTimeout(n)},scheduleBeforeRender(t){if(typeof window>"u")return f.schedule(t,0);if(typeof window.requestAnimationFrame>"u")return f.schedule(t,16);let e=window.requestAnimationFrame(t);return()=>window.cancelAnimationFrame(e)}};function q(t){return t.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}function B(t){return!!t&&t.nodeType===Node.ELEMENT_NODE}function N(t){return typeof t=="function"}var b;function U(t,e){if(!b){let n=Element.prototype;b=n.matches||n.matchesSelector||n.mozMatchesSelector||n.msMatchesSelector||n.oMatchesSelector||n.webkitMatchesSelector}return t.nodeType===Node.ELEMENT_NODE?b.call(t,e):!1}function W(t,e){return t===e||t!==t&&e!==e}function Y(t){let e={};return t.forEach(({propName:n,templateName:i})=>{e[q(i)]=n}),e}function $(t,e){return e.get(C).resolveComponentFactory(t).inputs}function G(t,e){let n=t.childNodes,i=e.map(()=>[]),s=-1;e.some((o,a)=>o==="*"?(s=a,!0):!1);for(let o=0,a=n.length;o<a;++o){let c=n[o],r=J(c,e,s);r!==-1&&i[r].push(c)}return i}function J(t,e,n){let i=n;return B(t)&&e.some((s,o)=>s!=="*"&&U(t,s)?(i=o,!0):!1),i}var K=10,R=class{constructor(e,n){this.componentFactory=n.get(C).resolveComponentFactory(e)}create(e){return new w(this.componentFactory,e)}},w=class{constructor(e,n){this.componentFactory=e,this.injector=n,this.eventEmitters=new S(1),this.events=this.eventEmitters.pipe(j(i=>T(...i))),this.componentRef=null,this.viewChangeDetectorRef=null,this.inputChanges=null,this.hasInputChanges=!1,this.implementsOnChanges=!1,this.scheduledChangeDetectionFn=null,this.scheduledDestroyFn=null,this.initialInputValues=new Map,this.unchangedInputs=new Set(this.componentFactory.inputs.map(({propName:i})=>i)),this.ngZone=this.injector.get(k),this.elementZone=typeof Zone>"u"?null:this.ngZone.run(()=>Zone.current)}connect(e){this.runInZone(()=>{if(this.scheduledDestroyFn!==null){this.scheduledDestroyFn(),this.scheduledDestroyFn=null;return}this.componentRef===null&&this.initializeComponent(e)})}disconnect(){this.runInZone(()=>{this.componentRef===null||this.scheduledDestroyFn!==null||(this.scheduledDestroyFn=f.schedule(()=>{this.componentRef!==null&&(this.componentRef.destroy(),this.componentRef=null,this.viewChangeDetectorRef=null)},K))})}getInputValue(e){return this.runInZone(()=>this.componentRef===null?this.initialInputValues.get(e):this.componentRef.instance[e])}setInputValue(e,n){this.runInZone(()=>{if(this.componentRef===null){this.initialInputValues.set(e,n);return}W(n,this.getInputValue(e))&&!(n===void 0&&this.unchangedInputs.has(e))||(this.recordInputChange(e,n),this.unchangedInputs.delete(e),this.hasInputChanges=!0,this.componentRef.instance[e]=n,this.scheduleDetectChanges())})}initializeComponent(e){let n=m.create({providers:[],parent:this.injector}),i=G(e,this.componentFactory.ngContentSelectors);this.componentRef=this.componentFactory.create(n,i,e),this.viewChangeDetectorRef=this.componentRef.injector.get(L),this.implementsOnChanges=N(this.componentRef.instance.ngOnChanges),this.initializeInputs(),this.initializeOutputs(this.componentRef),this.detectChanges(),this.injector.get(z).attachView(this.componentRef.hostView)}initializeInputs(){this.componentFactory.inputs.forEach(({propName:e})=>{this.initialInputValues.has(e)&&this.setInputValue(e,this.initialInputValues.get(e))}),this.initialInputValues.clear()}initializeOutputs(e){let n=this.componentFactory.outputs.map(({propName:i,templateName:s})=>e.instance[i].pipe(D(a=>({name:s,value:a}))));this.eventEmitters.next(n)}callNgOnChanges(e){if(!this.implementsOnChanges||this.inputChanges===null)return;let n=this.inputChanges;this.inputChanges=null,e.instance.ngOnChanges(n)}markViewForCheck(e){this.hasInputChanges&&(this.hasInputChanges=!1,e.markForCheck())}scheduleDetectChanges(){this.scheduledChangeDetectionFn||(this.scheduledChangeDetectionFn=f.scheduleBeforeRender(()=>{this.scheduledChangeDetectionFn=null,this.detectChanges()}))}recordInputChange(e,n){if(!this.implementsOnChanges)return;this.inputChanges===null&&(this.inputChanges={});let i=this.inputChanges[e];if(i){i.currentValue=n;return}let s=this.unchangedInputs.has(e),o=s?void 0:this.getInputValue(e);this.inputChanges[e]=new M(o,n,s)}detectChanges(){this.componentRef!==null&&(this.callNgOnChanges(this.componentRef),this.markViewForCheck(this.viewChangeDetectorRef),this.componentRef.changeDetectorRef.detectChanges())}runInZone(e){return this.elementZone&&Zone.current!==this.elementZone?this.ngZone.run(e):e()}},F=class extends HTMLElement{constructor(){super(...arguments),this.ngElementEventsSubscription=null}};function P(t,e){let n=$(t,e.injector),i=e.strategyFactory||new R(t,e.injector),s=Y(n),a=class extends F{get ngElementStrategy(){if(!this._ngElementStrategy){let r=this._ngElementStrategy=i.create(this.injector||e.injector);n.forEach(({propName:u})=>{if(!this.hasOwnProperty(u))return;let g=this[u];delete this[u],r.setInputValue(u,g)})}return this._ngElementStrategy}constructor(r){super(),this.injector=r}attributeChangedCallback(r,u,g,ee){let H=s[r];this.ngElementStrategy.setInputValue(H,g)}connectedCallback(){let r=!1;this.ngElementStrategy.events&&(this.subscribeToEvents(),r=!0),this.ngElementStrategy.connect(this),r||this.subscribeToEvents()}disconnectedCallback(){this._ngElementStrategy&&this._ngElementStrategy.disconnect(),this.ngElementEventsSubscription&&(this.ngElementEventsSubscription.unsubscribe(),this.ngElementEventsSubscription=null)}subscribeToEvents(){this.ngElementEventsSubscription=this.ngElementStrategy.events.subscribe(r=>{let u=new CustomEvent(r.name,{detail:r.value});this.dispatchEvent(u)})}},o=a;return(()=>{a.observedAttributes=Object.keys(s)})(),n.forEach(({propName:c})=>{Object.defineProperty(o.prototype,c,{get(){return this.ngElementStrategy.getInputValue(c)},set(r){this.ngElementStrategy.setInputValue(c,r)},configurable:!0,enumerable:!0})}),o}var Q=(()=>{let e=class{constructor(i){this.parent=i,this.property=""}get content(){if(this.parent&&this.property&&this.parent[this.property])return this.parent[this.property]}},t=e;return(()=>{e.\u0275fac=function(s){return new(s||e)(h(X))}})(),(()=>{e.\u0275cmp=y({type:e,selectors:[["dyn-data"]],inputs:{property:"property"},decls:1,vars:1,template:function(s,o){s&1&&d(0),s&2&&_(o.content)},styles:["[_nghost-%COMP%]{display:inline-block;border:1px solid green;padding:5px 2px}"]})})(),t})(),X=(()=>{let e=class{constructor(i,s,o){this.elmRef=i,this.sanitizer=o,this.elm=this.elmRef.nativeElement,this.name="Angular",this.html=`
  <h1>Some random HTML</h1>
  <p>Well, <dyn-data property='name'></dyn-data> is awesome</p>
  <p>
  To do it this way is really dangerous, as it will expose to all kind of security issues.
  (see the functioning alert in the sample code!!)
  But the person that asked the question, needed a way to run script tags, and this is the easiest way.
  With this sample comes a severe warning, that this is really dangerous.
  </p>
  <button onclick="alert('hi')">hi</button>
  `;let a=P(Q,{injector:s});customElements.define("dyn-data",a)}ngOnInit(){this.update(this.html)}update(i){let s=this.elm.querySelector("#target");s.innerHTML=i}},t=e;return(()=>{e.\u0275fac=function(s){return new(s||e)(h(x),h(m),h(A))}})(),(()=>{e.\u0275cmp=y({type:e,selectors:[["app-dynamichtml"]],standalone:!0,features:[Z],decls:7,vars:2,consts:[["type","text",3,"value","input"],[3,"value","input"],["id","target"]],template:function(s,o){s&1&&(l(0,"h1"),d(1,"Dynamic HTML sample"),p(),l(2,"input",0),v("input",function(c){return o.name=c.target.value}),p(),l(3,"textarea",1),v("input",function(c){return o.update(c.target.value)}),p(),l(4,"button"),d(5,"Update"),p(),O(6,"div",2)),s&2&&(E(2),I("value",o.name),E(1),I("value",o.html))},styles:["textarea[_ngcontent-%COMP%]{display:block;height:6rem;width:30rem;padding:0}"]})})(),t})();export{X as DynamicHtmlComponent};
