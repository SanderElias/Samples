import{e as te}from"./chunk-GLGQNGFM.js";import"./chunk-XZCHICF6.js";import{b as G,d as J,i as $,n as K,q as Q,r as X,s as Z,w as ee}from"./chunk-H5OL5AAF.js";import{i as w,j as q,k as z}from"./chunk-GR2PXCGU.js";import{B as v,C as N,Eb as y,F as j,G as B,Gb as R,Hb as F,Jb as Y,L as U,Rb as O,V as H,W as L,Wa as c,Ya as W,ab as _,bb as I,cb as p,db as l,eb as s,fb as h,gb as A,ha as g,hb as T,j as P,jb as k,mb as u,nb as m,o as V,p as D,pa as E,qa as b,sb as a,tb as x,ub as C}from"./chunk-X5MK5QQ4.js";import{h as M}from"./chunk-G5KKTNWD.js";function oe(n,i){if(n&1){let o=k();A(0),l(1,"details")(2,"summary"),a(3),l(4,"button",4),u("click",function(){let r=E(o).ngIf,f=m(2).$implicit,d=m();return b(d.selected.emit([d.key(f),r.name||r.title]))}),a(5," Select "),s()(),h(6,"app-show-rec",5),s(),T()}if(n&2){let o=i.ngIf;c(3),C("",o.name||o.title," "),c(3),p("record",o)}}function re(n,i){if(n&1&&a(0),n&2){let o=m(2).$implicit,t=m();C(" ",t.val(o)," ")}}function ae(n,i){if(n&1&&(A(0),_(1,oe,7,2,"ng-container",1),_(2,re,1,1,"ng-template",null,3,O),T()),n&2){let o=I(3),t=m().$implicit,e=m();c(1),p("ngIf",e.isRecord(e.val(t)))("ngIfElse",o)}}function le(n,i){if(n&1){let o=k();l(0,"details")(1,"summary"),a(2),l(3,"button",4),u("click",function(){let r=E(o).$implicit,f=m(2).$implicit,d=m();return b(d.selected.emit([d.key(f),r.name||r.title]))}),a(4," Select "),s()(),h(5,"app-show-rec",5),s()}if(n&2){let o=i.$implicit;c(2),C("",o.name||o.title," "),c(3),p("record",o)}}function se(n,i){if(n&1&&_(0,le,6,2,"details",0),n&2){let o=m().$implicit,t=m();p("ngForOf",t.val(o))}}function ce(n,i){if(n&1&&(l(0,"dl")(1,"dt"),a(2),s(),l(3,"dd"),_(4,ae,4,2,"ng-container",1),_(5,se,1,1,"ng-template",null,2,O),s()()),n&2){let o=i.$implicit,t=I(6),e=m();c(2),x(e.key(o)),c(2),p("ngIf",!e.isRecArray(o))("ngIfElse",t)}}var ne=(()=>{let i=class{set record(t){t&&(this.entries=Object.entries(t))}constructor(){this.selected=new Y,this.key=t=>t[0],this.val=t=>t[1]}isRecArray(t){let e=t[1];if(Array.isArray(e)&&e.length>0){let r=e[0];return!Array.isArray(r)&&typeof r=="object"}return!1}isRecord(t){return t&&!Array.isArray(t)&&typeof t=="object"&&t}ngOnInit(){}},n=i;return(()=>{i.\u0275fac=function(e){return new(e||i)}})(),(()=>{i.\u0275cmp=g({type:i,selectors:[["app-show-rec"]],inputs:{record:"record"},outputs:{selected:"selected"},standalone:!0,features:[y],decls:1,vars:1,consts:[[4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["handleArray",""],["handleRec",""],[3,"click"],[3,"record"]],template:function(e,r){e&1&&_(0,ce,7,3,"dl",0),e&2&&p("ngForOf",r.entries)},dependencies:[i,w,q],styles:[`dl[_ngcontent-%COMP%] {
    display: grid;
    grid-template-columns: 5em 1fr;
  }
  dt[_ngcontent-%COMP%] {
    font-weight: initial;
    max-width: 5em;
    overflow: hidden;
  }
  dd[_ngcontent-%COMP%] {
    font-weight: bolder;
    margin-left: .5em;
  }
  summary[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] {
    display: inline-block;
    margin-left: 5px;
    padding: 2px;
  }`]})})(),n})();function pe(n,i){if(n&1&&(l(0,"option"),a(1),s()),n&2){let o=i.$implicit;c(1),x(o)}}var Ee=(()=>{let i=class{constructor(t){this.sw=t,this.chosenSet=new $(""),this.name=new $(""),this.availableSets$=this.sw.swapiRoot$.pipe(V(e=>Object.keys(e))),this.result$=D([this.chosenSet.valueChanges,this.name.valueChanges.pipe(B(250),U(),v(Boolean))]).pipe(H(([e,r])=>this.sw.findIn(e,r)),v(Boolean),L(e=>this.rawData=e),j(e=>this.sw.enrich(e)),N(e=>(console.error(e),P({"Not Found":"Your search string didn't return any results"}))))}ngAfterViewInit(){this.changeTo(["people","luke"])}changeTo(t){return M(this,null,function*(){let e=yield this.availableSets$.toPromise(),[r,f]=t,d=r;if(!e.includes(r)){let S=this.rawData[r];d=this.sw.detectSet(Array.isArray(S)?S[0]:S)}console.log(d,f),this.chosenSet.setValue(d,{emitEvent:!0}),this.name.setValue(f,{emitEvent:!0})})}},n=i;return(()=>{i.\u0275fac=function(e){return new(e||i)(W(te))}})(),(()=>{i.\u0275cmp=g({type:i,selectors:[["app-apisample"]],standalone:!0,features:[y],decls:20,vars:8,consts:[["target","blank","href","https://github.com/SanderElias/Samples/blob/master/projects/se-ng/swapi/src/lib/swapi.service.ts"],["target","blank","href","https://swapi.dev"],[3,"formControl"],[4,"ngFor","ngForOf"],["type","text","autofocus","",3,"formControl"],[3,"record","selected"]],template:function(e,r){e&1&&(l(0,"H3"),a(1,"Complex api sample"),s(),l(2,"h4"),a(3,"(first load might take a while!)"),s(),l(4,"p"),a(5," The complexity is in the API, have an look at "),l(6,"a",0),a(7,"the swapi service"),s(),a(8,"."),h(9,"br"),a(10," This sample loads all of "),l(11,"a",1),a(12,"SWAPI"),s(),a(13,` and caches it to indexedDB. This is also the reason the first load takes longer.
`),s(),l(14,"select",2),_(15,pe,2,1,"option",3),R(16,"async"),s(),h(17,"input",4),l(18,"app-show-rec",5),u("selected",function(d){return r.changeTo(d)}),R(19,"async"),s()),e&2&&(c(14),p("formControl",r.chosenSet),c(1),p("ngForOf",F(16,4,r.availableSets$)),c(2),p("formControl",r.name),c(1),p("record",F(19,6,r.result$)))},dependencies:[ee,X,Z,G,Q,J,K,ne,z,w],styles:[`[_nghost-%COMP%] {
    display: block;
    max-height: 95vh;
    max-width: 98vw;
    overflow-x: hidden;
    overflow-y: auto;
  }`]})})(),n})();export{Ee as APISampleComponent};
