import{a as P}from"./chunk-UN5FJAGC.js";import{a as Ce,b as G,c as w,d as R,e as _e,f as g,g as E,j as u,k as Ee,l as H,m as J,n as x,o as Me,p as Se,q as z,r as f,s as Fe}from"./chunk-F4CUQX36.js";import{B as xe,g as ye,j as be,n as we}from"./chunk-NEHJMRLT.js";import{c as he,d as ve}from"./chunk-FSDOMXMR.js";import"./chunk-BHC7RI4T.js";import"./chunk-DTTTM7SN.js";import"./chunk-FT3LB7SV.js";import{$b as N,$c as fe,Ac as ue,Ea as k,Mb as c,Nb as p,Pb as se,Rb as le,Rc as y,Sb as j,Sc as V,Tb as me,Tc as ge,Ub as L,Vb as O,Wb as b,Xb as l,Yb as o,Yc as T,Zb as d,Zc as X,_a as s,_b as F,aa as ae,ec as D,fa as A,fc as oe,hd as Y,ic as _,jc as B,ka as M,kc as I,la as S,rc as $,sb as C,sc as Q,uc as de,vc as ce,wa as q,xc as r,yc as pe,zc as Z}from"./chunk-AAKWIQ7G.js";import"./chunk-C6Q5SG76.js";var h=(function(t){return t.Email="E-Mail",t.Fax="Fax",t.Mobile="Mobile",t.Phone="Phone",t})(h||{});var Re=["contacts",""];function Ae(t,a){if(t&1&&(l(0,"option",5),r(1),o()),t&2){let e=a.$implicit;b("value",e),s(),pe(e)}}function qe(t,a){if(t&1){let e=D();l(0,"div",1)(1,"button",2),_("click",function(){let i=M(e).$implicit,m=I();return S(m.delContact(i().value()))}),r(2,"\u{1F5D1}\uFE0F"),o(),l(3,"label")(4,"span"),r(5,"type"),o(),l(6,"select",3)(7,"option",4),r(8,"-- Select type --"),o(),L(9,Ae,2,2,"option",5,me),o(),c(),o(),l(11,"label")(12,"span"),r(13,"info"),o(),d(14,"input",6),c(),o(),l(15,"label")(16,"span"),r(17,"priority"),o(),d(18,"input",7),c(),o()()}if(t&2){let e=a.$implicit,n=I();s(),b("disabled",n.isLastOne()),s(5),p(e.type,"formField"),s(3),O(n.types),s(5),de("background-color",n.backgroundColor(e.info)()),p(e.info,"formField"),s(4),p(e.priority,"formField")}}var De=(()=>{class t{constructor(){this.contacts=T.required(),this.contactList=y(()=>this.contacts()()),this.isLastOne=y(()=>this.contactList().value().length===1),this.types=Object.values(h),this.backgroundColor=e=>y(()=>{let{pending:n,dirty:i}=e();return n()?"var(--orange-6)":""})}addContact(){this.contactList().value.update(e=>[...e,{type:h.Email,info:"",priority:0}])}delContact(e){let n=this.contactList().value;n().length>1&&n.update(i=>i.filter(m=>m!==e))}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275cmp=C({type:t,selectors:[["fieldset","contacts",""]],inputs:{contacts:[1,"contacts"]},attrs:Re,decls:8,vars:0,consts:[["type","button",1,"action",3,"click"],[1,"row"],["type","button",1,"action",3,"click","disabled"],["showError","",3,"formField"],["value",""],[3,"value"],["type","text","placeholder","value","showError","",3,"formField"],["type","number","placeholder","priority",3,"formField"]],template:function(n,i){n&1&&(l(0,"legend"),r(1,"Contacts "),l(2,"button",0),_("click",function(){return i.addContact()}),r(3,"+"),o()(),l(4,"div"),r(5,' Try adding the contact "i@exists.gov" to see aSync validation in action. '),o(),L(6,qe,19,9,"div",1,j)),n&2&&(s(6),O(i.contacts()))},dependencies:[E,P],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;gap:var(--size-2)}div.row[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(4,max-content);gap:var(--size-2);align-items:baseline}@media(width<680px){div.row[_ngcontent-%COMP%]{grid-template-columns:max-content 1fr;grid-template-rows:1fr 1fr 1fr;gap:0}div.row[_ngcontent-%COMP%]   button.action[_ngcontent-%COMP%]{grid-row:span 3}}input[type=number][_ngcontent-%COMP%]{width:3rem}label[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{clip:rect(0 0 0 0);clip-path:inset(50%);height:1px;overflow:hidden;position:absolute;white-space:nowrap;width:1px}select[_ngcontent-%COMP%]{width:16ch}div[_ngcontent-%COMP%] > button.action[_ngcontent-%COMP%]{position:inherit;margin-inline-start:0}"]})}}return t})();var je=["formField",""],K=1e3,Ie=(()=>{class t{constructor(){this.field=A(E),this.MAX=K,this.value=fe(0),this.min=T(0),this.max=T(K),this.showMinMax=q(!1),this.lowerBoundary=V(()=>this.min()??0),this.upperBoundary=V({source:this.lowerBoundary,computation:(e,n)=>{let i=n?.value??K;return Math.min(K,i<e?e+1:i)}}),this.upperLowest=y(()=>Math.max(this.lowerBoundary()+1,this.min()??0))}getRandomInt(){this.value.set(Math.floor(Math.random()*(this.upperBoundary()-this.lowerBoundary()+1))+this.lowerBoundary())}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275cmp=C({type:t,selectors:[["se-input-random-int","formField",""]],hostVars:2,hostBindings:function(n,i){n&2&&ce("min-max",i.showMinMax())},inputs:{value:[1,"value"],min:[1,"min"],max:[1,"max"]},outputs:{value:"valueChange"},attrs:je,decls:10,vars:9,consts:[["title","click to set boundaries",3,"click"],["type","range","step","1",3,"input","min","max","value"],["type","range","step","1",3,"input","blur","min","max","value"],["type","button",3,"click"]],template:function(n,i){n&1&&(F(0,"span",0),B("click",function(){return i.showMinMax.set(!i.showMinMax())}),r(1),N(),F(2,"label"),r(3,"Min value: "),F(4,"input",1),B("input",function(v){return i.lowerBoundary.set(+v.target.value)}),N()(),F(5,"label"),r(6,"Max value: "),F(7,"input",2),B("input",function(v){return i.upperBoundary.set(+v.target.value)})("blur",function(){return i.field.state().markAsTouched()}),N()(),F(8,"button",3),B("click",function(){return i.getRandomInt()}),r(9),N()),n&2&&(s(),Z("current value: ",i.value()," "),s(3),oe("min",i.min()??0)("max",i.max()??i.MAX)("value",i.lowerBoundary()),s(3),oe("min",i.upperLowest())("max",i.max()??i.MAX)("value",i.upperBoundary()),s(2),ue("Get random int between ",i.lowerBoundary()," and ",i.upperBoundary()))},styles:["[_nghost-%COMP%]{display:flex;flex-direction:row;align-items:center;gap:var(--size-2)}.min-max[_nghost-%COMP%]{flex-direction:column;align-items:flex-start;gap:var(--size-1)}.min-max[_nghost-%COMP%]   [_ngcontent-%COMP%]:not(:first-child){margin-inline-start:var(--size-4)}.min-max[_nghost-%COMP%]   label[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;gap:var(--size-2)}label[_ngcontent-%COMP%]{display:none}"]})}}return t})();var $e=["tagsInput"],Qe=["tags",""];function Ze(t,a){if(t&1&&(l(0,"span",1),r(1),o()),t&2){let e=I();s(),Z(" (max ",e.maxLength()," tags)")}}function Xe(t,a){if(t&1){let e=D();l(0,"label",4)(1,"button",5),_("click",function(){let i=M(e).$index,m=I();return S(m.delTag(i))}),r(2,"\u{1F5D1}\uFE0F"),o(),d(3,"input",6),c(),o()}if(t&2){let e=a.$implicit,n=I();s(),b("disabled",n.isLastOne()),s(2),p(e,"formField")}}var Te=(()=>{class t{constructor(){this.tags=T.required(),this.tagsInput=X("tagsInput",{read:k}),this.tagsList=y(()=>this.tags()()),this.isLastOne=y(()=>this.tagsList().value().length===1),this.maxLength=y(()=>{let e=(this.tagsList().errors()||[]).find(n=>n instanceof Me);return e===void 0?null:e.maxLength}),this._=Y(()=>{let e=this.tagsList().errors()||[],n=this.tagsInput().nativeElement;e.length>0?n.setCustomValidity("error in tags"):n.setCustomValidity("")})}addTag(){this.tagsList().value.update(e=>["",...e])}delTag(e){let n=this.tagsList().value;n().length>1&&n.update(i=>i.filter((m,v)=>v!==e))}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275cmp=C({type:t,selectors:[["fieldset","tags",""]],viewQuery:function(n,i){n&1&&$(i.tagsInput,$e,5,k),n&2&&Q()},inputs:{tags:[1,"tags"]},attrs:Qe,decls:9,vars:1,consts:[["tagsInput",""],[1,"error"],["type","button",1,"action",3,"click"],["type","text","name","tags",2,"display","none"],[1,"tags"],["type","button",1,"action",3,"click","disabled"],["type","text","showError","",3,"formField"]],template:function(n,i){if(n&1){let m=D();l(0,"legend"),r(1," Tags "),se(2,Ze,2,1,"span",1),l(3,"button",2),_("click",function(){return M(m),S(i.addTag())}),r(4,"+"),o()(),d(5,"input",3,0),L(7,Xe,4,3,"label",4,j)}n&2&&(s(2),le(i.maxLength()!==null?2:-1),s(5),O(i.tags()))},dependencies:[E,P],styles:["[_nghost-%COMP%]{display:block}label.tags[_ngcontent-%COMP%]{display:grid;grid-template-columns:48px auto;gap:var(--size-3);grid-row-gap:var(--size-1);align-items:baseline}.error[_ngcontent-%COMP%]{color:var(--red-5);font-variant:small-caps;font-size:.9rem;margin-inline-start:var(--size-2)}label.tags[_ngcontent-%COMP%] > button.action[_ngcontent-%COMP%]{position:inherit;margin-inline-start:0}"]})}}return t})();var ke=async t=>{console.log("submit with error"),await new Promise(e=>setTimeout(e,3e3));let a=t().value();if(he(a)){let e=Object.keys(ve(a)),n=e[Math.ceil(Math.random()*e.length)].split(".");try{let i=n.reduce((m,v)=>m[v]??m,t);return console.log("random field with error",n.join(".")),{kind:"randomError",message:"This is a random server-side error for testing purposes",field:i}}catch{return null}}};var ze=(()=>{class t{constructor(){this.getById=e=>V({source:e,computation:n=>{let i=U.get(n);return i?structuredClone(i):Ye(n)}}),this.getAll=()=>structuredClone(Array.from(U.values())),this.save=async e=>{await new Promise(n=>setTimeout(n,500)),U.set(e.id,e)}}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275prov=ae({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})(),U=new Map;U.set("1",{id:"1",name:"Sander",dob:new Date(1980,1,1),password:"007 Is not secure",confirm:"007 Is not secure",favoriteRandomInt:42,contacts:[{type:h.Email,info:"a@b.c",priority:0},{type:h.Mobile,info:"+31 6123 456 789",priority:0}],tags:["developer","angular","aa","aaa","aaaa"],address:{street:"123 Main St",city:"Anytown",state:"CA",zip:"12345"}});var Ye=t=>({id:t,name:"",dob:new Date("2000"),password:"",confirm:"",tags:[],favoriteRandomInt:0,address:{street:"",city:"",state:"",zip:""},contacts:[]});var Pe=g(t=>{u(t,({value:a})=>{let e=a();return/^[^@\s]+@[^@\s]+\.[^@\s]+$/.test(e)?null:x(/^[^@\s]+@[^@\s]+\.[^@\s]+$/,{message:"Invalid email address"})}),Fe(t,{params:({value:a,state:e})=>e.dirty()?a():void 0,factory:a=>ge({params:a,loader:async({params:e})=>{let n=e;if(Math.random()<.5)throw new Error("Simulated server connection error");return await new Promise(m=>setTimeout(m,2500)),["i@exists.gov","j@exists.gov"].includes(n)}}),onError:a=>({kind:"serverConnectionError",message:`Could not validate email address at this time
Please try again later.`}),onSuccess:a=>a?{kind:"serverError",message:"Email address already exists"}:null})});var ee=g(t=>{u(t,({value:a})=>{let e=[],n=a(),i=n.split("").filter(m=>"0123456789".includes(m)).length;return/^\+?[0-9\s\-()]{7,}$/.test(n)||e.push(x(/^\+?[0-9\s\-()]{7,}$/,{message:"only numbers and ()+- are allowed"})),i<7&&e.push(J(7,{message:"At least 7 digits are required"})),i>15&&e.push(H(15,{message:"Maximum 15 digits allowed"})),e.length>0?e:null})});var Le=g(t=>{z(t,1,{message:"At least one contact is required"}),G(t,Ge)}),Ge=g(t=>{let a=Object.values(h);f(t.info,{message:"a value is required"}),u(t.type,({value:e})=>{let n=e();return a.includes(n)===!1?{kind:"invalidType",message:"Invalid contact type"}:null}),R(t,e=>e.type===h.Email,e=>w(e.info,Pe)),R(t,e=>e.type===h.Fax,e=>w(e.info,ee)),R(t,e=>e.type===h.Mobile,e=>w(e.info,ee)),R(t,e=>e.type===h.Phone,e=>w(e.info,ee))});var Oe=g(t=>{f(t,{message:"can not be empty"}),z(t,6,{message:"must be at least 6 characters"}),u(t,({value:a})=>{let e=a(),n=[];return/[A-Z]/.test(e)||n.push({kind:"complexity",message:"must contain an uppercase letter"}),/[a-z]/.test(e)||n.push(re("must contain a lowercase letter")),/[0-9]/.test(e)||n.push(re("must contain a number")),/[^A-Za-z0-9]/.test(e)||n.push(re("must contain a special character")),n.length>0?n:null})}),re=t=>({kind:"complexity",message:t});var Ne=g(t=>{Se(t,7,{message:"Maximum 7 tags allowed"});let a=g(e=>{f(e,{message:"Tag can not be empty"}),z(e,2,{message:"Tag must be at least 2 characters"}),u(e,({value:n,state:i,valueOf:m})=>{let v=n(),te=parseInt(""+i.keyInParent(),10),Ve=m(t).map((ne,ie)=>[ne,ie]);for(let[ne,ie]of Ve)if(ie!==te&&ne===v)return x(/.*/,{message:"Duplicate tags are not allowed"})}),u(e,({value:n})=>{if(n().toLowerCase().includes("react"))return x(/.*/,{message:"no, just, no!"})})});G(t,a)});var Be=g(t=>{f(t.name,{message:"a name is required"}),u(t.name,({value:a})=>{let e=a();return e&&e.length<3?J(3,{message:"Name must be at least 3 characters"}):e&&!/^[A-Za-z\s]+$/.test(e)?x(/^[A-Za-z\s]+$/,{message:"Name must contain only letters and spaces"}):null}),f(t.dob),u(t.dob,({value:a})=>{let e=a();return e&&new Date(e).getTime()>Date.now()?H(Date.now(),{message:"Date of birth cannot be in the future"}):null}),u(t.dob,({value:a})=>{let e=a();return e&&new Date(e).getFullYear()<1900?Ee(1900,{message:"Year must be 1900 or later"}):null}),w(t.password,Oe),f(t.confirm),u(t.confirm,({value:a,valueOf:e})=>{let n=a(),i=e(t.password);return n!==i?{kind:"mismatch",message:"Passwords do not match"}:null}),f(t.address.street),f(t.address.city),f(t.address.state),w(t.tags,Ne),w(t.contacts,Le)});var He=["dlg"],Wt=(()=>{class t{constructor(){this.dataService=A(ze),this.id=q("1"),this.relation=this.dataService.getById(this.id),this.fd=Ce(this.relation,Be),this.dlg=X("dlg",{read:k}),this._=Y(()=>{let e=this.dlg()?.nativeElement;this.fd().submitting()?e.showModal():e.close()})}async onSubmit(e){if(e.preventDefault(),this.fd().valid())if(Math.random()<.6){let n=await _e(this.fd,ke);console.log("submit result",n)}else console.log("submit without error",JSON.stringify(this.fd().value(),void 0,2))}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275cmp=C({type:t,selectors:[["ng-component"]],viewQuery:function(n,i){n&1&&$(i.dlg,He,5,k),n&2&&Q()},decls:53,vars:21,consts:[["dlg",""],["href","/signalForms/tree"],[3,"submit"],[1,"wrapper"],["for","name"],["id","name","type","text","placeholder","Your name","showError","","autocomplete","name",3,"formField"],["for","dob"],["id","dob","type","date","showError","","autocomplete","bday",3,"formField"],["for","password"],["id","password","type","password","placeholder","Password","showError","","autocomplete","new-password",3,"formField"],["for","confirm"],["id","confirm","type","password","placeholder","Confirm Password","showError","","autocomplete","new-password",3,"formField"],[3,"formField"],[3,"contacts"],["for","street"],["id","street","type","text","placeholder","Street","showError","","autocomplete","street-address",3,"formField"],["for","city"],["id","city","type","text","placeholder","City","showError","","autocomplete","address-level2",3,"formField"],["for","zip"],["id","zip","type","text","placeholder","Zip","showError","","autocomplete","postal-code",3,"formField"],["for","state"],["id","state","type","text","placeholder","State","showError","","autocomplete","address-level1",3,"formField"],[3,"tags"],["type","submit",3,"disabled"]],template:function(n,i){if(n&1){let m=D();l(0,"h1"),r(1," Signal Forms Experiment "),l(2,"small")(3,"a",1),r(4,"recusive form"),o()()(),l(5,"form",2),_("submit",function(te){return M(m),S(i.onSubmit(te))}),l(6,"div",3)(7,"label",4)(8,"span"),r(9,"Name"),o(),d(10,"input",5),c(),o(),l(11,"label",6)(12,"span"),r(13,"Date of Birth"),o(),d(14,"input",7),c(),o(),l(15,"label",8)(16,"span"),r(17,"Password"),o(),d(18,"input",9),c(),o(),l(19,"label",10)(20,"span"),r(21,"Confirm Password"),o(),d(22,"input",11),c(),o(),l(23,"label")(24,"span"),r(25,"Favorite Random Int"),o(),d(26,"se-input-random-int",12),c(),o()(),d(27,"fieldset",13),l(28,"fieldset")(29,"legend"),r(30,"Address"),o(),l(31,"label",14)(32,"span"),r(33,"Street"),o(),d(34,"input",15),c(),o(),l(35,"label",16)(36,"span"),r(37,"City"),o(),d(38,"input",17),c(),o(),l(39,"label",18)(40,"span"),r(41,"Zip"),o(),d(42,"input",19),c(),o(),l(43,"label",20)(44,"span"),r(45,"State"),o(),d(46,"input",21),c(),o()(),d(47,"fieldset",22),l(48,"button",23),r(49,"Submit"),o()(),l(50,"dialog",null,0),r(52,"Submitting and validating on the server, please hold!"),o()}n&2&&(s(10),p(i.fd.name,"formField"),s(4),p(i.fd.dob,"formField"),s(4),p(i.fd.password,"formField"),s(4),p(i.fd.confirm,"formField"),s(4),p(i.fd.favoriteRandomInt,"formField"),s(),b("contacts",i.fd.contacts),s(7),p(i.fd.address.street,"formField"),s(4),p(i.fd.address.city,"formField"),s(4),p(i.fd.address.zip,"formField"),s(4),p(i.fd.address.state,"formField"),s(),b("tags",i.fd.tags),s(),b("disabled",!i.fd().valid()))},dependencies:[E,Te,De,Ie,P,xe,we,ye,be],styles:[`:host{display:block;margin-top:var(--size-3);max-width:99vw;columns:2}form{--size-content-3: 140ch;width:var(--size-content-3);display:grid;grid-template-columns:1fr 1fr;grid-template-areas:"firstDiv     AddressComponent" "contacts     tagsComponent" "submitButton submitButton";gap:var(--size-4);margin:auto;background-color:var(--surface-2);padding:var(--size-3);border-radius:var(--radius-3)}@media(width<1500px){form{--size-content-3: min(98vw, 70ch);grid-template-areas:"firstDiv" "AddressComponent" "contacts" "tagsComponent" "submitButton";grid-template-columns:1fr}}button[type=submit]{grid-area:e}form fieldset:nth-child(2){grid-area:contacts}form fieldset:nth-child(3){grid-area:AddressComponent}form fieldset:nth-child(4){grid-area:tagsComponent}div.wrapper{grid-area:firstDiv;display:flex;flex-direction:column}label{display:flex;flex-direction:column;gap:var(--size-2)}label>*:nth-child(2){margin-left:var(--size-3)}label:has(input[required])>span:first-child:after{content:"*";color:var(--red-3)}button[type=submit]{grid-area:submitButton}:is(input,textarea,select):user-invalid{border:2px solid var(--red-5)}fieldset>legend{display:flex;align-items:center}fieldset{container-type:inline-size;margin-block-end:0}div.error-messages{display:none}div.error-messages{display:block;color:var(--red-5);grid-column:2;font-style:italic;min-height:1.5em;font-variant:small-caps;margin-inline-start:var(--size-2);margin-block-start:calc(-1 * var(--size-2))}div.error-messages ul{font-size:.95rem}div.error-messages ul:not(:has(:nth-child(2))){list-style:none;padding-inline-start:var(--size-4)}button.action{border-radius:50%;width:var(--size-8);height:var(--size-8);padding:0;font-size:var(--size-3);line-height:1;display:inline-flex;align-items:center;justify-content:center}legend button.action{position:absolute;translate:calc(98cqi - 100%)}dialog{padding:var(--size-6);font-size:var(--size-5);border-radius:var(--radius-3);box-shadow:var(--shadow-4);width:var(--size-content-3)}
`],encapsulation:2,changeDetection:0})}}return t})();export{Wt as SignalFormsExperimentComponent};
