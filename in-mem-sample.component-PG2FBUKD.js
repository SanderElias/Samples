import{a as S}from"./chunk-OZD4UVZE.js";import{$ as y,Lc as v,Nb as f,Ob as b,Pb as h,Ub as a,Vb as o,Ya as l,ea as w,ec as E,ob as g,rc as d,uc as I,va as c}from"./chunk-I3AI3OF7.js";import{a as s,b as p}from"./chunk-DAQOROHW.js";var C=()=>S(),R=n=>n&&typeof n=="object"&&"id"in n&&Array.isArray(n.table),x=n=>{if(R(n))return n;throw new Error("Object is not a DbRecord")};var M=(()=>{class n{#e=c(new Map,{equal:()=>!1});create(e){let t=e.id??C(),r=x(p(s({},e),{id:t}));this.#e.update(i=>i.set(t,c(r)))}read(e){if(!this.#e().has(e))throw new Error(`Record with id ${e} not found`);return this.#e().get(e)?.asReadonly()}update(e){e=x(e);let r=this.#e().get(e.id);if(!r)throw new Error(`Record with id ${e.id} not found`);let i=s(s({},r()),e);r.set(i)}delete(e){let t=this.#e();if(!t.has(e))throw new Error(`Record with id ${e} not found`);t.delete(e)}listTable(e,t="id"){return c(Array.from(this.#e().values()).filter(r=>r().table.includes(e)).sort((r,i)=>r()[t]>i()[t]?1:-1).map(r=>r().id))}findByProp(e,t){let r=this.#e();for(let i of r.values())if(i().table.includes(e)&&t(i()))return i.asReadonly();return c(void 0)}freeTextSearch(e){}createIndex(e,t){return t??=r=>r.id,v(()=>{let r=this.#e();return Array.from(r.values()).filter(m=>m().table.includes(e)).sort((m,D)=>t(m())>t(D())?1:-1).map(m=>m().id)})}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275prov=y({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function _(n,u){if(n&1&&(a(0,"li"),d(1),o()),n&2){let e=u.$implicit,t=E();l(),I("",t.dbs.read(e)().name," (ID: ",e,")")}}function B(n,u){if(n&1&&(a(0,"li"),d(1),o()),n&2){let e=u.$implicit,t=E();l(),I("",t.dbs.read(e)().name," (ID: ",e,")")}}var G=(()=>{class n{constructor(){this.dbs=w(M),this.users=this.dbs.createIndex("users",e=>e.name),this.admins=this.dbs.createIndex("admins",e=>e.name),this.dbs.create({table:["users"],name:"Alice",age:30}),this.dbs.create({table:["users","admins"],name:"Bob",age:25}),this.dbs.create({table:["users"],name:"Charlie",age:35}),this.dbs.create({table:["admins"],name:"Dana",age:28}),setTimeout(()=>{this.dbs.create({table:["users","admins"],name:"Eve",age:22})},2e3),setTimeout(()=>{let e=this.dbs.findByProp("users",t=>t.name==="Bob");e()&&this.dbs.update(p(s({},e()),{name:"Robert",age:26}))},4e3)}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275cmp=g({type:n,selectors:[["se-in-mem-sample"]],decls:12,vars:0,template:function(t,r){t&1&&(a(0,"h1"),d(1,"In-Memory DB Sample"),o(),a(2,"h2"),d(3,"Users"),o(),a(4,"ul"),b(5,_,2,2,"li",null,f),o(),a(7,"h2"),d(8,"Admins"),o(),a(9,"ul"),b(10,B,2,2,"li",null,f),o()),t&2&&(l(5),h(r.admins()),l(5),h(r.users()))},styles:["[_nghost-%COMP%]{display:block}"]})}}return n})();export{G as InMemSampleComponent};
