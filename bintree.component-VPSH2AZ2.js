import{d as R}from"./chunk-P4K3TQV7.js";import"./chunk-D4NNR5R6.js";import{Lc as O,Mc as E,Ob as C,Qb as N,Qc as D,Vb as b,Wb as l,Xb as d,Xc as j,Yb as y,Za as u,e as T,hc as v,jc as M,rb as x,wc as p,yc as $}from"./chunk-KIBRB3UE.js";import{a as g,b as m}from"./chunk-C6Q5SG76.js";var S=()=>String.fromCharCode(Math.floor(Math.random()*26)+97),V=()=>Date.now().toString(36)+"-"+S()+S()+S(),c=new Map,k=(e,n,t,i)=>{let r={id:V(),parentId:n,value:e,left:t,right:i};return c.set(r.id,r),r},o=e=>e?c.get(e):void 0;var a=()=>[...c.values()].find(e=>e.parentId===void 0),A=()=>{c.clear()};function w(e,n=a()){if(n===void 0)return e;if(e.value<n.value)return n.left===void 0?(n.left=e.id,e.parentId=n.id,e):w(e,o(n.left));if(e.value>n.value)return n.right===void 0?(n.right=e.id,e.parentId=n.id,e):w(e,o(n.right));e.value===n.value&&(console.warn("thrown away duplicate value"),c.delete(e.id))}function H(){console.table([...c.values()].sort((e,n)=>e.value<n.value?-1:1).map(e=>m(g({},e),{leftVal:o(e.left)?.value,cur:e.value,rightVal:o(e.right)?.value})))}function I(e=a()){let n=o(e.parentId),t=o(e.right);if(t===void 0)return e;t.parentId=n?.id,n!==void 0&&(n.left===e.id?n.left=t.id:n.right=t.id);let i=o(t.left);return t.left=e.id,e.parentId=t.id,i!==void 0?(e.right=i.id,i.parentId=e.id):e.right=void 0,t}var P=()=>[...c.values()].sort((e,n)=>e.value<n.value?-1:1);function B(e=a()){let n=o(e.parentId),t=o(e.left);if(t===void 0)return e;t.parentId=n?.id,n!==void 0&&(n.left===e.id?n.left=t.id:n.right=t.id);let i=o(t.right);return t.right=e.id,e.parentId=t.id,i!==void 0?(e.left=i.id,i.parentId=e.id):e.left=void 0,t}function s(e){if(e===void 0)return 0;let n=Math.max(s(o(e.left)),s(o(e.right)));return e.height=n+1,e.height}function h(e){if(e===void 0)return 0;let n=t=>o(t)?.height||0;return e.balance=n(e.left)-n(e.right),e.balance}function F(){let e=100;for(_();;){let n=[...c.values()].find(t=>Math.abs(h(t))>1);if(console.log(c.size,n?.value,h(n)),n===void 0||!--e)break;_(n)}}function _(e=a()){if(e===void 0)return;let n=h(e);if(n<-1){let i=o(e.right);i&&h(i)>0&&B(i);let r=I(e);return s(a()),_(r)}if(n>1){let i=o(e.left);i&&(i.balance??0)<0&&I(i);let r=B(e);return s(a()),_(r)}let t=i=>{let r=h(i);Math.abs(i?.balance)>1&&_(i)};t(o(e.left)),t(o(e.right))}function q(e,n){if(e&1&&(l(0,"span",0),p(1),d()),e&2){let t=M(),i=M();b("title",i.title(t)),u(),$(" ",(t==null?null:t.value)??"-"," ")}}function G(e,n){if(e&1&&(l(0,"div",1),y(1,"b-node",2)(2,"b-node",3),d()),e&2){let t=M(2);u(),b("bNode",t.$left()),u(),b("bNode",t.$right())}}function J(e,n){if(e&1&&(l(0,"div"),C(1,q,2,2,"span",0),d(),C(2,G,3,2,"div",1)),e&2){let t=n;u(),N((t==null?null:t.value)??void 0?1:-1),u(),N(t!=null&&t.left||t!=null&&t.right?2:-1)}}var L=(()=>{class e{constructor(){this.bNode=j(void 0),this.$left=D(()=>{let t=o(this.bNode()?.left);return t&&m(g({},t),{time:Date.now()})}),this.$right=D(()=>{let t=o(this.bNode()?.right);return t&&m(g({},t),{time:Date.now()})}),this.height=s,this.balance=h}title(t){return`Height: ${t.height} balance: ${h(t)}`}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275cmp=x({type:e,selectors:[["b-node"]],inputs:{bNode:[1,"bNode"]},decls:1,vars:1,consts:[[3,"title"],[1,"row"],[1,"left",3,"bNode"],[1,"right",3,"bNode"]],template:function(i,r){if(i&1&&C(0,J,3,2),i&2){let f;N((f=r.bNode())?0:-1,f)}},dependencies:[e],styles:["[_nghost-%COMP%]{display:grid;width:fit-content;grid-template-columns:1fr;grid-template-rows:20px 1fr;justify-content:center;align-content:center;gap:2px;margin:4px;padding:2px;border:1px solid rgba(255,255,255,.774)}div[_ngcontent-%COMP%]{text-align:center}div.row[_ngcontent-%COMP%]{display:flex;justify-content:center;align-content:center}div[_ngcontent-%COMP%]:first-child{padding:9px;border-radius:50%;align-self:center;justify-self:center;background-color:#5d0e5d}.left[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{background-color:#00f}.right[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{background-color:green}"],changeDetection:0})}}return e})();var de=(()=>{class e{constructor(){this.count=31,this.root$=new T,this.nodes=P(),this.dump=()=>{H(),this.refresh()},this.deb=null}ngOnInit(){this.reset()}async reset(){A();let[t,...i]=await U(),r=k(t);i.forEach(f=>w(k(f),r)),s(r),setTimeout(()=>this.root$.next(r),20),this.nodes=P()}refresh(){this.deb&&clearTimeout(this.deb),this.deb=setTimeout(()=>{this.root$.next(m(g({},a()),{time:Date.now()}))},0),s(a())}rl(t=a()){I(t),this.refresh()}rr(t=a()){B(t),this.refresh()}rb(t=a()){F(),this.refresh()}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275cmp=x({type:e,selectors:[["app-bintree"]],decls:13,vars:3,consts:[[1,"button-bar"],[3,"click"],[3,"bNode"]],template:function(i,r){i&1&&(l(0,"h1"),p(1,"Binary tree"),d(),l(2,"div",0)(3,"button",1),v("click",function(){return r.rl()}),p(4,"rl"),d(),l(5,"button",1),v("click",function(){return r.rr()}),p(6,"rr"),d(),l(7,"button",1),v("click",function(){return r.rb()}),p(8,"rb"),d(),l(9,"button",1),v("click",function(){return r.dump()}),p(10,"dump"),d()(),y(11,"b-node",2),O(12,"async")),i&2&&(u(11),b("bNode",E(12,1,r.root$)))},dependencies:[L,R],styles:[".button-bar[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(5,1fr);max-width:100vw}.row[_ngcontent-%COMP%]{margin-top:1rem;display:grid;grid-template-columns:repeat(10,1fr)}"],changeDetection:0})}}return e})(),K=(e=2e3)=>Math.floor(Math.random()*e),Q=e=>[...new Set(Array.from({length:e},()=>K()))];async function U(){let e;return e||(e=Q(100)),e}export{de as BintreeComponent};
