"use strict";(self.webpackChunksamples=self.webpackChunksamples||[]).push([[592],{6495:(L,m,e)=>{e.d(m,{U2:()=>h,t8:()=>i});function _(r){return new Promise((t,n)=>{r.oncomplete=r.onsuccess=()=>t(r.result),r.onabort=r.onerror=()=>n(r.error)})}let d;function s(){return d||(d=function l(r,t){const n=function c(){if(navigator.userAgentData||!/Safari\//.test(navigator.userAgent)||/Chrom(e|ium)\//.test(navigator.userAgent)||!indexedDB.databases)return Promise.resolve();let t;return new Promise(n=>{const u=()=>indexedDB.databases().finally(n);t=setInterval(u,100),u()}).finally(()=>clearInterval(t))}().then(()=>{const u=indexedDB.open(r);return u.onupgradeneeded=()=>u.result.createObjectStore(t),_(u)});return(u,A)=>n.then(I=>A(I.transaction(t,u).objectStore(t)))}("keyval-store","keyval")),d}function h(r,t=s()){return t("readonly",n=>_(n.get(r)))}function i(r,t,n=s()){return n("readwrite",u=>(u.put(t,r),_(u.transaction)))}},4581:(L,m,e)=>{e.d(m,{R:()=>f});var c=e(5955),E=e(818),_=e(5619),l=e(6602),d=e(5975),s=e(2692);const h=["addListener","removeListener"],i=["addEventListener","removeEventListener"],o=["on","off"];function f(v,g,p,r){if((0,d.m)(p)&&(r=p,p=void 0),r)return f(v,g,p).pipe((0,s.Z)(r));const[t,n]=function U(v){return(0,d.m)(v.addEventListener)&&(0,d.m)(v.removeEventListener)}(v)?i.map(u=>A=>v[u](g,A,p)):function P(v){return(0,d.m)(v.addListener)&&(0,d.m)(v.removeListener)}(v)?h.map(O(v,g)):function y(v){return(0,d.m)(v.on)&&(0,d.m)(v.off)}(v)?o.map(O(v,g)):[];if(!t&&(0,l.z)(v))return(0,_.z)(u=>f(u,g,p))((0,c.Xf)(v));if(!t)throw new TypeError("Invalid event target");return new E.y(u=>{const A=(...I)=>u.next(1<I.length?I:I[0]);return t(A),()=>n(A)})}function O(v,g){return p=>r=>v[p](g,r)}},5490:(L,m,e)=>{e.d(m,{F:()=>_});var c=e(2844),E=e(1995);function _(l=0,d=c.z){return l<0&&(l=0),(0,E.H)(l,l,d)}},1995:(L,m,e)=>{e.d(m,{H:()=>d});var c=e(818),E=e(2844),_=e(1830);function d(s=0,h,i=E.P){let o=-1;return null!=h&&((0,_.K)(h)?i=h:o=h),new c.y(f=>{let O=function l(s){return s instanceof Date&&!isNaN(s)}(s)?+s-i.now():s;O<0&&(O=0);let P=0;return i.schedule(function(){f.closed||(f.next(P++),0<=o?this.schedule(void 0,o):f.complete())},O)})}},8982:(L,m,e)=>{e.d(m,{g:()=>y});var c=e(2844),E=e(6811),_=e(5598),l=e(2085),d=e(8499),s=e(408),i=e(7969),f=e(5619);function O(U,v){return v?g=>(0,E.z)(v.pipe((0,_.q)(1),function h(){return(0,l.e)((U,v)=>{U.subscribe((0,d.x)(v,s.Z))})}()),g.pipe(O(U))):(0,f.z)((g,p)=>U(g,p).pipe((0,_.q)(1),function o(U){return(0,i.U)(()=>U)}(g)))}var P=e(1995);function y(U,v=c.z){const g=(0,P.H)(U,v);return O(()=>g)}},2147:(L,m,e)=>{e.d(m,{x:()=>l});var c=e(8330),E=e(2085),_=e(8499);function l(s,h=c.y){return s=null!=s?s:d,(0,E.e)((i,o)=>{let f,O=!0;i.subscribe((0,_.x)(o,P=>{const y=h(P);(O||!s(f,y))&&(O=!1,f=y,o.next(P))}))})}function d(s,h){return s===h}},1233:(L,m,e)=>{e.d(m,{j:()=>_});var c=e(2085),E=e(2728);function _(l,d=1/0,s){return d=(d||0)<1?1/0:d,(0,c.e)((h,i)=>(0,E.p)(h,i,l,d,void 0,!0,s))}},6252:(L,m,e)=>{e.d(m,{u:()=>_});var c=e(2049),E=e(2085);function _(l,d){return(0,E.e)((0,c.U)(l,d,arguments.length>=2,!1,!0))}},2474:(L,m,e)=>{e.d(m,{q:()=>l});var c=e(6252),E=e(2085);const _=(d,s)=>(d.push(s),d);function l(){return(0,E.e)((d,s)=>{(0,c.u)(_,[])(d).subscribe(s)})}},97:(L,m,e)=>{e.d(m,{b:()=>_});var c=e(818),E=e(5975);function _(l){return!!l&&(l instanceof c.y||(0,E.m)(l.lift)&&(0,E.m)(l.subscribe))}},1578:(L,m,e)=>{e.d(m,{m:()=>l});var c=e(5598),E=e(7969),_=e(8168);function l(d){return function s(h,i){return d.pipe((0,c.q)(1),(0,E.U)(o=>{if("string"==typeof h)return Object.assign(Object.assign({},o),{[h]:i});if("object"==typeof h)return Object.assign(Object.assign({},o),h);throw new Error("Property needs to be a string or an object")}),(0,_.b)(o=>d.next(o))).toPromise()}}},4841:(L,m,e)=>{e.d(m,{H:()=>U});var c=e(4553),E=e(8023),_=e(1995),l=e(5619),d=e(1927),s=e(6466),h=e(7969),i=e(9676),o=e(5598),f=e(8168),O=e(9724);const P=e.e(935).then(e.t.bind(e,5935,23)).then(p=>new p.Chance);let U=(()=>{class p{constructor(){this.flush$=new E.x,this.updatedUsers$=new E.x,this.allUsers$=this.flush$.pipe((0,l.z)(()=>this.updatedUsers$),(0,d.O)([]),(0,s.d)({bufferSize:1,refCount:!1})),this.admins$=this.allUsers$.pipe((0,h.U)(t=>t.filter(n=>n.isAdmin))),this.users$=this.allUsers$.pipe((0,h.U)(t=>t.filter(n=>!n.isAdmin))),this.flushCache()}addUsers(t){var n=this;return(0,c.Z)(function*(){const u=yield n.allUsers$.pipe((0,i.P)()).toPromise(),A=u.length,I=yield Promise.all(Array.from({length:t}).map(function(){var R=(0,c.Z)(function*(T,j){return Object.assign({id:A+j},yield function v(){return g.apply(this,arguments)}())});return function(T,j){return R.apply(this,arguments)}}()));n.updatedUsers$.next(u.concat(I))})()}saveUser(t){var n=this;return(0,c.Z)(function*(){const u=yield n.allUsers$.pipe((0,o.q)(1)).toPromise(),A=u.findIndex(I=>I.id===t.id);if(A>-1)Object.assign(u[A],t);else{let I;for(;!I||u.findIndex(R=>R.id===I)>-1;)I=Math.floor(Math.random()*Number.MAX_SAFE_INTEGER);u.unshift(Object.assign(Object.assign({},t),{id:I}))}n.updatedUsers$.next(u)})()}deleteUser(t){var n=this;return(0,c.Z)(function*(){const u=(yield n.allUsers$.pipe((0,i.P)()).toPromise()).filter(A=>A.id!==t.id);n.updatedUsers$.next(u)})()}flushCache(){var t=this;return(0,c.Z)(function*(){const n=yield P;yield new Promise(u=>setTimeout(u)),t.flush$.next(),(0,_.H)(0,250).pipe((0,f.b)(()=>t.addUsers(n.integer({min:100,max:400}))),(0,o.q)(20)).subscribe()})()}}return p.\u0275fac=function(t){return new(t||p)},p.\u0275prov=O.Yz7({token:p,factory:p.\u0275fac,providedIn:"root"}),p})();function g(){return(g=(0,c.Z)(function*(){const p=yield P;return{userState:p.integer({min:0,max:3}),username:p.name(),isAdmin:p.bool(),isActive:p.bool(),email:p.email()}})).apply(this,arguments)}},4395:(L,m,e)=>{e.d(m,{g:()=>l,f:()=>d});var c=e(9724),E=e(97),_=e(8168);let l=(()=>{class s{constructor(i,o,f){this.templateRef=i,this.viewContainer=o,this.cdr=f,this.context={$implicit:void 0,seLet:void 0},this.assign=this.assign.bind(this)}set seLet(i){this.assign(i)}set seLetObserve(i){this.assign(i)}set seLetOn(i){this.assign(i)}assign(i){this.sub&&this.sub.unsubscribe(),(0,E.b)(i)?this.sub=i.pipe((0,_.b)(()=>this.cdr.markForCheck())).subscribe(o=>{this.context.$implicit=o,this.context.seLet=o}):(this.context.$implicit=i,this.context.seLet=i)}ngOnInit(){this.viewContainer.createEmbeddedView(this.templateRef,this.context)}ngOnDestroy(){this.sub&&this.sub.unsubscribe()}}return s.\u0275fac=function(i){return new(i||s)(c.Y36(c.Rgc),c.Y36(c.s_b),c.Y36(c.sBO))},s.\u0275dir=c.lG2({type:s,selectors:[["","seLet",""]],inputs:{seLet:"seLet",seLetObserve:"seLetObserve",seLetOn:"seLetOn"}}),s})(),d=(()=>{class s{}return s.\u0275fac=function(i){return new(i||s)},s.\u0275mod=c.oAB({type:s}),s.\u0275inj=c.cJS({}),s})()},2702:(L,m,e)=>{e.d(m,{cb:()=>O,C3:()=>P,$b:()=>f,m9:()=>p});var c=e(8023);const E=Symbol("_acc"),_=Symbol("_aci"),i=(Symbol("_avc"),Symbol("_avi"),Symbol("_dc"),Symbol("_oc"),Symbol("_oi")),o=Symbol("_od"),f=(r=class{})=>{var t,n;return n=class extends r{constructor(){super(...arguments),this[t]=new c.x,this.seOnDestroy$=this[o].asObservable()}ngOnDestroy(){super.ngOnDestroy&&super.ngOnDestroy(),this[o].next(),this[o].complete()}},t=o,n},O=(r=class{})=>{var t,n;return n=class extends r{constructor(){super(...arguments),this[t]=new c.x,this.seAfterContentChecked$=this[E].asObservable()}ngAfterContentChecked(){this[E].next(),super.ngAfterContentChecked&&super.ngAfterContentChecked()}ngOnDestroy(){this[E].complete(),super.ngOnDestroy&&super.ngOnDestroy()}},t=E,n},P=(r=class{})=>{var t,n;return n=class extends r{constructor(){super(...arguments),this[t]=new c.x,this.seAfterContentInit$=this[_].asObservable()}ngAfterContentInit(){Promise.resolve().then(()=>{this[_].next(),this[_].complete()}),super.ngAfterContentInit&&super.ngAfterContentInit()}},t=_,n},p=(r=class{})=>{var t,n;return n=class extends r{constructor(){super(...arguments),this[t]=new c.x,this.seOnInit$=this[i].asObservable()}ngOnInit(){Promise.resolve().then(()=>{this[i].next(),this[i].complete()}),super.ngOnInit&&super.ngOnInit()}},t=i,n}},9959:(L,m,e)=>{e.d(m,{Hv:()=>h});var c=e(7969),E=e(97),_=e(4945),l=e(5696);function h(i){const o=Object.values(i).map(f=>(0,E.b)(f)?f:(0,_.of)(f));return(0,l.a)(o).pipe((0,c.U)(f=>Object.keys(i).reduce((O,P,y)=>(O[P]=f[y],O),{})))}},9226:(L,m,e)=>{e.d(m,{qj:()=>K,se:()=>R,ss:()=>T,TK:()=>j,QS:()=>I});var c=e(4762),E=e(6495),_=e(9724),l=e(985),d=e(8168),s=e(6466),h=e(1233),i=e(9018),o=e(7969),f=e(6252),O=e(4970),P=e(5598),y=e(4551),U=e(5619),v=e(6811),g=e(2474),p=e(8831),r=e(4945),t=e(3568),n=e(1528);let u;const A="sample-cache";function I(){return(0,c.mG)(this,void 0,void 0,function*(){if(u)return u;const C=yield(0,E.U2)(A);return u=C?new Map([...C]):new Map,u})}function R(C,b){u.set(C,b),(0,E.t8)(A,u)}function T(C){return u.has(C)}function j(C){return u.get(C)}let K=(()=>{class C{constructor(){this.baseUrl="https://swapi.dev/api/",this.load=a=>(0,c.mG)(this,void 0,void 0,function*(){if(a=B(a),yield I(),!T(a)){const D=yield fetch(a).then(M=>M.json()).catch(M=>{});yield R(a,D)}return j(a)}),this.swapiRoot$=(0,l.D)(this.load(this.baseUrl)).pipe((0,d.b)(a=>this.swapiRoot=a),(0,s.d)(1)),this.swPeople$=(0,l.D)(this.load(`${this.baseUrl}people/`)).pipe((0,h.j)(a=>a.next?this.load(a.next):i.E),(0,o.U)(a=>a.results),(0,f.u)((a,D)=>a.concat(D),[]),(0,o.U)(a=>a.map(D=>Object.assign(Object.assign({},D),{date:W(),id:D.url}))),(0,s.d)(1)),this.findById=a=>this.swPeople$.pipe((0,o.U)(D=>D[a]),(0,O.h)(Boolean),(0,P.q)(1)),this.swFilms$=(0,l.D)(this.load(`${this.baseUrl}films/`)).pipe((0,s.d)(1)),this.findFilmByUrl=a=>this.get(a),this.getRandomPerson=(a=1)=>(0,l.D)(Array.from({length:a})).pipe((0,y.b)(()=>this.swPeople$.pipe((0,o.U)(D=>D[Math.floor(Math.random()*D.length)]),(0,U.z)(D=>(0,v.z)(...D.films.map(M=>this.findFilmByUrl(M))).pipe((0,g.q)(),(0,o.U)(M=>Object.assign(Object.assign({},D),{films:M}))))))),this.findIn=(a,D)=>this.getAllRows(a).pipe((0,o.U)(M=>M.find(x=>(x.name||x.title||"").toLowerCase().includes(D.toLowerCase().trim())))),this.findWithName=a=>this.findIn("people",a),this.loadData().subscribe()}getAllPagedData(a){return(0,l.D)(this.load(`${a}`)).pipe((0,h.j)(D=>D.next?this.load(D.next):i.E))}get(a){const D=Object.values(this.swapiRoot).find(M=>a.toLowerCase().includes(M.toLowerCase()));return D?this.getAllPagedData(D).pipe((0,f.u)((M,x)=>M.concat(x.results),[]),(0,o.U)(M=>M.find(x=>x.url===a))):(0,l.D)(this.load(a))}loadData(){return this.swapiRoot$.pipe((0,d.b)(a=>this.swapiRoot=a),(0,y.b)(a=>Object.values(a).map(D=>this.getAllPagedData(D))),(0,p.u)(),(0,g.q)(),(0,s.d)(1))}enrich(a){const D=M=>{const x=a[M];return Array.isArray(x)&&x.length>0?(0,l.D)(a[M]).pipe((0,y.b)(S=>this.get(S)),(0,g.q)(),(0,o.U)(S=>({[M]:S}))):"string"==typeof x?(this.detectSet(x)?this.get(x):(0,r.of)(x)).pipe((0,o.U)(w=>({[M]:w}))):(0,r.of)(x).pipe((0,o.U)(S=>({[M]:S})))};return this.swapiRoot$.pipe((0,y.b)(M=>Object.keys(a).map(D)),(0,p.u)(),(0,f.u)((M,x)=>Object.assign(Object.assign({},M),x),{}),(0,t.K)(M=>(console.warn(M),(0,r.of)({}))))}getAllRows(a){return this.swapiRoot$.pipe((0,n.w)(()=>this.getAllPagedData(B(this.swapiRoot[a]))),(0,o.U)(D=>D.results),(0,f.u)((D,M)=>D.concat(M),[]),(0,s.d)(1))}detectSet(a){if("string"==typeof a){const D=Object.entries(this.swapiRoot).find(([M,x])=>a.includes(x));return D&&D[0]}}}return C.\u0275fac=function(a){return new(a||C)},C.\u0275prov=_.Yz7({token:C,factory:C.\u0275fac,providedIn:"root"}),C})();function W(){const C=Math.ceil(1e3*Math.random())+1e3,b=Math.floor(12*Math.random()),a=Math.ceil(27*Math.random());return new Date(C,b,a,12,0)}function B(C){return C.split("http:").join("https:")}},4553:(L,m,e)=>{function c(_,l,d,s,h,i,o){try{var f=_[i](o),O=f.value}catch(P){return void d(P)}f.done?l(O):Promise.resolve(O).then(s,h)}function E(_){return function(){var l=this,d=arguments;return new Promise(function(s,h){var i=_.apply(l,d);function o(O){c(i,s,h,o,f,"next",O)}function f(O){c(i,s,h,o,f,"throw",O)}o(void 0)})}}e.d(m,{Z:()=>E})}}]);