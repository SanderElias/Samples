import{d as P}from"./chunk-ICP2NWOK.js";import"./chunk-XZV7KFRX.js";import"./chunk-CWZZ5FLC.js";import"./chunk-FPPZ4BUR.js";import{$a as y,B as w,Ba as _,Rb as l,Sa as x,Sb as p,Tb as O,Wa as f,X as F,Ya as j,Yb as E,Za as V,ac as b,c as C,fa as u,h as M,ib as g,oc as m,pa as h,pc as z,rb as Z,tb as k,va as T,yb as L}from"./chunk-YDUWCTK6.js";import"./chunk-DAQOROHW.js";var q={schedule(n,t){let e=setTimeout(n,t);return()=>clearTimeout(e)}};function W(n){return n.replace(/[A-Z]/g,t=>`-${t.toLowerCase()}`)}function Y(n){return!!n&&n.nodeType===Node.ELEMENT_NODE}var v;function B(n,t){if(!v){let e=Element.prototype;v=e.matches||e.matchesSelector||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector||e.webkitMatchesSelector}return n.nodeType===Node.ELEMENT_NODE?v.call(n,t):!1}function U(n){let t={};return n.forEach(({propName:e,templateName:i,transform:s})=>{t[W(i)]=[e,s]}),t}function $(n,t){return t.get(y).resolveComponentFactory(n).inputs}function G(n,t){let e=n.childNodes,i=t.map(()=>[]),s=-1;t.some((r,a)=>r==="*"?(s=a,!0):!1);for(let r=0,a=e.length;r<a;++r){let o=e[r],c=J(o,t,s);c!==-1&&i[c].push(o)}return i}function J(n,t,e){let i=e;return Y(n)&&t.some((s,r)=>s!=="*"&&B(n,s)?(i=r,!0):!1),i}var K=10,S=class{componentFactory;inputMap=new Map;constructor(t,e){this.componentFactory=e.get(y).resolveComponentFactory(t);for(let i of this.componentFactory.inputs)this.inputMap.set(i.propName,i.templateName)}create(t){return new I(this.componentFactory,t,this.inputMap)}},I=class{componentFactory;injector;inputMap;eventEmitters=new M(1);events=this.eventEmitters.pipe(F(t=>w(...t)));componentRef=null;scheduledDestroyFn=null;initialInputValues=new Map;ngZone;elementZone;appRef;cdScheduler;constructor(t,e,i){this.componentFactory=t,this.injector=e,this.inputMap=i,this.ngZone=this.injector.get(Z),this.appRef=this.injector.get(L),this.cdScheduler=e.get(T),this.elementZone=typeof Zone>"u"?null:this.ngZone.run(()=>Zone.current)}connect(t){this.runInZone(()=>{if(this.scheduledDestroyFn!==null){this.scheduledDestroyFn(),this.scheduledDestroyFn=null;return}this.componentRef===null&&this.initializeComponent(t)})}disconnect(){this.runInZone(()=>{this.componentRef===null||this.scheduledDestroyFn!==null||(this.scheduledDestroyFn=q.schedule(()=>{this.componentRef!==null&&(this.componentRef.destroy(),this.componentRef=null)},K))})}getInputValue(t){return this.runInZone(()=>this.componentRef===null?this.initialInputValues.get(t):this.componentRef.instance[t])}setInputValue(t,e){if(this.componentRef===null){this.initialInputValues.set(t,e);return}this.runInZone(()=>{this.componentRef.setInput(this.inputMap.get(t)??t,e),j(this.componentRef.hostView)&&(V(this.componentRef.changeDetectorRef),this.cdScheduler.notify(6))})}initializeComponent(t){let e=h.create({providers:[],parent:this.injector}),i=G(t,this.componentFactory.ngContentSelectors);this.componentRef=this.componentFactory.create(e,i,t),this.initializeInputs(),this.initializeOutputs(this.componentRef),this.appRef.attachView(this.componentRef.hostView),this.componentRef.hostView.detectChanges()}initializeInputs(){for(let[t,e]of this.initialInputValues)this.setInputValue(t,e);this.initialInputValues.clear()}initializeOutputs(t){let e=this.componentFactory.outputs.map(({propName:i,templateName:s})=>{let r=t.instance[i];return new C(a=>{let o=r.subscribe(c=>a.next({name:s,value:c}));return()=>o.unsubscribe()})});this.eventEmitters.next(e)}runInZone(t){return this.elementZone&&Zone.current!==this.elementZone?this.ngZone.run(t):t()}},D=class extends HTMLElement{ngElementEventsSubscription=null};function N(n,t){let e=$(n,t.injector),i=t.strategyFactory||new S(n,t.injector),s=U(e);class r extends D{injector;static observedAttributes=Object.keys(s);get ngElementStrategy(){if(!this._ngElementStrategy){let o=this._ngElementStrategy=i.create(this.injector||t.injector);e.forEach(({propName:c,transform:d})=>{if(!this.hasOwnProperty(c))return;let R=this[c];delete this[c],o.setInputValue(c,R,d)})}return this._ngElementStrategy}_ngElementStrategy;constructor(o){super(),this.injector=o}attributeChangedCallback(o,c,d,R){let[H,A]=s[o];this.ngElementStrategy.setInputValue(H,d,A)}connectedCallback(){let o=!1;this.ngElementStrategy.events&&(this.subscribeToEvents(),o=!0),this.ngElementStrategy.connect(this),o||this.subscribeToEvents()}disconnectedCallback(){this._ngElementStrategy&&this._ngElementStrategy.disconnect(),this.ngElementEventsSubscription&&(this.ngElementEventsSubscription.unsubscribe(),this.ngElementEventsSubscription=null)}subscribeToEvents(){this.ngElementEventsSubscription=this.ngElementStrategy.events.subscribe(o=>{let c=new CustomEvent(o.name,{detail:o.value});this.dispatchEvent(c)})}}return e.forEach(({propName:a,transform:o})=>{Object.defineProperty(r.prototype,a,{get(){return this.ngElementStrategy.getInputValue(a)},set(c){this.ngElementStrategy.setInputValue(a,c,o)},configurable:!0,enumerable:!0})}),r}var Q=(()=>{class n{constructor(){this.parent=u(X),this.property=""}get content(){if(this.parent&&this.property&&this.parent[this.property])return this.parent[this.property]}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=g({type:n,selectors:[["dyn-data"]],inputs:{property:"property"},decls:1,vars:1,template:function(i,s){i&1&&m(0),i&2&&z(s.content)},styles:["[_nghost-%COMP%]{display:inline-block;border:1px solid green;padding:5px 2px}"],changeDetection:0})}}return n})(),X=(()=>{class n{constructor(){this.elmRef=u(_),this.sanitizer=u(P),this.elm=this.elmRef.nativeElement,this.name="Angular",this.html=`
  <h1>Some random HTML</h1>
  <p>Well, <dyn-data property='name'></dyn-data> is awesome</p>
  <p>
  To do it this way is really dangerous, as it will expose to all kind of security issues.
  (see the functioning alert in the sample code!!)
  But the person that asked the question, needed a way to run script tags, and this is the easiest way.
  With this sample comes a severe warning, that this is really dangerous.
  </p>
  <button onclick="alert('hi')">hi</button>
  `,this._=k(()=>{typeof document>"u"||this.update(this.html)});let e=u(h);if(typeof document>"u")return;let i=N(Q,{injector:e});customElements.define("dyn-data",i)}update(e){let i=this.elm.querySelector("#target");i.innerHTML=e}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=g({type:n,selectors:[["app-dynamichtml"]],decls:7,vars:2,consts:[["type","text",3,"input","value"],[3,"input","value"],["id","target"]],template:function(i,s){i&1&&(l(0,"h1"),m(1,"Dynamic HTML sample"),p(),l(2,"input",0),b("input",function(a){return s.name=a.target.value}),p(),l(3,"textarea",1),b("input",function(a){return s.update(a.target.value)}),p(),l(4,"button"),m(5,"Update"),p(),O(6,"div",2)),i&2&&(f(2),E("value",s.name),f(),E("value",s.html))},styles:["textarea[_ngcontent-%COMP%]{display:block;height:6rem;width:30rem;padding:0}"],changeDetection:0})}}return n})();export{X as DynamicHtmlComponent};
