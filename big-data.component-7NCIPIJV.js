import{a as q}from"./chunk-TSSCPVME.js";import{i as Y}from"./chunk-IBCCEPDQ.js";import{A as P,Ab as F,Bb as r,Cb as o,Db as I,Hb as U,J as S,Kb as m,Lb as d,M as h,Vb as a,W as k,Wb as g,Y as y,Yb as O,Za as l,cc as A,ec as j,fa as B,fc as N,g as b,ha as D,ob as V,q as _,r as w,ra as c,rb as E,s as $,sa as p,wb as T,yb as M,zb as L}from"./chunk-L7DZHDME.js";import{a as C,b as v}from"./chunk-KAT7YFEL.js";function G(s,x){if(s&1&&(r(0,"tr")(1,"td"),a(2),o(),r(3,"td"),a(4),o(),r(5,"td"),a(6),o()()),s&2){let t=x.$implicit;l(2),g(t.id),l(2),g(t.username),l(2),g(t.email)}}function H(s,x){if(s&1){let t=U();r(0,"section"),a(1),I(2,"br"),r(3,"label"),a(4,"Search "),r(5,"input",0),m("input",function(e){c(t);let i=d();return p(i.setProp("search",e))}),o()(),r(6,"div",1)(7,"button",2),m("click",function(e){c(t);let i=d();return p(i.setProp("sort",e))}),a(8,"none"),o(),r(9,"button",3),m("click",function(e){c(t);let i=d();return p(i.setProp("sort",e))}),a(10,"username"),o(),r(11,"button",4),m("click",function(e){c(t);let i=d();return p(i.setProp("sort",e))}),a(12,"email"),o(),r(13,"button",5),m("click",function(e){c(t);let i=d();return p(i.setProp("sort",e))}),a(14,"id"),o()(),r(15,"div",6)(16,"input",7),m("input",function(e){c(t);let i=d();return p(i.setProp("position",e))}),o(),r(17,"table")(18,"tbody"),L(19,G,7,3,"tr",null,M),o()()()()}if(s&2){let t=x;l(),O(" Available users:",t.users.length," (Loading done:",t.done,"%)"),l(15),E("max",t.users.length/t.state.pageSize),l(3),F(t.page)}}var z=(()=>{class s{constructor(){this.user=B(q),this.state$=new b({pageSize:20,position:0,search:"",sort:""}),this.users$=this.state$.pipe(_(t=>t.sort),h(),k(t=>this.user.allUsers$.pipe(_(n=>t===""?n:n.sort((e,i)=>e[t]<i[t]?-1:1))))),this.doneLoadingPer$=P(100).pipe(S(1e3),y(()=>this.user.addUsers(500)),_(t=>Math.ceil(t/1e3*100))),this.curPage$=this.state$.pipe(h(),$(t=>this.users$.pipe(_(n=>this.findFirst(n,t))))),this.vm$=w({users:this.users$,state:this.state$,page:this.curPage$,done:this.doneLoadingPer$})}findFirst(t,{position:n,pageSize:e,search:i}){if(!i)return t.slice(n*e,n*e+e);let u=0,f=[];for(;u<t.length&&f.length<e;)t[u].username.toLowerCase().includes(i.toLowerCase())&&f.push(t[u]),u+=1;return f}setProp(t,n){let e=n.target,i=this.state$.value,u=typeof i[t]=="number";this.state$.next(v(C({},i),{[t]:u?e.valueAsNumber:e.value}))}static{this.\u0275fac=function(n){return new(n||s)}}static{this.\u0275cmp=D({type:s,selectors:[["app-big-data"]],standalone:!0,features:[A],decls:4,vars:3,consts:[[3,"input"],["id","buttons"],["value","",3,"click"],["value","username",3,"click"],["value","email",3,"click"],["value","id",3,"click"],["id","scroll"],["type","range",3,"input","max"]],template:function(n,e){if(n&1&&(r(0,"h1"),a(1,"Big data and performance demo"),o(),V(2,H,21,3,"section"),j(3,"async")),n&2){let i;l(2),T((i=N(3,1,e.vm$))?2:-1,i)}},dependencies:[Y],styles:["#scroll[_ngcontent-%COMP%]{display:grid;grid-template-columns:40px 1fr}#buttons[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,154px)}#scroll[_ngcontent-%COMP%] > input[_ngcontent-%COMP%]{transform:translateY(-100%) rotate(90deg);transform-origin:left bottom;width:20rem;height:40px}"]})}}return s})();export{z as BigDataComponent};
