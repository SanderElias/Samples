import{d as N}from"./chunk-S4O5QD3L.js";import"./chunk-T7U37Q2O.js";import"./chunk-P4K3TQV7.js";import"./chunk-D4NNR5R6.js";import{$b as z,B as w,Da as x,Db as O,V as F,Va as V,Za as f,Zb as p,_b as h,d as C,db as j,ea as l,eb as Z,ec as E,fb as k,g as M,hb as y,ic as b,na as m,rb as g,sa as T,wa as _,wc as d,xc as P,zb as L}from"./chunk-KIBRB3UE.js";import"./chunk-C6Q5SG76.js";var W={schedule(n,t){let e=setTimeout(n,t);return()=>clearTimeout(e)}};function Y(n){return n.replace(/[A-Z]/g,t=>`-${t.toLowerCase()}`)}function B(n){return!!n&&n.nodeType===Node.ELEMENT_NODE}var v;function U(n,t){if(!v){let e=Element.prototype;v=e.matches||e.matchesSelector||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector||e.webkitMatchesSelector}return n.nodeType===Node.ELEMENT_NODE?v.call(n,t):!1}function $(n){let t={};return n.forEach(({propName:e,templateName:i,transform:s})=>{t[Y(i)]=[e,s]}),t}function G(n,t){return t.get(y).resolveComponentFactory(n).inputs}function J(n,t){let e=n.childNodes,i=t.map(()=>[]),s=-1;t.some((r,a)=>r==="*"?(s=a,!0):!1);for(let r=0,a=e.length;r<a;++r){let o=e[r],c=K(o,t,s);c!==-1&&i[c].push(o)}return i}function K(n,t,e){let i=e;return B(n)&&t.some((s,r)=>s!=="*"&&U(n,s)?(i=r,!0):!1),i}var Q=10,S=class{componentFactory;inputMap=new Map;constructor(t,e){this.componentFactory=e.get(y).resolveComponentFactory(t);for(let i of this.componentFactory.inputs)this.inputMap.set(i.propName,i.templateName)}create(t){return new I(this.componentFactory,t,this.inputMap)}},I=class{componentFactory;injector;inputMap;eventEmitters=new M(1);events=this.eventEmitters.pipe(F(t=>w(...t)));componentRef=null;scheduledDestroyFn=null;initialInputValues=new Map;ngZone;elementZone;appRef;cdScheduler;constructor(t,e,i){this.componentFactory=t,this.injector=e,this.inputMap=i,this.ngZone=this.injector.get(T),this.appRef=this.injector.get(O),this.cdScheduler=e.get(_),this.elementZone=typeof Zone>"u"?null:this.ngZone.run(()=>Zone.current)}connect(t){this.runInZone(()=>{if(this.scheduledDestroyFn!==null){this.scheduledDestroyFn(),this.scheduledDestroyFn=null;return}this.componentRef===null&&this.initializeComponent(t)})}disconnect(){this.runInZone(()=>{this.componentRef===null||this.scheduledDestroyFn!==null||(this.scheduledDestroyFn=W.schedule(()=>{this.componentRef!==null&&(this.componentRef.destroy(),this.componentRef=null)},Q))})}getInputValue(t){return this.runInZone(()=>this.componentRef===null?this.initialInputValues.get(t):this.componentRef.instance[t])}setInputValue(t,e){if(this.componentRef===null){this.initialInputValues.set(t,e);return}this.runInZone(()=>{this.componentRef.setInput(this.inputMap.get(t)??t,e),Z(this.componentRef.hostView)&&(k(this.componentRef.changeDetectorRef),this.cdScheduler.notify(6))})}initializeComponent(t){let e=m.create({providers:[],parent:this.injector}),i=J(t,this.componentFactory.ngContentSelectors);this.componentRef=this.componentFactory.create(e,i,t),this.initializeInputs(),this.initializeOutputs(this.componentRef),this.appRef.attachView(this.componentRef.hostView),this.componentRef.hostView.detectChanges()}initializeInputs(){for(let[t,e]of this.initialInputValues)this.setInputValue(t,e);this.initialInputValues.clear()}initializeOutputs(t){let e=this.componentFactory.outputs.map(({propName:i,templateName:s})=>{let r=t.instance[i];return new C(a=>{let o=r.subscribe(c=>a.next({name:s,value:c}));return()=>o.unsubscribe()})});this.eventEmitters.next(e)}runInZone(t){return this.elementZone&&Zone.current!==this.elementZone?this.ngZone.run(t):t()}},D=class extends HTMLElement{ngElementEventsSubscription=null};function H(n,t){let e=G(n,t.injector),i=t.strategyFactory||new S(n,t.injector),s=$(e);class r extends D{injector;static observedAttributes=Object.keys(s);get ngElementStrategy(){if(!this._ngElementStrategy){let o=this._ngElementStrategy=i.create(this.injector||t.injector);e.forEach(({propName:c,transform:u})=>{if(!this.hasOwnProperty(c))return;let R=this[c];delete this[c],o.setInputValue(c,R,u)})}return this._ngElementStrategy}_ngElementStrategy;constructor(o){super(),this.injector=o}attributeChangedCallback(o,c,u,R){let[A,q]=s[o];this.ngElementStrategy.setInputValue(A,u,q)}connectedCallback(){let o=!1;this.ngElementStrategy.events&&(this.subscribeToEvents(),o=!0),this.ngElementStrategy.connect(this),o||this.subscribeToEvents()}disconnectedCallback(){this._ngElementStrategy&&this._ngElementStrategy.disconnect(),this.ngElementEventsSubscription&&(this.ngElementEventsSubscription.unsubscribe(),this.ngElementEventsSubscription=null)}subscribeToEvents(){this.ngElementEventsSubscription=this.ngElementStrategy.events.subscribe(o=>{let c=new CustomEvent(o.name,{detail:o.value});this.dispatchEvent(c)})}}return e.forEach(({propName:a,transform:o,isSignal:c})=>{Object.defineProperty(r.prototype,a,{get(){let u=this.ngElementStrategy.getInputValue(a);return c&&L(u)?u():u},set(u){this.ngElementStrategy.setInputValue(a,u,o)},configurable:!0,enumerable:!0})}),r}var X=(()=>{class n{constructor(){this.parent=l(tt),this.property=""}get content(){if(this.parent&&this.property&&this.parent[this.property])return this.parent[this.property]}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=g({type:n,selectors:[["dyn-data"]],inputs:{property:"property"},decls:1,vars:1,template:function(i,s){i&1&&d(0),i&2&&P(s.content)},styles:["[_nghost-%COMP%]{display:inline-block;border:1px solid green;padding:5px 2px}"],changeDetection:0})}}return n})(),tt=(()=>{class n{constructor(){this.elmRef=l(x),this.sanitizer=l(N),this.elm=this.elmRef.nativeElement,this.name="Angular",this.html=`
  <h1>Some random HTML</h1>
  <p>Well, <dyn-data property='name'></dyn-data> is awesome</p>
  <p>
  To do it this way is really dangerous, as it will expose to all kind of security issues.
  (see the functioning alert in the sample code!!)
  But the person that asked the question, needed a way to run script tags, and this is the easiest way.
  With this sample comes a severe warning, that this is really dangerous.
  </p>
  <button onclick="alert('hi')">hi</button>
  `,this._=j(()=>{typeof document>"u"||this.update(this.html)});let e=l(m);if(typeof document>"u")return;let i=H(X,{injector:e});customElements.define("dyn-data",i)}update(e){let i=this.elm.querySelector("#target");i.innerHTML=e}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=g({type:n,selectors:[["app-dynamichtml"]],decls:7,vars:2,consts:[["type","text",3,"input","value"],[3,"input","value"],["id","target"]],template:function(i,s){i&1&&(p(0,"h1"),d(1,"Dynamic HTML sample"),h(),p(2,"input",0),b("input",function(a){return s.name=a.target.value}),h(),p(3,"textarea",1),b("input",function(a){return s.update(a.target.value)}),h(),p(4,"button"),d(5,"Update"),h(),z(6,"div",2)),i&2&&(f(2),E("value",s.name),f(),E("value",s.html))},styles:["textarea[_ngcontent-%COMP%]{display:block;height:6rem;width:30rem;padding:0}"],changeDetection:0})}}return n})();export{tt as DynamicHtmlComponent};
