import{m as u}from"./chunk-SHWH7FWF.js";import{Ca as m,Da as d,Fb as y,Hb as D,Ib as _,Jb as S,Kb as z,Pb as M,Sb as k,fa as r,gc as w,hb as v,hc as B,ic as x,ma as g,mb as p,na as C,sc as b,vc as f,ya as h,yc as $}from"./chunk-FE3MAFSK.js";import"./chunk-KAT7YFEL.js";var I=(t,l)=>Math.round(Math.random()*(l-t))+t,P=(()=>{class t{constructor(){this.cellData=v.required(),this.elm=r(m).nativeElement,this.zone=r(h),this.aliveColor=`oklch(${I(55,95)}% 75% 173`,this.deadColor=`oklch(${I(10,55)}% 50% 280`,this.id=f(()=>this.cellData().id),this.alive=f(()=>this.cellData().alive),this.setBg=()=>this.zone.runOutsideAngular(()=>this.elm.style.setProperty("--cellBg",this.alive()?this.aliveColor:this.deadColor)),this.dummy=$(()=>this.setBg())}ngOnInit(){this.setBg()}static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275cmp=p({type:t,selectors:[["se-cell"]],inputs:{cellData:[1,"cellData"]},outputs:{cellData:"cellDataChange"},decls:0,vars:0,template:function(e,s){},dependencies:[u],styles:["[_nghost-%COMP%]{display:flex;width:var(--cellSize);aspect-ratio:1;align-items:center;justify-content:center;background-color:var(--cellBg);border-radius:.25rem;padding:0rem;overflow:none;text-overflow:ellipsis}"]})}}return t})();function O(t,l){if(t&1){let i=M();S(0,"se-cell",1),x("cellDataChange",function(s){let a=g(i).$implicit;return B(a,s),C(s)}),z()}if(t&2){let i=l.$implicit;w("cellData",i)}}var T=(t,l)=>Math.round(Math.random()*(l-t))+t,K=(()=>{class t{constructor(){this.elm=r(m).nativeElement,this.zone=r(h),this.cdr=r(b),this.isAlive=d(!1),this.gridSize=d(100),this.cells=d(Array.from({length:200},(i,e)=>d({id:e,alive:Math.random()<.06}))),this.growList=async()=>{let i=this.gridSize()*this.gridSize();for(;this.cells().length<i;){let e=this.cells().length,s=250,a=e+s>i?i-e:s,c=[];for(let o=0;o<a;o+=1)c.push(d({id:e+o,alive:Math.random()<.06}));this.cells.update(o=>o.concat(c)),await new Promise(o=>setTimeout(o,5))}console.log(`Done, created ${i} in a ${this.gridSize()} x ${this.gridSize()} grid.`)},this.repopulate=()=>this.cells().forEach(i=>i.update(({id:e})=>({id:e,alive:Math.random()<.06}))),this.calcGrid=()=>{if(typeof window>"u")return;let e=window.getComputedStyle(this.elm).getPropertyValue("grid-template-columns").split(" ").length;this.gridSize.set(e)},this.aliveColor=`oklch(${T(55,95)}% 75% 173`,this.deadColor=`oklch(${T(10,55)}% 50% 280`,this.cycle=async()=>{let i=this.cells(),e=this.gridSize();for(let s of i){let{id:a,alive:c}=s(),o=R(a,e).reduce((n,A)=>n+=i[A]?.().alive?1:0,0);if(c&&!(o===2||o===3)){s.set({id:a,alive:!1});continue}!c&&o===3&&s.set({id:a,alive:!0})}this.isAlive()&&await new Promise(s=>setTimeout(()=>this.cycle(),100))},this.onClick=i=>{this.zone.runOutsideAngular(()=>{this.started?(clearInterval(this.started),this.repopulate(),this.started=void 0):this.started=setInterval(this.cycle,100)})}}async ngOnInit(){this.calcGrid(),await this.growList(),this.isAlive.set(!0),this.cycle()}static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275cmp=p({type:t,selectors:[["se-cells"]],hostBindings:function(e,s){e&1&&k("click",function(){return s.onClick()})},decls:2,vars:0,consts:[[3,"cellData"],[3,"cellDataChange","cellData"]],template:function(e,s){e&1&&D(0,O,1,1,"se-cell",0,y),e&2&&_(s.cells())},dependencies:[u,P],styles:['@property --cellBg{syntax: "<color>"; inherits: true; initial-value: black;}@property --cellSize{syntax: "<length> | <percentage>"; inherits: true; initial-value: 1.25rem;}[_nghost-%COMP%]{--cellBg: oklch(.5 .5 150);--cellSize: 15px;display:grid;height:95vh;aspect-ratio:1;grid-template-columns:repeat(auto-fit,var(--cellSize));grid-template-rows:repeat(auto-fit,var(--cellSize));gap:.15rem}'],changeDetection:0})}}return t})();function R(t,l){let i=n=>n<l?n-l+l*l:n-l,e=n=>n+l>l*l-1?n+l-l*l:n+l,s=n=>n%l===0?n+l-1:n-1,a=n=>n+1%l===0?n-l+1:n+1,c=i(t),o=e(t);return[s(c),c,a(c),s(t),a(t),s(o),o,a(o)]}export{K as CellsComponent};
