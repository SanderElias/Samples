import{b as M,c as w}from"./chunk-6H4XIARE.js";import{a as q}from"./chunk-AJROCCCR.js";import{e as _}from"./chunk-MGEOVUXS.js";import"./chunk-Q7HKI3MB.js";import"./chunk-B64JRXJ4.js";import"./chunk-OZD4UVZE.js";import"./chunk-QF5K4MHH.js";import{Lc as v,Mc as s,Rc as S,Sb as n,Sc as x,Tb as o,Tc as D,Ub as a,Yb as g,bc as b,ea as f,ja as c,jc as h,ka as p,kb as E,kc as y,pc as r}from"./chunk-JMJSAENN.js";import{a as u}from"./chunk-DAQOROHW.js";var O=["form"],L=(()=>{class d{constructor(){this.id=x.required(),this.done=S(),this.form=D("form"),this.rs=f(w),this.relation=this.rs.read(this.id),this.flatData=s({source:()=>this.relation()?.value(),computation:i=>q(i??{})}),this.fields=s({source:this.flatData,computation:i=>Object.keys(i)}),this._=v(()=>{let i=this.flatData(),e=this.form()?.nativeElement;if(!(!i||!e))for(let[m,t]of Object.entries(i))e[m]&&(e[m].value=t)})}async submit(i){i.preventDefault();let e=i.target;if(!e)return;let m=u({},this.flatData());for(let t of this.fields())if(e[t]){let l=typeof m[t];l==="string"&&(m[t]=e[t].value),l==="number"&&(m[t]=Number(e[t].value)),l==="boolean"&&(m[t]=e[t].checked)}if(_(this.flatData(),m))this.done.emit();else{let t=M(m);console.log("newData",t),await this.rs.update(t)?this.done.emit():console.error("Error updating the user")}}static{this.\u0275fac=function(e){return new(e||d)}}static{this.\u0275cmp=E({type:d,selectors:[["relation-form"]],viewQuery:function(e,m){e&1&&h(m.form,O,5),e&2&&y()},inputs:{id:[1,"id"]},outputs:{done:"done"},decls:37,vars:0,consts:[["form",""],[3,"submit"],["for","name"],["id","name","name","name","required",""],["for","username"],["id","username","name","username","required",""],["for","email"],["id","email","name","email","required","","type","email"],["for","street"],["id","street","name","address.street","required",""],["for","suite"],["id","suite","name","address.suite"],["for","city"],["id","city","name","address.city","required",""],["for","zipcode"],["id","zipcode","name","address.zipcode","required",""],["for","lat"],["id","lat","name","address.geo.lat","required","","min","-90","max","90","type","number","step","0.0001"],["for","lng"],["id","lng","name","address.geo.lng","required","","min","-180","max","180","type","number","step","0.0001"]],template:function(e,m){if(e&1){let t=g();n(0,"form",1,0),b("submit",function(C){return c(t),p(m.submit(C))}),n(2,"label",2),r(3,"Name"),o(),a(4,"input",3),n(5,"label",4),r(6,"Username"),o(),a(7,"input",5),n(8,"label",6),r(9,"Email"),o(),a(10,"input",7),n(11,"fieldset")(12,"legend"),r(13,"Address"),o(),n(14,"label",8),r(15,"Street"),o(),a(16,"input",9),n(17,"label",10),r(18,"Suite"),o(),a(19,"input",11),n(20,"label",12),r(21,"City"),o(),a(22,"input",13),n(23,"label",14),r(24,"Zipcode"),o(),a(25,"input",15),n(26,"fieldset")(27,"legend"),r(28,"Geo"),o(),n(29,"label",16),r(30,"Latitude"),o(),a(31,"input",17),n(32,"label",18),r(33,"Longitude"),o(),a(34,"input",19),o()(),n(35,"button"),r(36,"Submit"),o()()}},styles:['form[_ngcontent-%COMP%], fieldset[_ngcontent-%COMP%]{display:flex;flex-direction:column}input[_ngcontent-%COMP%]{margin-bottom:1rem}label[_ngcontent-%COMP%]:has(+input[required]):after{display:inline;content:"*";color:orange}input[_ngcontent-%COMP%]:last-child{margin-bottom:0}']})}}return d})();export{L as RelationForm};
