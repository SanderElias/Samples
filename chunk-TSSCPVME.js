import{$,J as p,U as u,V as f,Y as w,f as c,p as a,q as h,s as l,z as m}from"./chunk-L7DZHDME.js";import{a as r,b as o}from"./chunk-KAT7YFEL.js";var U="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",g=(e=2e3)=>Math.floor(Math.random()*e),y=()=>U[g(U.length)];var d=()=>Date.now().toString(36).split("").reverse().map(e=>e+y()).join("");var x=import("./chance-B42Q2VJL.js").then(e=>e).then(({default:e})=>new e);var k=(()=>{class e{constructor(){this.flush$=new c,this.updatedUsers$=new c,this.allUsers$=this.flush$.pipe(l(()=>this.updatedUsers$),f([]),u({bufferSize:1,refCount:!1})),this.admins$=this.allUsers$.pipe(h(s=>s.filter(t=>t.isAdmin))),this.users$=this.allUsers$.pipe(h(s=>s.filter(t=>!t.isAdmin))),this.flushCache()}async addUsers(s){let t=await a(this.allUsers$),i=t.length,n=await Promise.all(Array.from({length:s}).map(async(A,v)=>o(r({},await b()),{id:d()})));this.updatedUsers$.next(t.concat(n))}async saveUser(s){let t=await a(this.allUsers$),i=t.findIndex(n=>n.id===s.id);if(i>-1)Object.assign(t[i],s);else{let n=d();t.unshift(o(r({},s),{id:n}))}this.updatedUsers$.next(t)}async deleteUser(s){let t=(await a(this.allUsers$)).filter(i=>i.id!==s.id);this.updatedUsers$.next(t)}async flushCache(){let s=await x;await new Promise(t=>setTimeout(t)),this.flush$.next(),m(0,250).pipe(w(()=>this.addUsers(s.integer({min:100,max:400}))),p(20)).subscribe()}static{this.\u0275fac=function(t){return new(t||e)}}static{this.\u0275prov=$({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();async function b(){let e=await x;return{userState:e.integer({min:0,max:3}),username:e.name(),isAdmin:e.bool(),isActive:e.bool(),email:e.email()}}export{k as a};
