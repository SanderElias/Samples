import{b as g}from"./chunk-72HSU5ID.js";import{e as K}from"./chunk-7NCCIKVB.js";import{b as U,d as W,h as R,n as Y,q,r as z,s as G,z as J}from"./chunk-QDTWEGOC.js";import"./chunk-GOJFU6NU.js";import{C as x,Ca as L,Cb as O,D as V,Fb as C,G as D,Gb as c,H as N,M as B,Ob as a,Pb as S,Qb as y,W as k,Wa as l,Xb as w,Y as j,fa as H,ha as v,l as $,lb as I,nb as m,p as M,q as P,r as T,rb as A,sa as E,ta as F,tb as _,ub as h,vb as u,wb as o,xb as r,yb as f}from"./chunk-XM75YRED.js";import"./chunk-KAT7YFEL.js";function ee(t,s){if(t&1){let e=O();o(0,"details")(1,"summary"),a(2),o(3,"button",0),C("click",function(){let n=E(e),d=c(2).$implicit,p=c();return F(p.selected.emit([p.key(d),n.name||n.title]))}),a(4,"Select"),r()(),f(5,"app-show-rec",1),r()}if(t&2){let e=s;l(2),y(" ",e.name||e.title," "),l(3),m("record",e)}}function te(t,s){if(t&1&&a(0),t&2){let e=c(2).$implicit,i=c();y(" ",i.val(e)," ")}}function ie(t,s){if(t&1&&I(0,ee,6,2,"details")(1,te,1,1),t&2){let e,i=c().$implicit,n=c();A((e=n.isRecord(n.val(i)))?0:1,e)}}function ne(t,s){if(t&1){let e=O();o(0,"details")(1,"summary"),a(2),o(3,"button",0),C("click",function(){let n=E(e).$implicit,d=c(2).$implicit,p=c();return F(p.selected.emit([p.key(d),n.name||n.title]))}),a(4,"Select"),r()(),f(5,"app-show-rec",1),r()}if(t&2){let e=s.$implicit;l(2),y(" ",e.name||e.title," "),l(3),m("record",e)}}function oe(t,s){if(t&1&&h(0,ne,6,2,"details",null,_),t&2){let e=c().$implicit,i=c();u(i.val(e))}}function re(t,s){if(t&1&&(o(0,"dl")(1,"dt"),a(2),r(),o(3,"dd"),I(4,ie,2,1)(5,oe,2,0),r()()),t&2){let e=s.$implicit,i=c();l(2),S(i.key(e)),l(2),A(i.isRecArray(e)?5:4)}}var ae=t=>t[0],Q=t=>t[1],X=(()=>{class t{set record(e){e&&(this.entries=Object.entries(e))}constructor(){this.selected=new L,this.key=ae,this.val=Q}isRecArray(e){let i=Q(e);if(Array.isArray(i)&&i.length>0){let n=i[0];return!Array.isArray(n)&&typeof n=="object"}return!1}isRecord(e){return e&&!Array.isArray(e)&&typeof e=="object"&&e}ngOnInit(){}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=v({type:t,selectors:[["app-show-rec"]],inputs:{record:"record"},outputs:{selected:"selected"},standalone:!0,features:[w],decls:2,vars:0,consts:[[3,"click"],[3,"record"]],template:function(i,n){i&1&&h(0,re,6,2,"dl",null,_),i&2&&u(n.entries)},dependencies:[t],styles:[`dl[_ngcontent-%COMP%] {
    display: grid;
    grid-template-columns: 5em 1fr;
  }
  dt[_ngcontent-%COMP%] {
    font-weight: initial;
    max-width: 5em;
    overflow: hidden;
  }
  dd[_ngcontent-%COMP%] {
    font-weight: bolder;
    margin-left: 0.5em;
  }
  summary[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] {
    display: inline-block;
    margin-left: 5px;
    padding: 2px;
  }`]})}}return t})();function le(t,s){if(t&1&&(o(0,"option"),a(1),r()),t&2){let e=s.$implicit;l(),S(e)}}function se(t,s){if(t&1&&(o(0,"option"),a(1),r()),t&2){let e=s.$implicit;l(),S(e)}}var ge=(()=>{class t{constructor(){this.#e=H(K),this.chosenSet=new R(""),this.name=new R(""),this.availableSets$=this.#e.swapiRoot$.pipe(P(e=>Object.keys(e))),this.availableSets=g(this.availableSets$),this.availableOptions=g(T([this.availableSets$,this.chosenSet.valueChanges]).pipe(x(([e,i])=>e.includes(i)),k(([e,i])=>this.#e.getSetNames(i))),{initialValue:[]}),this.result=g(T([this.chosenSet.valueChanges,this.name.valueChanges.pipe(N(250),B(),x(Boolean))]).pipe(k(([e,i])=>this.#e.findIn(e,i)),x(Boolean),j(e=>this.rawData=e),D(e=>this.#e.enrich(e)),V(e=>(console.error(e),$({"Not Found":"Your search string didn't return any results"})))))}#e;ngAfterViewInit(){this.changeTo(["people","luke"])}async changeTo(e){let i=await M(this.availableSets$),[n,d]=e,p=n;if(!i.includes(n)){let b=this.rawData[n];p=this.#e.detectSet(Array.isArray(b)?b[0]:b)}this.chosenSet.setValue(p,{emitEvent:!0}),this.name.setValue(d,{emitEvent:!0})}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=v({type:t,selectors:[["app-apisample"]],standalone:!0,features:[w],decls:23,vars:3,consts:[["target","blank","href","https://github.com/SanderElias/Samples/blob/master/projects/se-ng/swapi/src/lib/swapi.service.ts"],["target","blank","href","https://swapi.dev"],[3,"formControl"],["type","text","list","listOptions","autofocus","",3,"formControl"],[3,"selected","record"],["id","listOptions"]],template:function(i,n){i&1&&(o(0,"H3"),a(1,"Complex api sample"),r(),o(2,"h4"),a(3,"(first load might take a while!)"),r(),o(4,"p"),a(5," The complexity is in the API, have an look at "),o(6,"a",0),a(7,"the swapi service"),r(),a(8,"."),f(9,"br"),a(10," This sample loads all of "),o(11,"a",1),a(12,"SWAPI"),r(),a(13,` and caches it to indexedDB. This is also the reason the first load takes longer.
`),r(),o(14,"select",2),h(15,le,2,1,"option",null,_),r(),f(17,"br")(18,"input",3),o(19,"app-show-rec",4),C("selected",function(p){return n.changeTo(p)}),r(),o(20,"datalist",5),h(21,se,2,1,"option",null,_),r()),i&2&&(l(14),m("formControl",n.chosenSet),l(),u(n.availableSets()),l(3),m("formControl",n.name),l(),m("record",n.result()),l(2),u(n.availableOptions()))},dependencies:[J,z,G,U,q,W,Y,X],styles:[`[_nghost-%COMP%] {
    display: block;
    max-height: 95vh;
    max-width: 98vw;
    overflow-x: hidden;
    overflow-y: auto;
  }`]})}}return t})();export{ge as APISampleComponent};
