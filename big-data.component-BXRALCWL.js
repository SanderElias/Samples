import{a as Y}from"./chunk-7K77LPWV.js";import{i as N,j as A,k as j}from"./chunk-GR2PXCGU.js";import{Eb as L,Gb as O,Hb as U,I as V,L as C,V as E,W as B,Wa as p,Ya as I,ab as b,cb as x,db as r,eb as o,f as P,fb as M,ha as D,jb as T,mb as _,nb as g,o as f,p as S,pa as u,q as y,qa as d,sb as s,tb as h,vb as F,y as k}from"./chunk-X5MK5QQ4.js";import{a as w,b as $}from"./chunk-G5KKTNWD.js";function q(l,a){if(l&1&&(r(0,"tr")(1,"td"),s(2),o(),r(3,"td"),s(4),o(),r(5,"td"),s(6),o()()),l&2){let n=a.$implicit;p(2),h(n.id),p(2),h(n.username),p(2),h(n.email)}}function G(l,a){if(l&1){let n=T();r(0,"section"),s(1),M(2,"br"),r(3,"label"),s(4,"Search "),r(5,"input",1),_("input",function(e){u(n);let t=g();return d(t.setProp("search",e))}),o()(),r(6,"div",2)(7,"button",3),_("click",function(e){u(n);let t=g();return d(t.setProp("sort",e))}),s(8,"none"),o(),r(9,"button",4),_("click",function(e){u(n);let t=g();return d(t.setProp("sort",e))}),s(10,"username"),o(),r(11,"button",5),_("click",function(e){u(n);let t=g();return d(t.setProp("sort",e))}),s(12,"email"),o(),r(13,"button",6),_("click",function(e){u(n);let t=g();return d(t.setProp("sort",e))}),s(14,"id"),o()(),r(15,"div",7)(16,"input",8),_("input",function(e){u(n);let t=g();return d(t.setProp("position",e))}),o(),r(17,"table")(18,"tbody"),b(19,q,7,3,"tr",9),o()()()()}if(l&2){let n=a.ngIf;p(1),F(" Available users:",n.users.length," (Loading done:",n.done,"%)"),p(15),x("max",n.users.length/n.state.pageSize),p(3),x("ngForOf",n.page)}}var W=(()=>{let a=class{constructor(i){this.user=i,this.state$=new P({pageSize:20,position:0,search:"",sort:""}),this.users$=this.state$.pipe(f(e=>e.sort),C(),E(e=>this.user.allUsers$.pipe(f(t=>e===""?t:t.sort((m,c)=>m[e]<c[e]?-1:1))))),this.doneLoadingPer$=k(100).pipe(V(1e3),B(()=>this.user.addUsers(500)),f(e=>Math.ceil(e/1e3*100))),this.curPage$=this.state$.pipe(C(),y(e=>this.users$.pipe(f(t=>this.findFirst(t,e))))),this.vm$=S({users:this.users$,state:this.state$,page:this.curPage$,done:this.doneLoadingPer$})}findFirst(i,{position:e,pageSize:t,search:m}){if(!m)return i.slice(e*t,e*t+t);let c=0,v=[];for(;c<i.length&&v.length<t;)i[c].username.toLowerCase().includes(m.toLowerCase())&&v.push(i[c]),c+=1;return v}setProp(i,e){let t=e.target,m=this.state$.value,c=typeof m[i]=="number";this.state$.next($(w({},m),{[i]:c?t.valueAsNumber:t.value}))}},l=a;return(()=>{a.\u0275fac=function(e){return new(e||a)(I(Y))}})(),(()=>{a.\u0275cmp=D({type:a,selectors:[["app-big-data"]],standalone:!0,features:[L],decls:4,vars:3,consts:[[4,"ngIf"],[3,"input"],["id","buttons"],["value","",3,"click"],["value","username",3,"click"],["value","email",3,"click"],["value","id",3,"click"],["id","scroll"],["type","range",3,"max","input"],[4,"ngFor","ngForOf"]],template:function(e,t){e&1&&(r(0,"h1"),s(1,"Big data and performance demo"),o(),b(2,G,20,4,"section",0),O(3,"async")),e&2&&(p(2),x("ngIf",U(3,1,t.vm$)))},dependencies:[j,A,N],styles:[`#scroll[_ngcontent-%COMP%] {
        display: grid;
        grid-template-columns: 40px 1fr;
      }
      #buttons[_ngcontent-%COMP%] {
        display: grid;
        grid-template-columns: repeat(auto-fit, 154px);
      }
      #scroll[_ngcontent-%COMP%]    > input[_ngcontent-%COMP%] {
        transform: translateY(-100%) rotate(90deg); 
        transform-origin: left bottom;
        width: 20rem; 
        height: 40px; 
      }`]})})(),l})();export{W as BigDataComponent};
