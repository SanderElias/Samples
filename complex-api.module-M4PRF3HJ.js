import{e as le}from"./chunk-HYLLT52H.js";import"./chunk-XZCHICF6.js";import{a as te,b as ne,e as D,h as ie,i as oe,j as re,k as ae,m as se}from"./chunk-5ZQCA35F.js";import{l as ee}from"./chunk-PDRBMYKP.js";import{l as S,m as Q,n as X,q as Z}from"./chunk-7RIGLVAR.js";import{$a as d,C as M,D as J,G as U,Gb as F,H,Hb as $,Jb as K,M as L,Rb as V,Va as s,W,Xa as G,Y,ab as O,bb as l,ca as q,cb as r,db as a,eb as u,fb as T,gb as k,ib as A,ja as y,k as N,ka as z,mb as C,nb as c,p as j,q as B,qa as I,ra as R,sb as o,tb as w,ub as v}from"./chunk-Q6DFD4YI.js";import{h as P}from"./chunk-G5KKTNWD.js";function de(i,t){if(i&1){let e=A();T(0),r(1,"details")(2,"summary"),o(3),r(4,"button",4),C("click",function(){let p=I(e).ngIf,f=c(2).$implicit,x=c();return R(x.selected.emit([x.key(f),p.name||p.title]))}),o(5," Select "),a()(),u(6,"app-show-rec",5),a(),k()}if(i&2){let e=t.ngIf;s(3),v("",e.name||e.title," "),s(3),l("record",e)}}function fe(i,t){if(i&1&&o(0),i&2){let e=c(2).$implicit,n=c();v(" ",n.val(e)," ")}}function _e(i,t){if(i&1&&(T(0),d(1,de,7,2,"ng-container",1),d(2,fe,1,1,"ng-template",null,3,V),k()),i&2){let e=O(3),n=c().$implicit,m=c();s(1),l("ngIf",m.isRecord(m.val(n)))("ngIfElse",e)}}function he(i,t){if(i&1){let e=A();r(0,"details")(1,"summary"),o(2),r(3,"button",4),C("click",function(){let p=I(e).$implicit,f=c(2).$implicit,x=c();return R(x.selected.emit([x.key(f),p.name||p.title]))}),o(4," Select "),a()(),u(5,"app-show-rec",5),a()}if(i&2){let e=t.$implicit;s(2),v("",e.name||e.title," "),s(3),l("record",e)}}function ue(i,t){if(i&1&&d(0,he,6,2,"details",0),i&2){let e=c().$implicit,n=c();l("ngForOf",n.val(e))}}function ge(i,t){if(i&1&&(r(0,"dl")(1,"dt"),o(2),a(),r(3,"dd"),d(4,_e,4,2,"ng-container",1),d(5,ue,1,1,"ng-template",null,2,V),a()()),i&2){let e=t.$implicit,n=O(6),m=c();s(2),w(m.key(e)),s(2),l("ngIf",!m.isRecArray(e))("ngIfElse",n)}}var _=class{constructor(){this.selected=new K,this.key=t=>t[0],this.val=t=>t[1]}set record(t){t&&(this.entries=Object.entries(t))}isRecArray(t){let e=t[1];if(Array.isArray(e)&&e.length>0){let n=e[0];return!Array.isArray(n)&&typeof n=="object"}return!1}isRecord(t){return t&&!Array.isArray(t)&&typeof t=="object"&&t}ngOnInit(){}},E=_;(()=>{_.\u0275fac=function(e){return new(e||_)}})(),(()=>{_.\u0275cmp=y({type:_,selectors:[["app-show-rec"]],inputs:{record:"record"},outputs:{selected:"selected"},decls:1,vars:1,consts:[[4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["handleArray",""],["handleRec",""],[3,"click"],[3,"record"]],template:function(e,n){e&1&&d(0,ge,7,3,"dl",0),e&2&&l("ngForOf",n.entries)},dependencies:[S,Q,_],styles:[`dl[_ngcontent-%COMP%] {
    display: grid;
    grid-template-columns: 5em 1fr;
  }
  dt[_ngcontent-%COMP%] {
    font-weight: initial;
    max-width: 5em;
    overflow: hidden;
  }
  dd[_ngcontent-%COMP%] {
    font-weight: bolder;
    margin-left: .5em;
  }
  summary[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] {
    display: inline-block;
    margin-left: 5px;
    padding: 2px;
  }`]})})();function Ce(i,t){if(i&1&&(r(0,"option"),o(1),a()),i&2){let e=t.$implicit;s(1),w(e)}}var g=class{constructor(t){this.sw=t,this.chosenSet=new D(""),this.name=new D(""),this.availableSets$=this.sw.swapiRoot$.pipe(j(e=>Object.keys(e))),this.result$=B(this.chosenSet.valueChanges,this.name.valueChanges.pipe(H(250),L(),M(Boolean))).pipe(W(([e,n])=>this.sw.findIn(e,n)),M(Boolean),Y(e=>this.rawData=e),U(e=>this.sw.enrich(e)),J(e=>(console.error(e),N({"Not Found":"Your search string didn't return any results"}))))}ngAfterViewInit(){this.changeTo(["people","luke"])}changeTo(t){return P(this,null,function*(){let e=yield this.availableSets$.toPromise(),[n,m]=t,p=n;if(!e.includes(n)){let f=this.rawData[n];p=this.sw.detectSet(Array.isArray(f)?f[0]:f)}console.log(p,m),this.chosenSet.setValue(p,{emitEvent:!0}),this.name.setValue(m,{emitEvent:!0})})}},b=g;(()=>{g.\u0275fac=function(e){return new(e||g)(G(le))}})(),(()=>{g.\u0275cmp=y({type:g,selectors:[["app-apisample"]],decls:20,vars:8,consts:[["target","blank","href","https://github.com/SanderElias/Samples/blob/master/projects/se-ng/swapi/src/lib/swapi.service.ts"],["target","blank","href","https://swapi.dev"],[3,"formControl"],[4,"ngFor","ngForOf"],["type","text","autofocus","",3,"formControl"],[3,"record","selected"]],template:function(e,n){e&1&&(r(0,"H3"),o(1,"Complex api sample"),a(),r(2,"h4"),o(3,"(first load might take a while!)"),a(),r(4,"p"),o(5," The complexity is in the API, have an look at "),r(6,"a",0),o(7,"the swapi service"),a(),o(8,"."),u(9,"br"),o(10," This sample loads all of "),r(11,"a",1),o(12,"SWAPI"),a(),o(13,` and caches it to indexedDB. This is also the reason the first load takes longer.
`),a(),r(14,"select",2),d(15,Ce,2,1,"option",3),F(16,"async"),a(),u(17,"input",4),r(18,"app-show-rec",5),C("selected",function(p){return n.changeTo(p)}),F(19,"async"),a()),e&2&&(s(14),l("formControl",n.chosenSet),s(1),l("ngForOf",$(16,4,n.availableSets$)),s(2),l("formControl",n.name),s(1),l("record",$(19,6,n.result$)))},dependencies:[S,re,ae,te,oe,ne,ie,E,X],styles:[`[_nghost-%COMP%] {
    display: block;
    max-height: 95vh;
    max-width: 98vw;
    overflow-x: hidden;
    overflow-y: auto;
  }`]})})();var ye=[{path:"",component:b}],h=class{},me=h;(()=>{h.\u0275fac=function(e){return new(e||h)}})(),(()=>{h.\u0275mod=z({type:h})})(),(()=>{h.\u0275inj=q({imports:[Z,ee.forChild(ye),se]})})();export{me as ComplexAPIModule,ye as routes};
