function u(n){return new Promise((e,t)=>{n.oncomplete=n.onsuccess=()=>e(n.result),n.onabort=n.onerror=()=>t(n.error)})}function f(n,e){let t,r=()=>{if(t)return t;let i=indexedDB.open(n);return i.onupgradeneeded=()=>i.result.createObjectStore(e),t=u(i),t.then(c=>{c.onclose=()=>t=void 0},()=>{}),t};return(i,c)=>r().then(l=>c(l.transaction(e,i).objectStore(e)))}var o;function a(){return o||(o=f("keyval-store","keyval")),o}function d(n,e=a()){return e("readonly",t=>u(t.get(n)))}function y(n,e,t=a()){return t("readwrite",r=>(r.put(e,n),u(r.transaction)))}function h(n,e=a()){return e("readwrite",t=>(n.forEach(r=>t.put(r[1],r[0])),u(t.transaction)))}function p(n,e=a()){return e("readonly",t=>Promise.all(n.map(r=>u(t.get(r)))))}function g(n,e,t=a()){return t("readwrite",r=>new Promise((i,c)=>{r.get(n).onsuccess=function(){try{r.put(e(this.result),n),i(u(r.transaction))}catch(l){c(l)}}}))}function m(n,e=a()){return e("readwrite",t=>(t.delete(n),u(t.transaction)))}function w(n,e=a()){return e("readwrite",t=>(n.forEach(r=>t.delete(r)),u(t.transaction)))}function A(n=a()){return n("readwrite",e=>(e.clear(),u(e.transaction)))}function s(n,e){return n.openCursor().onsuccess=function(){this.result&&(e(this.result),this.result.continue())},u(n.transaction)}function v(n=a()){return n("readonly",e=>{if(e.getAllKeys)return u(e.getAllKeys());let t=[];return s(e,r=>t.push(r.key)).then(()=>t)})}function b(n=a()){return n("readonly",e=>{if(e.getAll)return u(e.getAll());let t=[];return s(e,r=>t.push(r.value)).then(()=>t)})}function k(n=a()){return n("readonly",e=>{if(e.getAll&&e.getAllKeys)return Promise.all([u(e.getAllKeys()),u(e.getAll())]).then(([r,i])=>r.map((c,l)=>[c,i[l]]));let t=[];return n("readonly",r=>s(r,i=>t.push([i.key,i.value])).then(()=>t))})}export{u as a,f as b,d as c,y as d,h as e,p as f,g,m as h,w as i,A as j,v as k,b as l,k as m};
