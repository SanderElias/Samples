import{g as R}from"./chunk-Q36CS5UM.js";import"./chunk-BJIBN36K.js";import{Ab as b,Dc as j,Fb as C,Hb as y,Mb as a,Nb as c,Ob as N,Vb as _,Wb as w,Za as u,f as T,fc as p,hc as O,lb as x,pc as $,qc as E,wc as S}from"./chunk-WBYBMP4K.js";import{a as m,b as g}from"./chunk-DAQOROHW.js";var k=()=>String.fromCharCode(Math.floor(Math.random()*26)+97),V=()=>Date.now().toString(36)+"-"+k()+k()+k(),d=new Map,D=(t,n,e,i)=>{let r={id:V(),parentId:n,value:t,left:e,right:i};return d.set(r.id,r),r},o=t=>t?d.get(t):void 0;var l=()=>[...d.values()].find(t=>t.parentId===void 0),A=()=>{d.clear()};function M(t,n=l()){if(n===void 0)return t;if(t.value<n.value)return n.left===void 0?(n.left=t.id,t.parentId=n.id,t):M(t,o(n.left));if(t.value>n.value)return n.right===void 0?(n.right=t.id,t.parentId=n.id,t):M(t,o(n.right));t.value===n.value&&(console.warn("thrown away duplicate value"),d.delete(t.id))}function H(){console.table([...d.values()].sort((t,n)=>t.value<n.value?-1:1).map(t=>g(m({},t),{leftVal:o(t.left)?.value,cur:t.value,rightVal:o(t.right)?.value})))}function I(t=l()){let n=o(t.parentId),e=o(t.right);if(e===void 0)return t;e.parentId=n?.id,n!==void 0&&(n.left===t.id?n.left=e.id:n.right=e.id);let i=o(e.left);return e.left=t.id,t.parentId=e.id,i!==void 0?(t.right=i.id,i.parentId=t.id):t.right=void 0,e}var P=()=>[...d.values()].sort((t,n)=>t.value<n.value?-1:1);function B(t=l()){let n=o(t.parentId),e=o(t.left);if(e===void 0)return t;e.parentId=n?.id,n!==void 0&&(n.left===t.id?n.left=e.id:n.right=e.id);let i=o(e.right);return e.right=t.id,t.parentId=e.id,i!==void 0?(t.left=i.id,i.parentId=t.id):t.left=void 0,e}function s(t){if(t===void 0)return 0;let n=Math.max(s(o(t.left)),s(o(t.right)));return t.height=n+1,t.height}function h(t){if(t===void 0)return 0;let n=e=>o(e)?.height||0;return t.balance=n(t.left)-n(t.right),t.balance}function F(){let t=100;for(v();;){let n=[...d.values()].find(e=>Math.abs(h(e))>1);if(console.log(d.size,n?.value,h(n)),n===void 0||!--t)break;v(n)}}function v(t=l()){if(t===void 0)return;let n=h(t);if(n<-1){let i=o(t.right);i&&h(i)>0&&B(i);let r=I(t);return s(l()),v(r)}if(n>1){let i=o(t.left);i&&(i.balance??0)<0&&I(i);let r=B(t);return s(l()),v(r)}let e=i=>{let r=h(i);Math.abs(i?.balance)>1&&v(i)};e(o(t.left)),e(o(t.right))}function q(t,n){if(t&1&&(a(0,"span",0),p(1),c()),t&2){let e=w(),i=w();b("title",i.title(e)),u(),O(" ",(e==null?null:e.value)??"-"," ")}}function G(t,n){if(t&1&&(a(0,"div",1),N(1,"b-node",2)(2,"b-node",3),c()),t&2){let e=w(2);u(),b("bNode",e.$left()),u(),b("bNode",e.$right())}}function J(t,n){if(t&1&&(a(0,"div"),C(1,q,2,2,"span",0),c(),C(2,G,3,2,"div",1)),t&2){let e=n;u(),y((e==null?null:e.value)??void 0?1:-1),u(),y(e!=null&&e.left||e!=null&&e.right?2:-1)}}var L=(()=>{class t{constructor(){this.bNode=j(void 0),this.$left=S(()=>{let e=o(this.bNode()?.left);return e&&g(m({},e),{time:Date.now()})}),this.$right=S(()=>{let e=o(this.bNode()?.right);return e&&g(m({},e),{time:Date.now()})}),this.height=s,this.balance=h}title(e){return`Height: ${e.height} balance: ${h(e)}`}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=x({type:t,selectors:[["b-node"]],inputs:{bNode:[1,"bNode"]},decls:1,vars:1,consts:[[3,"title"],[1,"row"],[1,"left",3,"bNode"],[1,"right",3,"bNode"]],template:function(i,r){if(i&1&&C(0,J,3,2),i&2){let f;y((f=r.bNode())?0:-1,f)}},dependencies:[t],styles:["[_nghost-%COMP%]{display:grid;width:fit-content;grid-template-columns:1fr;grid-template-rows:20px 1fr;justify-content:center;align-content:center;gap:2px;margin:4px;padding:2px;border:1px solid rgba(255,255,255,.774)}div[_ngcontent-%COMP%]{text-align:center}div.row[_ngcontent-%COMP%]{display:flex;justify-content:center;align-content:center}div[_ngcontent-%COMP%]:first-child{padding:9px;border-radius:50%;align-self:center;justify-self:center;background-color:#5d0e5d}.left[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{background-color:#00f}.right[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{background-color:green}"],changeDetection:0})}}return t})();var ct=(()=>{class t{constructor(){this.count=31,this.root$=new T,this.nodes=P(),this.dump=()=>{H(),this.refresh()},this.deb=null}ngOnInit(){this.reset()}async reset(){A();let[e,...i]=await U(),r=D(e);i.forEach(f=>M(D(f),r)),s(r),setTimeout(()=>this.root$.next(r),20),this.nodes=P()}refresh(){this.deb&&clearTimeout(this.deb),this.deb=setTimeout(()=>{this.root$.next(g(m({},l()),{time:Date.now()}))},0),s(l())}rl(e=l()){I(e),this.refresh()}rr(e=l()){B(e),this.refresh()}rb(e=l()){F(),this.refresh()}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=x({type:t,selectors:[["app-bintree"]],decls:13,vars:3,consts:[[1,"button-bar"],[3,"click"],[3,"bNode"]],template:function(i,r){i&1&&(a(0,"h1"),p(1,"Binary tree"),c(),a(2,"div",0)(3,"button",1),_("click",function(){return r.rl()}),p(4,"rl"),c(),a(5,"button",1),_("click",function(){return r.rr()}),p(6,"rr"),c(),a(7,"button",1),_("click",function(){return r.rb()}),p(8,"rb"),c(),a(9,"button",1),_("click",function(){return r.dump()}),p(10,"dump"),c()(),N(11,"b-node",2),$(12,"async")),i&2&&(u(11),b("bNode",E(12,1,r.root$)))},dependencies:[L,R],styles:[".button-bar[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(5,1fr);max-width:100vw}.row[_ngcontent-%COMP%]{margin-top:1rem;display:grid;grid-template-columns:repeat(10,1fr)}"],changeDetection:0})}}return t})(),K=(t=2e3)=>Math.floor(Math.random()*t),Q=t=>[...new Set(Array.from({length:t},()=>K()))];async function U(){let t;return t||(t=Q(100)),t}export{ct as BintreeComponent};
