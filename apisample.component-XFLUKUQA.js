import{b as E}from"./chunk-QHB5QIAT.js";import{e as oe}from"./chunk-KICOZ6PK.js";import"./chunk-XZCHICF6.js";import{b as Q,d as X,h as M,n as Z,q as ee,r as te,s as ne,w as ie}from"./chunk-ENWP5MNA.js";import{i as b,j as K}from"./chunk-4XL46QIM.js";import{B as C,C as U,F as W,G as Y,Hb as w,L as q,Mb as J,Ub as P,V as T,X as z,Xa as c,db as _,eb as F,fa as G,fb as p,gb as a,ha as v,hb as l,ib as u,j as B,jb as R,kb as $,mb as V,n as H,o as L,p as O,pb as S,qa as k,qb as d,ra as A,vb as s,wb as y,xb as g}from"./chunk-ZWPQDWQV.js";import{e as h,f as N,g as j,h as D}from"./chunk-G5KKTNWD.js";function se(e,i){if(e&1){let n=V();R(0),a(1,"details")(2,"summary"),s(3),a(4,"button",4),S("click",function(){let o=k(n).ngIf,m=d(2).$implicit,f=d();return A(f.selected.emit([f.key(m),o.name||o.title]))}),s(5," Select "),l()(),u(6,"app-show-rec",5),l(),$()}if(e&2){let n=i.ngIf;c(3),g("",n.name||n.title," "),c(3),p("record",n)}}function ce(e,i){if(e&1&&s(0),e&2){let n=d(2).$implicit,r=d();g(" ",r.val(n)," ")}}function me(e,i){if(e&1&&(R(0),_(1,se,7,2,"ng-container",1),_(2,ce,1,1,"ng-template",null,3,P),$()),e&2){let n=F(3),r=d().$implicit,t=d();c(1),p("ngIf",t.isRecord(t.val(r)))("ngIfElse",n)}}function pe(e,i){if(e&1){let n=V();a(0,"details")(1,"summary"),s(2),a(3,"button",4),S("click",function(){let o=k(n).$implicit,m=d(2).$implicit,f=d();return A(f.selected.emit([f.key(m),o.name||o.title]))}),s(4," Select "),l()(),u(5,"app-show-rec",5),l()}if(e&2){let n=i.$implicit;c(2),g("",n.name||n.title," "),c(3),p("record",n)}}function de(e,i){if(e&1&&_(0,pe,6,2,"details",0),e&2){let n=d().$implicit,r=d();p("ngForOf",r.val(n))}}function _e(e,i){if(e&1&&(a(0,"dl")(1,"dt"),s(2),l(),a(3,"dd"),_(4,me,4,2,"ng-container",1),_(5,de,1,1,"ng-template",null,2,P),l()()),e&2){let n=i.$implicit,r=F(6),t=d();c(2),y(t.key(n)),c(2),p("ngIf",!t.isRecArray(n))("ngIfElse",r)}}var fe=e=>e[0],re=e=>e[1],ae=(()=>{let i=class{set record(r){r&&(this.entries=Object.entries(r))}constructor(){this.selected=new J,this.key=fe,this.val=re}isRecArray(r){let t=re(r);if(Array.isArray(t)&&t.length>0){let o=t[0];return!Array.isArray(o)&&typeof o=="object"}return!1}isRecord(r){return r&&!Array.isArray(r)&&typeof r=="object"&&r}ngOnInit(){}},e=i;return(()=>{i.\u0275fac=function(t){return new(t||i)}})(),(()=>{i.\u0275cmp=v({type:i,selectors:[["app-show-rec"]],inputs:{record:"record"},outputs:{selected:"selected"},standalone:!0,features:[w],decls:1,vars:1,consts:[[4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["handleArray",""],["handleRec",""],[3,"click"],[3,"record"]],template:function(t,o){t&1&&_(0,_e,7,3,"dl",0),t&2&&p("ngForOf",o.entries)},dependencies:[i,b,K],styles:[`dl[_ngcontent-%COMP%] {
    display: grid;
    grid-template-columns: 5em 1fr;
  }
  dt[_ngcontent-%COMP%] {
    font-weight: initial;
    max-width: 5em;
    overflow: hidden;
  }
  dd[_ngcontent-%COMP%] {
    font-weight: bolder;
    margin-left: .5em;
  }
  summary[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] {
    display: inline-block;
    margin-left: 5px;
    padding: 2px;
  }`]})})(),e})();function he(e,i){if(e&1&&(a(0,"option"),s(1),l()),e&2){let n=i.$implicit;c(1),y(n)}}function ue(e,i){if(e&1&&(a(0,"option"),s(1),l()),e&2){let n=i.$implicit;c(1),g("",n," ")}}var ke=(()=>{var i;let n=class{constructor(){N(this,i,void 0);j(this,i,G(oe)),this.chosenSet=new M(""),this.name=new M(""),this.availableSets$=h(this,i).swapiRoot$.pipe(L(t=>Object.keys(t))),this.availableSets=E(this.availableSets$),this.availableOptions=E(O([this.availableSets$,this.chosenSet.valueChanges]).pipe(C(([t,o])=>t.includes(o)),T(([t,o])=>h(this,i).getSetNames(o))),{initialValue:[]}),this.result=E(O([this.chosenSet.valueChanges,this.name.valueChanges.pipe(Y(250),q(),C(Boolean))]).pipe(T(([t,o])=>h(this,i).findIn(t,o)),C(Boolean),z(t=>this.rawData=t),W(t=>h(this,i).enrich(t)),U(t=>(console.error(t),B({"Not Found":"Your search string didn't return any results"})))))}ngAfterViewInit(){this.changeTo(["people","luke"])}changeTo(t){return D(this,null,function*(){let o=yield H(this.availableSets$),[m,f]=t,x=m;if(!o.includes(m)){let I=this.rawData[m];x=h(this,i).detectSet(Array.isArray(I)?I[0]:I)}console.log(x,f),this.chosenSet.setValue(x,{emitEvent:!0}),this.name.setValue(f,{emitEvent:!0})})}},e=n;return i=new WeakMap,(()=>{n.\u0275fac=function(o){return new(o||n)}})(),(()=>{n.\u0275cmp=v({type:n,selectors:[["app-apisample"]],standalone:!0,features:[w],decls:21,vars:5,consts:[["target","blank","href","https://github.com/SanderElias/Samples/blob/master/projects/se-ng/swapi/src/lib/swapi.service.ts"],["target","blank","href","https://swapi.dev"],[3,"formControl"],[4,"ngFor","ngForOf"],["type","text","list","listOptions","autofocus","",3,"formControl"],[3,"record","selected"],["id","listOptions"]],template:function(o,m){o&1&&(a(0,"H3"),s(1,"Complex api sample"),l(),a(2,"h4"),s(3,"(first load might take a while!)"),l(),a(4,"p"),s(5," The complexity is in the API, have an look at "),a(6,"a",0),s(7,"the swapi service"),l(),s(8,"."),u(9,"br"),s(10," This sample loads all of "),a(11,"a",1),s(12,"SWAPI"),l(),s(13,` and caches it to indexedDB. This is also the reason the first load takes longer.
`),l(),a(14,"select",2),_(15,he,2,1,"option",3),l(),u(16,"br")(17,"input",4),a(18,"app-show-rec",5),S("selected",function(x){return m.changeTo(x)}),l(),a(19,"datalist",6),_(20,ue,2,1,"option",3),l()),o&2&&(c(14),p("formControl",m.chosenSet),c(1),p("ngForOf",m.availableSets()),c(2),p("formControl",m.name),c(1),p("record",m.result()),c(2),p("ngForOf",m.availableOptions()))},dependencies:[ie,te,ne,Q,ee,X,Z,ae,b],styles:[`[_nghost-%COMP%] {
    display: block;
    max-height: 95vh;
    max-width: 98vw;
    overflow-x: hidden;
    overflow-y: auto;
  }`]})})(),e})();export{ke as APISampleComponent};
