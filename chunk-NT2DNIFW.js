import{Kc as y,Nc as D,Pc as w,X as m,Z as d,d as g,ea as v,pa as l,wa as b}from"./chunk-JMJSAENN.js";import{a as f,b as p}from"./chunk-DAQOROHW.js";function T(t){t||(t=v(l));let e=new g(n=>{if(t.destroyed){n.next();return}return t.onDestroy(n.next.bind(n))});return n=>n.pipe(m(e))}function F(t,e){let i=!e?.manualCleanup?e?.injector?.get(l)??v(l):null,c=x(e?.equal),r;e?.requireSync?r=b({kind:0},{equal:c}):r=b({kind:1,value:e?.initialValue},{equal:c});let a,u=t.subscribe({next:o=>r.set({kind:1,value:o}),error:o=>{r.set({kind:2,error:o}),a?.()},complete:()=>{a?.()}});if(e?.requireSync&&r().kind===0)throw new d(601,!1);return a=i?.onDestroy(u.unsubscribe.bind(u)),y(()=>{let o=r();switch(o.kind){case 1:return o.value;case 2:throw o.error;case 0:throw new d(601,!1)}},{equal:e?.equal})}function x(t=Object.is){return(e,n)=>e.kind===1&&n.kind===1&&t(e.value,n.value)}function L(t){return D(p(f({},t),{loader:void 0,stream:e=>{let n,i=()=>n?.unsubscribe();e.abortSignal.addEventListener("abort",i);let c=b({value:void 0}),r,a=new Promise(s=>r=s);function u(s){c.set(s),r?.(c),r=void 0}let o=t.stream??t.loader;if(o===void 0)throw new d(990,!1);return n=o(e).subscribe({next:s=>u({value:s}),error:s=>{u({error:w(s)}),e.abortSignal.removeEventListener("abort",i)},complete:()=>{r&&u({error:new d(991,!1)}),e.abortSignal.removeEventListener("abort",i)}}),a}}))}export{T as a,F as b,L as c};
