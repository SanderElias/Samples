import{a as L}from"./chunk-7WKICXQC.js";import{c as p,d as xe,e as k,f as we,g as Y,h as x,i as V,j as Ce,k as u,l as Ee,m as G,n as H,o as h,p as J,q as _e,r as Se,s as z,t as g}from"./chunk-VHQ6NT5R.js";import{a as be}from"./chunk-AJROCCCR.js";import{g as ye}from"./chunk-MGEOVUXS.js";import"./chunk-Q7HKI3MB.js";import"./chunk-QF5K4MHH.js";import{$ as oe,$c as Z,Ca as T,Cb as le,Fb as d,Gb as c,Hb as me,Jb as de,Kb as $,Kc as y,Lb as ce,Mb as P,Mc as R,Nb as F,Nc as he,Ob as b,Pb as a,Qb as r,Rb as O,Sb as S,Sc as I,Tb as B,Tc as X,Vc as ve,Xa as s,Yb as M,Zb as ae,ac as C,bc as N,cc as D,ea as se,ja as E,jc as q,ka as _,kb as w,kc as j,mc as pe,nc as ue,pc as l,qc as ge,rc as Q,sc as fe,wa as A}from"./chunk-JMJSAENN.js";import"./chunk-DAQOROHW.js";var f=(function(n){return n.Email="E-Mail",n.Fax="Fax",n.Mobile="Mobile",n.Phone="Phone",n})(f||{});var Ne=["contacts",""];function Re(n,o){if(n&1&&(a(0,"option",5),l(1),r()),n&2){let e=o.$implicit;b("value",e),s(),ge(e)}}function Ve(n,o){if(n&1){let e=M();a(0,"div",1)(1,"button",2),C("click",function(){let i=E(e).$implicit,m=D();return _(m.delContact(i().value()))}),l(2,"\u{1F5D1}\uFE0F"),r(),a(3,"div")(4,"select",3),d(),a(5,"option",4),l(6,"-- Select type --"),r(),P(7,Re,2,2,"option",5,ce),r()(),a(9,"div")(10,"input",6),d(),r()(),a(11,"input",7),d(),r()()}if(n&2){let e=o.$implicit,t=D();s(),b("disabled",t.isLastOne()),s(3),c(e.type),s(3),F(t.types),s(3),c(e.value),pe("background-color",t.backgroundColor(e.value)()),s(),c(e.priority)}}var Me=(()=>{class n{constructor(){this.contacts=I.required(),this.contactList=y(()=>this.contacts()()),this.isLastOne=y(()=>this.contactList().value().length===1),this.types=Object.values(f),this.backgroundColor=e=>y(()=>{let{pending:t,touched:i}=e();return t()&&i()?"var(--orange-6)":""})}addContact(){this.contactList().value.update(t=>[...t,{type:f.Email,value:"",priority:0}]),this.contacts()().fieldBindings().forEach((t,i)=>console.log(i,t))}delContact(e){let t=this.contactList().value;t().length>1&&t.update(i=>i.filter(m=>m!==e))}dummy(){let e=this.contacts();console.log(e().fieldBindings().forEach((t,i)=>console.log(i,t)))}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275cmp=w({type:n,selectors:[["fieldset","contacts",""]],inputs:{contacts:[1,"contacts"]},attrs:Ne,decls:8,vars:0,consts:[["type","button",1,"action",3,"click"],[1,"row"],["type","button",1,"action",3,"click","disabled"],["showError","",3,"field"],["value",""],[3,"value"],["type","text","placeholder","value","showError","",3,"field"],["type","number","placeholder","priority",3,"field"]],template:function(t,i){t&1&&(a(0,"legend"),l(1,"Contacts "),a(2,"button",0),C("click",function(){return i.addContact()}),l(3,"+"),r()(),a(4,"div"),l(5,' Try adding the contact "i@exists.gov" to see aSync validation in action. '),r(),P(6,Ve,12,6,"div",1,$)),t&2&&(s(6),F(i.contacts()))},dependencies:[k,L],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;gap:var(--size-2)}div.row[_ngcontent-%COMP%]{display:grid;grid-template-columns:3.5rem 6rem 16.5rem 2rem;flex-direction:row;gap:var(--size-2);align-items:baseline}input[type=number][_ngcontent-%COMP%]{width:3rem}div[_ngcontent-%COMP%] > button.action[_ngcontent-%COMP%]{position:inherit;margin-inline-start:0}"]})}}return n})();var K=1e3,De=(()=>{class n{constructor(){this.MAX=K,this.value=ve(0),this.min=I(0),this.max=I(K),this.showMinMax=A(!1),this.lowerBoundary=R(()=>this.min()??0),this.upperBoundary=R({source:this.lowerBoundary,computation:(e,t)=>{let i=t?.value??K;return Math.min(K,i<e?e+1:i)}}),this.upperLowest=y(()=>Math.max(this.lowerBoundary()+1,this.min()??0))}getRandomInt(){this.value.set(Math.floor(Math.random()*(this.upperBoundary()-this.lowerBoundary()+1))+this.lowerBoundary())}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275cmp=w({type:n,selectors:[["se-input-random-int"]],hostVars:2,hostBindings:function(t,i){t&2&&ue("min-max",i.showMinMax())},inputs:{value:[1,"value"],min:[1,"min"],max:[1,"max"]},outputs:{value:"valueChange"},decls:10,vars:9,consts:[["title","click to set boundaries",3,"click"],["type","range","step","1",3,"input","min","max","value"],["type","button",3,"click"]],template:function(t,i){t&1&&(S(0,"span",0),N("click",function(){return i.showMinMax.set(!i.showMinMax())}),l(1),B(),S(2,"label"),l(3,"Min value: "),S(4,"input",1),N("input",function(v){return i.lowerBoundary.set(+v.target.value)}),B()(),S(5,"label"),l(6,"Max value: "),S(7,"input",1),N("input",function(v){return i.upperBoundary.set(+v.target.value)}),B()(),S(8,"button",2),N("click",function(){return i.getRandomInt()}),l(9),B()),t&2&&(s(),Q("current value: ",i.value()," "),s(3),ae("min",i.min()??0)("max",i.max()??i.MAX)("value",i.lowerBoundary()),s(3),ae("min",i.upperLowest())("max",i.max()??i.MAX)("value",i.upperBoundary()),s(2),fe("Get random int between ",i.lowerBoundary()," and ",i.upperBoundary()))},styles:["[_nghost-%COMP%]{display:flex;flex-direction:row;align-items:center;gap:var(--size-2)}.min-max[_nghost-%COMP%]{flex-direction:column;align-items:flex-start;gap:var(--size-1)}.min-max[_nghost-%COMP%]   [_ngcontent-%COMP%]:not(:first-child){margin-inline-start:var(--size-4)}.min-max[_nghost-%COMP%]   label[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;gap:var(--size-2)}label[_ngcontent-%COMP%]{display:none}"]})}}return n})();var Ae=["tagsInput"],$e=["tags",""];function qe(n,o){if(n&1&&(a(0,"span",1),l(1),r()),n&2){let e=D();s(),Q(" (max ",e.maxLength()," tags)")}}function je(n,o){if(n&1){let e=M();a(0,"div",4)(1,"button",5),C("click",function(){let i=E(e).$index,m=D();return _(m.delTag(i))}),l(2,"\u{1F5D1}\uFE0F"),r(),a(3,"input",6),d(),r()()}if(n&2){let e=o.$implicit,t=o.$index,i=D();s(),b("disabled",i.isLastOne()),s(2),c(e),le("name","tag-"+t)}}var Ie=(()=>{class n{constructor(){this.tags=I.required(),this.tagsInput=X("tagsInput",{read:T}),this.tagsList=y(()=>this.tags()()),this.isLastOne=y(()=>this.tagsList().value().length===1),this.maxLength=y(()=>{let e=(this.tagsList().errors()||[]).find(t=>t instanceof _e);return e===void 0?null:e.maxLength}),this._=Z(()=>{let e=this.tagsList().errors()||[],t=this.tagsInput().nativeElement;e.length>0?t.setCustomValidity("error in tags"):t.setCustomValidity("")})}addTag(){this.tagsList().value.update(e=>["",...e])}delTag(e){let t=this.tagsList().value;t().length>1&&t.update(i=>i.filter((m,v)=>v!==e))}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275cmp=w({type:n,selectors:[["fieldset","tags",""]],viewQuery:function(t,i){t&1&&q(i.tagsInput,Ae,5,T),t&2&&j()},inputs:{tags:[1,"tags"]},attrs:$e,decls:9,vars:1,consts:[["tagsInput",""],[1,"error"],["type","button",1,"action",3,"click"],["type","text","name","tags",2,"display","none"],[1,"tags"],["type","button",1,"action",3,"click","disabled"],["type","text","showError","",3,"field"]],template:function(t,i){if(t&1){let m=M();a(0,"legend"),l(1," Tags "),me(2,qe,2,1,"span",1),a(3,"button",2),C("click",function(){return E(m),_(i.addTag())}),l(4,"+"),r()(),O(5,"input",3,0),P(7,je,4,3,"div",4,$)}t&2&&(s(2),de(i.maxLength()!==null?2:-1),s(5),F(i.tags()))},dependencies:[k,L],styles:["[_nghost-%COMP%]{display:block;margin-block-start:var(--size-2 )}div.tags[_ngcontent-%COMP%]{display:grid;grid-template-columns:48px auto;gap:var(--size-3);grid-row-gap:var(--size-1);align-items:baseline}.error[_ngcontent-%COMP%]{color:var(--red-5);font-variant:small-caps;font-size:.9rem;margin-inline-start:var(--size-2)}div.tags[_ngcontent-%COMP%] > button.action[_ngcontent-%COMP%]{position:inherit;margin-inline-start:0}"]})}}return n})();var Te=async n=>{console.log("submit with error"),await new Promise(e=>setTimeout(e,3e3));let o=n().value();if(ye(o)){let e=Object.keys(be(o)),t=e[Math.ceil(Math.random()*e.length)].split(".");try{let i=t.reduce((m,v)=>m[v]??m,n);return console.log("random field with error",t.join(".")),J({kind:"randomError",message:"This is a random server-side error for testing purposes",field:i})}catch{return null}}};var ke=(()=>{class n{constructor(){this.getById=e=>R({source:e,computation:t=>{let i=U.get(t);return i?structuredClone(i):Qe(t)}}),this.getAll=()=>structuredClone(Array.from(U.values())),this.save=async e=>{await new Promise(t=>setTimeout(t,500)),U.set(e.id,e)}}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275prov=oe({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),U=new Map;U.set("1",{id:"1",name:"Sander",dob:new Date(1980,1,1),password:"007 Is not secure",confirm:"007 Is not secure",favoriteRandomInt:42,contacts:[{type:f.Email,value:"a@b.c",priority:0},{type:f.Mobile,value:"+31 6123 456 789",priority:0}],tags:["developer","angular","aa","aaa","aaaa"],address:{street:"123 Main St",city:"Anytown",state:"CA",zip:"12345"}});var Qe=n=>({id:n,name:"",dob:new Date("2000"),password:"",confirm:"",tags:[],favoriteRandomInt:0,address:{street:"",city:"",state:"",zip:""},contacts:[]});var ze=u(n=>{p(n,({value:o})=>{let e=o();return/^[^@\s]+@[^@\s]+\.[^@\s]+$/.test(e)?null:h(/^[^@\s]+@[^@\s]+\.[^@\s]+$/,{message:"Invalid email address"})}),xe(n,{params:({value:o})=>o(),factory:o=>he({params:o,loader:async({params:e})=>{let t=e;return await new Promise(m=>setTimeout(m,2500)),["i@exists.gov","j@exists.gov"].includes(t)}}),errors:o=>o?{kind:"serverError",message:"Email address already exists"}:null})});var ee=u(n=>{p(n,({value:o})=>{let e=[],t=o(),i=t.split("").filter(m=>"0123456789".includes(m)).length;return/^\+?[0-9\s\-()]{7,}$/.test(t)||e.push(h(/^\+?[0-9\s\-()]{7,}$/,{message:"only numbers and ()+- are allowed"})),i<7&&e.push(H(7,{message:"At least 7 digits are required"})),i>15&&e.push(G(15,{message:"Maximum 15 digits allowed"})),e.length>0?e:null})});var Le=u(n=>{z(n,1,{message:"At least one contact is required"}),Y(n,Xe)}),Xe=u(n=>{let o=Object.values(f);g(n.value,{message:"a value is required"}),p(n.type,({value:e})=>{let t=e();return o.includes(t)===!1?h(/.*/,{message:"Invalid contact type"}):null}),V(n,e=>e.type===f.Email,e=>x(e.value,ze)),V(n,e=>e.type===f.Fax,e=>x(e.value,ee)),V(n,e=>e.type===f.Mobile,e=>x(e.value,ee)),V(n,e=>e.type===f.Phone,e=>x(e.value,ee))});var Pe=u(n=>{g(n,{message:"can not be empty"}),z(n,6,{message:"must be at least 6 characters"}),p(n,({value:o})=>{let e=o(),t=[];return/[A-Z]/.test(e)||t.push(J({message:"must contain an uppercase letter"})),/[a-z]/.test(e)||t.push(re("must contain a lowercase letter")),/[0-9]/.test(e)||t.push(re("must contain a number")),/[^A-Za-z0-9]/.test(e)||t.push(re("must contain a special character")),t.length>0?t:null})}),re=n=>({kind:"complexity",field:void 0,message:n});var Fe=u(n=>{Se(n,7,{message:"Maximum 7 tags allowed"});let o=u(e=>{g(e,{message:"Tag can not be empty"}),z(e,2,{message:"Tag must be at least 2 characters"}),p(e,({value:t,state:i,valueOf:m})=>{let v=t(),te=parseInt(""+i.keyInParent(),10),Be=m(n).map((ne,ie)=>[ne,ie]);for(let[ne,ie]of Be)if(ie!==te&&ne===v)return h(/.*/,{message:"Duplicate tags are not allowed"})}),p(e,({value:t})=>{if(t().toLowerCase().includes("react"))return h(/.*/,{message:"no, just, no!"})})});Y(n,o)});var Oe=u(n=>{g(n.name,{message:"a name is required"}),p(n.name,({value:o})=>{let e=o();return e&&e.length<3?H(3,{message:"Name must be at least 3 characters"}):e&&!/^[A-Za-z\s]+$/.test(e)?h(/^[A-Za-z\s]+$/,{message:"Name must contain only letters and spaces"}):null}),g(n.dob),p(n.dob,({value:o})=>{let e=o();return e&&new Date(e).getTime()>Date.now()?G(Date.now(),{message:"Date of birth cannot be in the future"}):null}),p(n.dob,({value:o})=>{let e=o();return e&&new Date(e).getFullYear()<1900?Ee(1900,{message:"Year must be 1900 or later"}):null}),x(n.password,Pe),g(n.confirm),p(n.confirm,({value:o,valueOf:e,state:t})=>{let i=o(),m=e(n.password);return i!==m?h(/.*/,{message:"Passwords do not match"}):null}),g(n.address.street),g(n.address.city),g(n.address.state),x(n.tags,Fe),x(n.contacts,Le)});var Ze=["dlg"],Yt=(()=>{class n{constructor(){this.dataService=se(ke),this.id=A("1"),this.relation=this.dataService.getById(this.id),this.fd=we(this.relation,Oe),this.dlg=X("dlg",{read:T}),this._=Z(()=>{let e=this.dlg()?.nativeElement;this.fd().submitting()?e.showModal():e.close()})}async onSubmit(e){if(e.preventDefault(),this.fd().valid())if(Math.random()<.6){let t=await Ce(this.fd,Te);console.log("submit result",t)}else console.log("submit without error",JSON.stringify(this.fd().value(),void 0,2))}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275cmp=w({type:n,selectors:[["ng-component"]],viewQuery:function(t,i){t&1&&q(i.dlg,Ze,5,T),t&2&&j()},decls:52,vars:12,consts:[["dlg",""],["href","/signalForms/tree"],[3,"submit"],["for","name"],["type","text","name","name","placeholder","Your name","showError","",3,"field"],["for","dob"],["type","date","name","dob","showError","",3,"field"],["for","password"],["type","password","name","password","placeholder","Password","showError","",3,"field"],["for","confirm"],["type","password","name","confirm","placeholder","Confirm Password","showError","",3,"field"],["for","favoriteRandomInt"],["name","favoriteRandomInt",3,"field"],[3,"contacts"],["for","street"],["type","text","name","street","placeholder","Street","showError","",3,"field"],["for","city"],["type","text","name","city","placeholder","City","showError","",3,"field"],["for","zip"],["type","text","name","zip","placeholder","Zip","showError","",3,"field"],["for","state"],["type","text","name","state","placeholder","State","showError","",3,"field"],[3,"tags"],["type","submit",3,"disabled"]],template:function(t,i){if(t&1){let m=M();a(0,"h1"),l(1," Signal Forms Experiment "),a(2,"small")(3,"a",1),l(4,"recusive form"),r()()(),a(5,"form",2),C("submit",function(te){return E(m),_(i.onSubmit(te))}),a(6,"label",3)(7,"span"),l(8,"Name"),r(),a(9,"input",4),d(),r()(),a(10,"label",5)(11,"span"),l(12,"Date of Birth"),r(),a(13,"input",6),d(),r()(),a(14,"label",7)(15,"span"),l(16,"Password"),r(),a(17,"input",8),d(),r()(),a(18,"label",9)(19,"span"),l(20,"Confirm Password"),r(),a(21,"input",10),d(),r()(),a(22,"label",11)(23,"span"),l(24,"Favorite Random Int"),r(),a(25,"se-input-random-int",12),d(),r()(),O(26,"fieldset",13),a(27,"fieldset")(28,"legend"),l(29,"Address"),r(),a(30,"label",14)(31,"span"),l(32,"Street"),r(),a(33,"input",15),d(),r()(),a(34,"label",16)(35,"span"),l(36,"City"),r(),a(37,"input",17),d(),r()(),a(38,"label",18)(39,"span"),l(40,"Zip"),r(),a(41,"input",19),d(),r()(),a(42,"label",20)(43,"span"),l(44,"State"),r(),a(45,"input",21),d(),r()()(),O(46,"fieldset",22),a(47,"button",23),l(48,"Submit"),r()(),a(49,"dialog",null,0),l(51,"Submitting and validating on the server, please hold!"),r()}t&2&&(s(9),c(i.fd.name),s(4),c(i.fd.dob),s(4),c(i.fd.password),s(4),c(i.fd.confirm),s(4),c(i.fd.favoriteRandomInt),s(),b("contacts",i.fd.contacts),s(7),c(i.fd.address.street),s(4),c(i.fd.address.city),s(4),c(i.fd.address.zip),s(4),c(i.fd.address.state),s(),b("tags",i.fd.tags),s(),b("disabled",!i.fd().valid()))},dependencies:[k,Ie,Me,De,L],styles:[`:host{display:block;margin-top:var(--size-3)}form{width:var(--size-content-3);display:flex;flex-direction:column;gap:var(--size-3);margin:auto;background-color:var(--surface-2);padding:var(--size-3);border-radius:var(--radius-3)}label{display:flex;flex-direction:column;gap:var(--size-2)}label>*:nth-child(2){margin-left:var(--size-3)}label:has(input[required])>span:first-child:after{content:"*";color:var(--red-3)}:is(input,textarea,select):user-invalid{border:2px solid var(--red-5)}fieldset>legend{display:flex;align-items:center}fieldset{margin-block-end:0}div.error-messages{display:none}*:has(.se-touched) div.error-messages{display:block;color:var(--red-5);grid-column:2;font-style:italic;min-height:1.5em;font-variant:small-caps;margin-inline-start:var(--size-2);margin-block-start:calc(-1 * var(--size-2))}*:has(.se-touched) div.error-messages ul{font-size:.95rem}*:has(.se-touched) div.error-messages ul:not(:has(:nth-child(2))){list-style:none;padding-inline-start:var(--size-4)}button.action{position:absolute;margin-inline-start:calc(var(--size-content-3) - 2.5rem);border-radius:50%;width:var(--size-8);height:var(--size-8);padding:0;font-size:var(--size-3);line-height:1;display:inline-flex;align-items:center;justify-content:center}dialog{padding:var(--size-6);font-size:var(--size-5);border-radius:var(--radius-3);box-shadow:var(--shadow-4);width:var(--size-content-3)}
`],encapsulation:2,changeDetection:0})}}return n})();export{Yt as SignalFormsExperimentComponent};
